<!DOCTYPE html><html class="appearance-auto" lang="zh-CN"><head><meta charset="UTF-8"><title>85、常用代码片段</title><meta name="description" content="🐯 🐯 🐯 🐯 🐯"><meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no, initial-scale=1"><!-- Google Analytics --><!-- End Google Analytics -->
<!-- Baidu Analytics --><!-- End Baidu Analytics --><link rel="icon" href="/images/favicon.png"><link rel="stylesheet" href="/style/common/bulma.css"><link rel="stylesheet" href="/style/base.css"><link rel="stylesheet" href="/style/common/helper.css"><script src="/js/common.js"></script><link rel="stylesheet" href="/style/post.css"><link rel="stylesheet" href="/style/themes/highlight-theme-light.css"><script src="/js/highlight.pack.js"></script><meta name="description" content="整理一些常用的代码片段


一、数组重排序const shuffle = (arr) =&amp;gt; arr.sort(() =&amp;gt; Math.random() - 0.5);
const arr = [1, 2, 3, 4, 5];
console.log(shuffle(arr));

二、复制到剪切板const copyToClipboard = (text) =&amp;gt;
  navigator.clipboard &amp;amp;&amp;amp;
  navigator.clipboard.writeText &amp;amp;&amp;amp;
  navigator.clipboard.writeText(text);

copyToClipboard(&amp;quot;Hello World!&amp;quot;);

三、滚动到顶部.."><meta name="generator" content="Hexo 5.4.1"></head><body class="is-flex is-flex-direction-column"><header class="header-widget is-flex-shrink-0 is-hidden-mobile"><div class="container is-fullhd is-flex is-justify-content-space-between is-align-items-center is-full-height"><section class="is-hidden-mobile is-flex-shrink-0"><h2><a href="/">Jude's blog</a></h2></section><h3 class="is-hidden-mobile is-family-serif is-full-height is-flex is-align-items-center is-flex-shrink-0"><div class="is-full-height" id="postTopic"><p class="is-full-height is-flex-shrink-0 is-flex is-align-items-center is-justify-content-center">85、常用代码片段</p><p class="is-full-height is-flex-shrink-0 is-flex is-align-items-center is-justify-content-center">点击返回顶部</p></div></h3><aside class="is-flex-shrink-0"><h3 class="is-inline-block"><a href="/">首页</a></h3><h3 class="is-inline-block"><a href="/about">关于</a></h3><h3 class="is-inline-block"><a href="/archives">归档</a></h3></aside></div></header><header class="is-flex header-widget is-flex-shrink-0 is-align-items-center is-justify-content-center is-hidden-tablet"><h3 class="is-inline-block"><a href="/">首页</a></h3><h3 class="is-inline-block"><a href="/about">关于</a></h3><h3 class="is-inline-block"><a href="/archives">归档</a></h3></header><main><main class="container is-max-widescreen content section post-page pt-4 px-4"><div class="columns is-flex-desktop is-justify-content-center is-flex-direction-row-reverse"><div class="column is-3 is-hidden-mobile"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80%E3%80%81%E6%95%B0%E7%BB%84%E9%87%8D%E6%8E%92%E5%BA%8F"><span class="toc-text">一、数组重排序</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C%E3%80%81%E5%A4%8D%E5%88%B6%E5%88%B0%E5%89%AA%E5%88%87%E6%9D%BF"><span class="toc-text">二、复制到剪切板</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%89%E3%80%81%E6%BB%9A%E5%8A%A8%E5%88%B0%E9%A1%B6%E9%83%A8"><span class="toc-text">三、滚动到顶部</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%9B%E3%80%81%E6%A3%80%E6%B5%8B%E8%AE%BE%E5%A4%87"><span class="toc-text">四、检测设备</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%94%E3%80%81%E6%B7%B1%E6%8B%B7%E8%B4%9D%E5%AF%B9%E8%B1%A1"><span class="toc-text">五、深拷贝对象</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%AD%E3%80%81%E7%AD%89%E5%BE%85%E5%87%BD%E6%95%B0"><span class="toc-text">六、等待函数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%83%E3%80%81%E7%94%9F%E6%88%90%E9%9A%8F%E6%9C%BA%E8%89%B2"><span class="toc-text">七、生成随机色</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%AB%E3%80%81%E6%95%B0%E7%BB%84%E7%BB%93%E6%9E%84%E4%B8%8E%E6%A0%91%E7%BB%93%E6%9E%84%E7%9A%84%E8%BD%AC%E6%8D%A2"><span class="toc-text">八、数组结构与树结构的转换</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B9%9D%E3%80%81%E6%A0%91%E7%BB%93%E6%9E%84%E8%BD%AC%E6%95%B0%E7%BB%84%E7%BB%93%E6%9E%84"><span class="toc-text">九、树结构转数组结构</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8D%81%E3%80%81%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B%E9%AA%8C%E8%AF%81"><span class="toc-text">十、数据类型验证</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8D%81%E4%B8%80%E3%80%81%E5%8F%AA%E8%83%BD%E8%BE%93%E5%85%A5%E9%87%91%E9%A2%9D"><span class="toc-text">十一、只能输入金额</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8D%81%E4%BA%8C%E3%80%81%E6%95%B0%E5%AD%97%E5%8D%95%E4%BD%8D%EF%BC%9A10000-%E8%BD%AC%E6%8D%A2%E4%B8%BA%E4%B8%87%EF%BC%88%E5%90%AB%EF%BC%9A%E4%BA%BF%EF%BC%89"><span class="toc-text">十二、数字单位：10000 转换为万（含：亿）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8D%81%E4%B8%89%E3%80%81%E7%AE%80%E5%8D%95%E7%9A%84%E6%95%B0%E6%8D%AE%E5%8F%8C%E5%90%91%E7%BB%91%E5%AE%9A"><span class="toc-text">十三、简单的数据双向绑定</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8D%81%E5%9B%9B%E3%80%81%E6%95%B0%E7%BB%84%E5%A4%A7%E5%B0%8F%E6%8E%92%E5%BA%8F"><span class="toc-text">十四、数组大小排序</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8D%81%E4%BA%94%E3%80%81js-%E4%BB%8E%E6%95%B0%E7%BB%84%E9%87%8C%E9%9D%A2%E5%8F%96%E5%87%BA%E6%9F%90%E4%B8%A4%E4%B8%AA%E5%80%BC%E4%BD%9C%E4%B8%BA%E5%AF%B9%E8%B1%A1%E7%9A%84key%E5%92%8Cvalue"><span class="toc-text">十五、js 从数组里面取出某两个值作为对象的key和value</span></a></li></ol></div><div class="column is-9"><header class="my-4"><a href="/tags/js"><i class="tag post-item-tag">js</i></a></header><h1 class="mt-0 mb-1 is-family-serif" id="postTitle">85、常用代码片段</h1><time class="has-text-grey" datetime="2022-08-06T15:00:00.000Z">2022-08-06</time><article class="mt-2 post-content"><p>整理一些常用的代码片段</p>
<span id="more"></span>

<h2 id="一、数组重排序"><a href="#一、数组重排序" class="headerlink" title="一、数组重排序"></a>一、数组重排序</h2><pre><code class="js">const shuffle = (arr) =&gt; arr.sort(() =&gt; Math.random() - 0.5);
const arr = [1, 2, 3, 4, 5];
console.log(shuffle(arr));
</code></pre>
<h2 id="二、复制到剪切板"><a href="#二、复制到剪切板" class="headerlink" title="二、复制到剪切板"></a>二、复制到剪切板</h2><pre><code class="js">const copyToClipboard = (text) =&gt;
  navigator.clipboard &amp;&amp;
  navigator.clipboard.writeText &amp;&amp;
  navigator.clipboard.writeText(text);

copyToClipboard(&quot;Hello World!&quot;);
</code></pre>
<h2 id="三、滚动到顶部"><a href="#三、滚动到顶部" class="headerlink" title="三、滚动到顶部"></a>三、滚动到顶部</h2><p>behavior:”smooth”：开启平滑滚动</p>
<pre><code class="js">const scrollToTop = (element) =&gt;
  element.scrollIntoView(&#123; behavior: &quot;smooth&quot;, block: &quot;start&quot; &#125;);
</code></pre>
<h2 id="四、检测设备"><a href="#四、检测设备" class="headerlink" title="四、检测设备"></a>四、检测设备</h2><pre><code class="js">const detectDeviceType = () =&gt;
  /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(
    navigator.userAgent
  )
    ? &quot;Mobile&quot;
    : &quot;Desktop&quot;;

console.log(detectDeviceType());
</code></pre>
<h2 id="五、深拷贝对象"><a href="#五、深拷贝对象" class="headerlink" title="五、深拷贝对象"></a>五、深拷贝对象</h2><pre><code class="js">const deepCopy = (obj) =&gt; JSON.parse(JSON.stringify(obj));
</code></pre>
<h2 id="六、等待函数"><a href="#六、等待函数" class="headerlink" title="六、等待函数"></a>六、等待函数</h2><pre><code class="js">const wait = (ms) =&gt; new Promise((resolve) =&gt; setTimeout(resolve, ms));

const asyncFn = async () =&gt; &#123;
  await wait(1000);
  console.log(&quot;等待异步函数执行结束&quot;);
&#125;;

asyncFn();
</code></pre>
<h2 id="七、生成随机色"><a href="#七、生成随机色" class="headerlink" title="七、生成随机色"></a>七、生成随机色</h2><pre><code class="js">const generateRandomHexColor = () =&gt;
  `#$&#123;Math.floor(Math.random() * 0xffffff).toString(16)&#125;`;

console.log(generateRandomHexColor());
</code></pre>
<h2 id="八、数组结构与树结构的转换"><a href="#八、数组结构与树结构的转换" class="headerlink" title="八、数组结构与树结构的转换"></a>八、数组结构与树结构的转换</h2><p>数组结构数据</p>
<pre><code class="js">const arrayData = [
  &#123; id: 2, title: &quot;中国&quot;, parent_id: 0 &#125;,
  &#123; id: 3, title: &quot;上海&quot;, parent_id: 2 &#125;,
  &#123; id: 4, title: &quot;浦东新区&quot;, parent_id: 3 &#125;,
  &#123; id: 5, title: &quot;新场古镇&quot;, parent_id: 4 &#125;,
  &#123; id: 6, title: &quot;湖南省&quot;, parent_id: 2 &#125;,
  &#123; id: 1, title: &quot;俄罗斯&quot;, parent_id: 0 &#125;,
];
</code></pre>
<p>方法一、使用递归：</p>
<p>1、递归需分为两个函数来完成<br>2、 以为返回的递归函数主要处理查找 id 添加 children<br>3、 由转化函数将结果返回</p>
<pre><code class="js">/**
 * 递归查找添加children
 * @param &#123;数组数据&#125; data
 * @param &#123;存放返回结果&#125; result
 * @param &#123;父id&#125; pid
 */
function getChildren(data, result, pid) &#123;
  for (const item of data) &#123;
    if (item.parent_id === pid) &#123;
      const newItem = &#123; children: [], ...item &#125;;
      result.push(newItem);
      getChildren(data, newItem.children, item.id);
    &#125;
  &#125;
&#125;

/**
 * 转化方法
 * @param &#123;数组数据&#125; data
 * @param &#123;父id&#125; pid
 * @returns
 */
function arrayToTree(data, pid) &#123;
  let result = [];
  getChildren(data, result, pid);
  return result;
&#125;

console.log(arrayToTree(arrayData, 0));
</code></pre>
<p>方法二、reduce</p>
<pre><code class="js">/**
 * 数组结构转为树结构
 * @param &#123;*&#125; data 数组数据
 * @returns
 */
function arrayToTree(data) &#123;
  const result = [];
  const obj = data.reduce((pre, cur) =&gt; &#123;
    pre[cur.id] = cur;
    return pre;
  &#125;, &#123;&#125;);
  for (let item of data) &#123;
    if (item.parent_id === 0) &#123;
      result.push(item);
      continue;
    &#125;
    if (item.parent_id in obj) &#123;
      const parent = obj[item.parent_id];
      parent.children = parent.children || [];
      parent.children.push(item);
    &#125;
  &#125;
  return result;
&#125;
</code></pre>
<h2 id="九、树结构转数组结构"><a href="#九、树结构转数组结构" class="headerlink" title="九、树结构转数组结构"></a>九、树结构转数组结构</h2><p>数组结构</p>
<pre><code class="js">/** 树状形结构数据treeData */
const treeData = [
  &#123;
    id: 2,
    title: &quot;中国&quot;,
    parent_id: 0,
    children: [
      &#123;
        id: 3,
        title: &quot;上海&quot;,
        parent_id: 2,
        children: [
          &#123;
            id: 4,
            title: &quot;浦东新区&quot;,
            parent_id: 3,
            children: [&#123; id: 5, title: &quot;新场古镇&quot;, parent_id: 4 &#125;],
          &#125;,
        ],
      &#125;,
      &#123; id: 6, title: &quot;湖南省&quot;, parent_id: 2 &#125;,
    ],
  &#125;,
  &#123; id: 1, title: &quot;俄罗斯&quot;, parent_id: 0 &#125;,
];
</code></pre>
<p>递归方法</p>
<pre><code class="js">/**
 * 树结构数组扁平化
 * @param &#123;*&#125; data 树结构的数组
 * @returns
 */
function treeToArray(data) &#123;
  return data.reduce((pre, cur) =&gt; &#123;
    const &#123; children = [], ...item &#125; = cur;
    return pre.concat([&#123; ...item &#125;], treeToArray(children));
  &#125;, []);
&#125;
</code></pre>
<h2 id="十、数据类型验证"><a href="#十、数据类型验证" class="headerlink" title="十、数据类型验证"></a>十、数据类型验证</h2><pre><code class="js">function typeOf(obj) &#123;
  const toString = Object.prototype.toString;
  const map = &#123;
    &quot;[object Boolean]&quot;: &quot;boolean&quot;,
    &quot;[object Number]&quot;: &quot;number&quot;,
    &quot;[object String]&quot;: &quot;string&quot;,
    &quot;[object Function]&quot;: &quot;function&quot;,
    &quot;[object Array]&quot;: &quot;array&quot;,
    &quot;[object Date]&quot;: &quot;date&quot;,
    &quot;[object RegExp]&quot;: &quot;regExp&quot;,
    &quot;[object Undefined]&quot;: &quot;undefined&quot;,
    &quot;[object Null]&quot;: &quot;null&quot;,
    &quot;[object Object]&quot;: &quot;object&quot;,
    &quot;[object FormData]&quot;: &quot;formData&quot;,
  &#125;;
  return map[toString.call(obj)];
&#125;
</code></pre>
<h2 id="十一、只能输入金额"><a href="#十一、只能输入金额" class="headerlink" title="十一、只能输入金额"></a>十一、只能输入金额</h2><pre><code class="html">:rules=&quot;&#123; required: itrue, validator: validatePrice, trigger: &#39;blur&#39; &#125;&quot;
</code></pre>
<pre><code class="js">validatePrice(rule, value, callback) &#123;
    if (!value) &#123;
        callback(new Error(&#39;请输入价格&#39;))
    &#125; else if (!/(^[1-9]\d*(\.\d&#123;1,2&#125;)?$)|(^0(\.\d&#123;1,2&#125;)?$)/.test(value)) &#123;
        callback(new Error(&#39;请输入有效价格&#39;))
    &#125; else if (value &gt;= 99999999) &#123;
        callback(new Error(&#39;超过最大金额&#39;))
    &#125; else &#123;
        callback()
    &#125;
&#125;,
</code></pre>
<h2 id="十二、数字单位：10000-转换为万（含：亿）"><a href="#十二、数字单位：10000-转换为万（含：亿）" class="headerlink" title="十二、数字单位：10000 转换为万（含：亿）"></a>十二、数字单位：10000 转换为万（含：亿）</h2><pre><code class="js">/** 数字超过一万转换为万
 * @param &#123; Number &#125; value 数值
 * @param &#123; Number &#125; decimal 保留几位小数
 * @returns &#123; String &#125;
 */
const transNumberToShort = (value, decimal = 2) =&gt; &#123;
  const k = 10000;
  const sizes = [&quot;&quot;, &quot;万&quot;, &quot;亿&quot;, &quot;万亿&quot;];
  let i = undefined;
  let str = &quot;&quot;;
  if (value &lt; k) &#123;
    str = value;
  &#125; else &#123;
    i = Math.floor(Math.log(value) / Math.log(k));
    str = (value / Math.pow(k, i)).toFixed(decimal) + sizes[i];
  &#125;
  return str;
&#125;;
</code></pre>
<h2 id="十三、简单的数据双向绑定"><a href="#十三、简单的数据双向绑定" class="headerlink" title="十三、简单的数据双向绑定"></a>十三、简单的数据双向绑定</h2><pre><code class="html">&lt;html lang=&quot;en&quot;&gt;
  &lt;head&gt;
    &lt;meta charset=&quot;UTF-8&quot; /&gt;
    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot; /&gt;
    &lt;meta http-equiv=&quot;X-UA-Compatible&quot; content=&quot;ie=edge&quot; /&gt;
    &lt;title&gt;Document&lt;/title&gt;
  &lt;/head&gt;

  &lt;body&gt;
    &lt;div id=&quot;app&quot;&gt;
      &lt;input type=&quot;text&quot; id=&quot;a&quot; /&gt;
      &lt;span id=&quot;b&quot;&gt;&lt;/span&gt;
    &lt;/div&gt;
  &lt;/body&gt;
  &lt;script&gt;
    var obj = &#123;
      val: null,
    &#125;; //定义一个空对象

    Object.defineProperty(obj, &quot;val&quot;, &#123;
      // 这里的 val 就是 obj 里面的值

      get: function () &#123;
        return val;
      &#125;,

      set: function (newVal) &#123;
        val = newVal; //定义val等于修改后的内容
        if (!val) return; // 阻止显示 undefined
        document.getElementById(&quot;a&quot;).value = val; //让文本框的内容等于val

        document.getElementById(&quot;b&quot;).innerHTML = val; //让span的内容等于val
      &#125;,
    &#125;);
    document.addEventListener(&quot;keyup&quot;, function (e) &#123;
      //当在文本框输入内容时让对象里你定义的val等于文本框的值

      obj.val = e.target.value;
    &#125;);
  &lt;/script&gt;
&lt;/html&gt;
</code></pre>
<h2 id="十四、数组大小排序"><a href="#十四、数组大小排序" class="headerlink" title="十四、数组大小排序"></a>十四、数组大小排序</h2><pre><code class="js">var num = [7,8,6,5,2]
 //倒序排列
 num.sort((a,b)=&gt;&#123;return b-a&#125;)
 //正序排列
 num.sort((a,b)=&gt;&#123;return a-b&#125;)
</code></pre>
<h2 id="十五、js-从数组里面取出某两个值作为对象的key和value"><a href="#十五、js-从数组里面取出某两个值作为对象的key和value" class="headerlink" title="十五、js 从数组里面取出某两个值作为对象的key和value"></a>十五、js 从数组里面取出某两个值作为对象的key和value</h2><pre><code class="js">const data = [
    &#123;
        id: 1,
        content: &#39;1111&#39;
    &#125;,
    &#123;
        id: 2,
        content: &#39;2222&#39;
    &#125;,
    &#123;
        id: 3,
        content: &#39;3333&#39;
    &#125;,
];
let lessonObj = data.reduce((obj, cur, index) =&gt; &#123;
    obj[`config_$&#123;cur[&quot;id&quot;]&#125;`] =cur[&quot;content&quot;];
    return obj;
&#125;, &#123;&#125;);
</code></pre>
</article><section class="jump-container is-flex is-justify-content-space-between my-6"><!-- em is empty placeholder--><a class="button is-default" href="/2022/08/08/86.signature/" title="86、canvas电子签名"><i class="iconfont icon-prev mr-2 has-text-grey"></i><span class="has-text-weight-semibold">上一页: 86、canvas电子签名</span></a><a class="button is-default" href="/2022/08/04/84.search/" title="84、Chrome快速切换搜索引擎"><span class="has-text-weight-semibold">下一页: 84、Chrome快速切换搜索引擎</span><i class="iconfont icon-next ml-2 has-text-grey"></i></a></section></div></div></main></main><footer class="is-flex is-flex-direction-column is-align-items-center is-flex-shrink-0 is-family-serif"><section class="sns-container"><!-- Github--><a title="github" target="_blank" rel="noopener nofollow" href="//github.com/Jude"><i class="iconfont icon-github"></i></a><!-- Ins--><!-- RSS--><!-- 知乎--><!-- 领英--><!-- 脸书--></section><p><span>Copyright ©</span><span> Jude 2022</span></p><div class="is-flex is-justify-content-center is-flex-wrap-wrap"><p>Powered by Hexo &verbar;&nbsp;</p><p class="is-flex is-justify-content-center"><a title="Hexo theme author" target="_blank" rel="noopener" href="//github.com/haojen">Theme by Haojen&nbsp;</a></p><div style="margin-top: 2px"><a class="github-button" title="github-button" target="_blank" rel="noopener" href="https://github.com/haojen/hexo-theme-Claudia" data-color-scheme="no-preference: light; light: light; dark: dark;" data-show-count="true"></a></div></div><div><span></span></div></footer><script async defer src="https://buttons.github.io/buttons.js"></script><script src="/js/post.js"></script></body></html>