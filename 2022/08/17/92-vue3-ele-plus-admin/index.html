<!DOCTYPE html><html class="appearance-auto" lang="zh-CN"><head><meta charset="UTF-8"><title>92、使用vue3+element-plus写后台管理系统：（二）</title><meta name="description" content="呦呦鹿鸣，食野之苹"><meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no, initial-scale=1"><!-- Google Analytics --><!-- End Google Analytics -->
<!-- Baidu Analytics --><!-- End Baidu Analytics --><link rel="icon" href="/images/favicon.png"><link rel="stylesheet" href="/style/common/bulma.css"><link rel="stylesheet" href="/style/base.css"><link rel="stylesheet" href="/style/common/helper.css"><script src="/js/common.js"></script><link rel="stylesheet" href="/style/post.css"><link rel="stylesheet" href="/style/themes/highlight-theme-light.css"><script src="/js/highlight.pack.js"></script><meta name="description" content="包括 element-plus 的安装、登录、svg icons 的处理（坑：svg 不显示的问题）


一、安装 element-plusnpm install @element-plus/icons
yarn add @element-plus/icons
pnpm install @element-plus/icons


安装成功，会出现一个 element-plus 安装成功和一个按钮

二、公开路由表配置// router/router.js
import &amp;#123; createRouter, createWebHistory &amp;#125; from &amp;quot;vue-router&amp;quot;;

const publicRoutes = [
  &amp;#123;
    path: &amp;quo.."><meta name="generator" content="Hexo 5.4.1"></head><body class="is-flex is-flex-direction-column"><header class="header-widget is-flex-shrink-0 is-hidden-mobile"><div class="container is-fullhd is-flex is-justify-content-space-between is-align-items-center is-full-height"><section class="is-hidden-mobile is-flex-shrink-0"><h2><a href="/">Jude's blog</a></h2></section><h3 class="is-hidden-mobile is-family-serif is-full-height is-flex is-align-items-center is-flex-shrink-0"><div class="is-full-height" id="postTopic"><p class="is-full-height is-flex-shrink-0 is-flex is-align-items-center is-justify-content-center">92、使用vue3+element-plus写后台管理系统：（二）</p><p class="is-full-height is-flex-shrink-0 is-flex is-align-items-center is-justify-content-center">点击返回顶部</p></div></h3><aside class="is-flex-shrink-0"><h3 class="is-inline-block"><a href="/">首页</a></h3><h3 class="is-inline-block"><a href="/about">关于</a></h3><h3 class="is-inline-block"><a href="/archives">归档</a></h3></aside></div></header><header class="is-flex header-widget is-flex-shrink-0 is-align-items-center is-justify-content-center is-hidden-tablet"><h3 class="is-inline-block"><a href="/">首页</a></h3><h3 class="is-inline-block"><a href="/about">关于</a></h3><h3 class="is-inline-block"><a href="/archives">归档</a></h3></header><main><main class="container is-max-widescreen content section post-page pt-4 px-4"><div class="columns is-flex-desktop is-justify-content-center is-flex-direction-row-reverse"><div class="column is-3 is-hidden-mobile"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80%E3%80%81%E5%AE%89%E8%A3%85-element-plus"><span class="toc-text">一、安装 element-plus</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C%E3%80%81%E5%85%AC%E5%BC%80%E8%B7%AF%E7%94%B1%E8%A1%A8%E9%85%8D%E7%BD%AE"><span class="toc-text">二、公开路由表配置</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%89%E3%80%81%E7%99%BB%E5%BD%95%E9%A1%B5"><span class="toc-text">三、登录页</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%9B%E3%80%81icon-%E5%9B%BE%E6%A0%87%E5%A4%84%E7%90%86%E6%96%B9%E6%B3%95%EF%BC%9ASvgIcon"><span class="toc-text">四、icon 图标处理方法：SvgIcon</span></a></li></ol></div><div class="column is-9"><header class="my-4"><a href="/tags/vue3"><i class="tag post-item-tag">vue3</i></a></header><h1 class="mt-0 mb-1 is-family-serif" id="postTitle">92、使用vue3+element-plus写后台管理系统：（二）</h1><time class="has-text-grey" datetime="2022-08-17T12:00:00.000Z">2022-08-17</time><article class="mt-2 post-content"><p>包括 element-plus 的安装、登录、svg icons 的处理（坑：svg 不显示的问题）</p>
<span id="more"></span>

<h2 id="一、安装-element-plus"><a href="#一、安装-element-plus" class="headerlink" title="一、安装 element-plus"></a>一、安装 element-plus</h2><pre><code class="shell">npm install @element-plus/icons
yarn add @element-plus/icons
pnpm install @element-plus/icons
</code></pre>
<blockquote>
<p>安装成功，会出现一个 element-plus 安装成功和一个按钮</p>
</blockquote>
<h2 id="二、公开路由表配置"><a href="#二、公开路由表配置" class="headerlink" title="二、公开路由表配置"></a>二、公开路由表配置</h2><pre><code class="js">// router/router.js
import &#123; createRouter, createWebHistory &#125; from &quot;vue-router&quot;;

const publicRoutes = [
  &#123;
    path: &quot;/login&quot;,
    component: () =&gt; import(&quot;@/views/login/index&quot;),
  &#125;,
];

const router = createRouter(&#123;
  history: createWebHistory(),
  routes: publicRoutes,
&#125;);

export default router;
</code></pre>
<h2 id="三、登录页"><a href="#三、登录页" class="headerlink" title="三、登录页"></a>三、登录页</h2><pre><code class="html">&lt;template&gt;
  &lt;div class=&quot;login-container&quot;&gt;
    &lt;el-form
      class=&quot;login-form&quot;
      ref=&quot;loginFormRef&quot;
      :model=&quot;loginForm&quot;
      :rules=&quot;loginRules&quot;
    &gt;
      &lt;div class=&quot;title-container&quot;&gt;
        &lt;h3 class=&quot;title&quot;&gt;后台管理系统&lt;/h3&gt;
      &lt;/div&gt;
      &lt;el-form-item prop=&quot;username&quot;&gt;
        &lt;span class=&quot;svg-container&quot;&gt;
          &lt;svg-icon icon=&quot;user&quot; /&gt;
        &lt;/span&gt;
        &lt;el-input
          placeholder=&quot;username&quot;
          name=&quot;username&quot;
          type=&quot;text&quot;
          v-model=&quot;loginForm.username&quot;
        &gt;&lt;/el-input&gt;
      &lt;/el-form-item&gt;
      &lt;el-form-item&gt;
        &lt;span class=&quot;svg-container&quot;&gt;
          &lt;svg-icon icon=&quot;password&quot; /&gt;
        &lt;/span&gt;
        &lt;el-input
          placeholder=&quot;password&quot;
          name=&quot;password&quot;
          :type=&quot;passwordType&quot;
          v-model=&quot;loginForm.password&quot;
        &gt;&lt;/el-input&gt;
        &lt;span class=&quot;show-pwd&quot;&gt;
          &lt;svg-icon
            :icon=&quot;passwordType === &#39;password&#39; ? &#39;eye&#39; : &#39;eye-open&#39;&quot;
            @click=&quot;onChangePwdType&quot;
          &gt;&lt;/svg-icon&gt;
        &lt;/span&gt;
      &lt;/el-form-item&gt;
      &lt;el-button
        type=&quot;primary&quot;
        style=&quot;width:100%;margin-bottom: 30px&quot;
        :loading=&quot;loading&quot;
        @click=&quot;handleLogin&quot;
        &gt;login
      &lt;/el-button&gt;
    &lt;/el-form&gt;
  &lt;/div&gt;
&lt;/template&gt;
</code></pre>
<p>js</p>
<pre><code class="js">&lt;script setup&gt;
import &#123; ref, computed &#125; from &#39;vue&#39;
import &#123; validatePassword &#125; from &#39;./rules&#39;
import &#123; useStore &#125; from &#39;vuex&#39;
import &#123; useRouter &#125; from &#39;vue-router&#39;

// 数据源
const loginForm = ref(&#123;
  username: &#39;super-admin&#39;,
  password: &#39;123456&#39;
&#125;)
// 验证规则
const loginRules = ref(&#123;
  username: [&#123;
    required: true,
    trigger: &#39;blur&#39;,
    message: computed(() =&gt; &#123;
      return &#39;error&#39;
    &#125;)
  &#125;
  ],
  password: [
    &#123;
      required: true,
      trigger: &#39;blur&#39;,
      validator: validatePassword()
    &#125;
  ]
&#125;)
// 处理密码
const passwordType = ref(&#39;password&#39;)
const onChangePwdType = () =&gt; &#123;
  if (passwordType.value === &#39;password&#39;) &#123;
    passwordType.value = &#39;text&#39;
  &#125; else &#123;
    passwordType.value = &#39;password&#39;
  &#125;
&#125;
// 登录
const loading = ref(false)
const loginFormRef = ref(null)
const router = useRouter()
const store = useStore()
const handleLogin = () =&gt; &#123;
  loginFormRef.value.validate(valid =&gt; &#123;
    if (!valid) return
    loading.value = false
    store.dispatch(&#39;user/login&#39;, loginForm.value).then(() =&gt; &#123;
      loading.value = false
      router.push(&#39;/&#39;)
    &#125;).catch(err =&gt; &#123;
      console.log(err)
      loading.value = false
    &#125;)
  &#125;)
&#125;

&lt;/script&gt;
</code></pre>
<p>校验规则：</p>
<pre><code class="js">export const validatePassword = () =&gt; &#123;
  return (rule, value, callback) =&gt; &#123;
    if (value.length &lt; 6) &#123;
      // callback(new Error(i18n.global.t(&#39;msg.login.passwordRule&#39;)))
      callback(new Error(&quot;error&quot;));
    &#125; else &#123;
      callback();
    &#125;
  &#125;;
&#125;;
</code></pre>
<p>登录页样式：</p>
<pre><code class="scss">&lt;style lang=&quot;scss&quot; scoped&gt;
$bgColor: #2d3a4b;
$dark_gray: #889aa4;
$light_gray: #eee;
$cursor: #fff;

.login-container &#123;
  min-height: 100%;
  width: 100%;
  background-color: $bgColor;
  overflow: hidden;

  .login-form &#123;
    position: relative;
    width: 520px;
    max-width: 100%;
    padding: 160px 35px 0;
    margin: 0 auto;
    overflow: hidden;

    ::v-deep .el-form-item &#123;
      border: 1px solid rgba(255, 255, 255, 0.1);
      background-color: rgba(0, 0, 0, 0.1);
      border-radius: 5px;
      color: #454545;
    &#125;

    ::v-deep .el-input &#123;
      display: inline-block;
      height: 47px;
      width: 85%;

      input &#123;
        background: transparent;
        border: 0px;
        -webkit-appearance: none;
        border-radius: 0px;
        padding: 12px 5px 12px 15px;
        color: $light_gray;
        height: 47px;
        caret-color: $cursor;
      &#125;
    &#125;
  &#125;
&#125;

.svg-container &#123;
  padding: 6px 5px 6px 15px;
  color: $dark_gray;
  vertical-align: middle;
  display: inline-block;
&#125;

.title-container &#123;
  position: relative;

  .title &#123;
    font-size: 26px;
    color: $light_gray;
    margin: 0px auto 40px auto;
    text-align: center;
    font-weight: bold;
  &#125;

  ::v-deep .lang-select &#123;
    position: absolute;
    top: 4px;
    right: 0;
    background-color: white;
    font-size: 22px;
    padding: 4px;
    border-radius: 4px;
    cursor: pointer;
  &#125;
&#125;

.show-pwd &#123;
  position: absolute;
  right: 10px;
  top: 7px;
  font-size: 16px;
  color: $dark_gray;
  cursor: pointer;
  user-select: none;
&#125;
&lt;/style&gt;
</code></pre>
<p>全局样式：src/styles/index.scss</p>
<pre><code class="scss">html,
body &#123;
  height: 100%;
  margin: 0;
  padding: 0;
  -moz-osx-font-smoothing: grayscale;
  -webkit-font-smoothing: antialiased;
  text-rendering: optimizeLegibility;
  font-family: Helvetica Neue, Helvetica, PingFang SC, Hiragino Sans GB, Microsoft
      YaHei, Arial, sans-serif;
&#125;

#app &#123;
  height: 100%;
&#125;

*,
*:before,
*:after &#123;
  box-sizing: inherit;
  margin: 0;
  padding: 0;
&#125;

a:focus,
a:active &#123;
  outline: none;
&#125;

a,
a:focus,
a:hover &#123;
  cursor: pointer;
  color: inherit;
  text-decoration: none;
&#125;

div:focus &#123;
  outline: none;
&#125;

.clearfix &#123;
  &amp;:after &#123;
    visibility: hidden;
    display: block;
    font-size: 0;
    content: &quot; &quot;;
    clear: both;
    height: 0;
  &#125;
&#125;
</code></pre>
<p>导入全局样式</p>
<pre><code class="js">import &quot;./styles/index.scss&quot;;
</code></pre>
<p><code>这里有个坑：</code> 登录页输入框的 svg 小图标不显示</p>
<h2 id="四、icon-图标处理方法：SvgIcon"><a href="#四、icon-图标处理方法：SvgIcon" class="headerlink" title="四、icon 图标处理方法：SvgIcon"></a>四、icon 图标处理方法：SvgIcon</h2><p>结合 vue-element-admin 项目的借鉴，将 icon 图标分为 element-plus 图标和自定义引入图标</p>
<blockquote>
<p>自定义 SVG 图标组件的能力：显示外部引入图标和项目内的 svg 图标</p>
</blockquote>
<p>封装 SvgIcon 组件</p>
<pre><code class="html">&lt;template&gt;
  &lt;div
    v-if=&quot;isExternal&quot;
    :style=&quot;styleExternalIcon&quot;
    class=&quot;svg-external-icon svg-icon&quot;
    :class=&quot;className&quot;
  /&gt;
  &lt;svg v-else class=&quot;svg-icon&quot; :class=&quot;className&quot; aria-hidden=&quot;true&quot;&gt;
    &lt;use :xlink:href=&quot;iconName&quot; /&gt;
  &lt;/svg&gt;
&lt;/template&gt;
</code></pre>
<pre><code class="js">// utils/validate.js
/**
 * 判断是否为外部资源
 */
export function isExternal(path) &#123;
  return /^(https?:|mailto:|tel:)/.test(path)
&#125;


&lt;script setup&gt;
import &#123; isExternal as external &#125; from &#39;@/utils/validate&#39;
import &#123; defineProps, computed &#125; from &#39;vue&#39;

const props = defineProps(&#123;
  icon: &#123;
    type: String,
    required: true
  &#125;,
  className: &#123;
    type: String,
    default: &#39;&#39;
  &#125;
&#125;)
// 判断是否为外部图标
const isExternal = computed(() =&gt; external(props.icon))
// 外部图标样式
const styleExternalIcon = computed(() =&gt; (&#123;
  mask: `url($&#123;props.icon&#125;) no-repeat 50% 50%`,
  &#39;-webkit-mask&#39;: `url($&#123;props.icon&#125;) no-repeat 50% 50%`
&#125;))
// 项目内图标
const iconName = computed(() =&gt; `#icon-$&#123;props.icon&#125;`)

&lt;/script&gt;
</code></pre>
<p>样式</p>
<pre><code class="scss">.svg-icon &#123;
  width: 1em;
  height: 1em;
  vertical-align: -0.15em;
  fill: currentColor;
  overflow: hidden;
&#125;

.svg-external-icon &#123;
  background-color: currentColor;
  mask-size: cover !important;
  display: inline-block;
&#125;
</code></pre>
<p>上面只处理了外部 svg 图标的展示，还要处理 element-plus 的图标</p>
<p>// 创建 icons 文件夹 内部包含：内部 svg 图标、SvgIcon 全局注册</p>
<pre><code class="js">import SvgIcon from &quot;@/components/SvgIcon&quot;;
// 通过 require.context() 函数来创建自己的 context
const svgRequire = require.context(&quot;./svg&quot;, false, /\.svg$/);
// 此时返回一个 require 的函数，可以接受一个 request 的参数，用于 require 的导入。
// 该函数提供了三个属性，可以通过 require.keys() 获取到所有的 svg 图标
// 遍历图标，把图标作为 request 传入到 require 导入函数中，完成本地 svg 图标的导入

svgRequire.keys().forEach((SvgIcon) =&gt; svgRequire(SvgIcon));

export default (app) =&gt; &#123;
  app.component(&quot;svg-icon&quot;, SvgIcon);
&#125;;
</code></pre>
<p>main.js 引入 svgIcon</p>
<pre><code class="js">// 导入 svgIcon
import installIcons from &quot;@/icons&quot;;
installIcons(app);
</code></pre>
<p><code>此时，svg图标仍然不显示</code>，还需要使用 svg-sprite-loader 处理 svg 图标</p>
<pre><code class="shell">npm i --save-dev svg-sprite-loader@6.0.9
</code></pre>
<p>配置 vue.config.js</p>
<pre><code class="js">const path = require(&quot;path&quot;);
function resolve(dir) &#123;
  return path.join(__dirname, dir);
&#125;

module.exports = &#123;
  chainWebpack(config) &#123;
    // 设置 svg-sprite-loader
    config.module.rule(&quot;svg&quot;).exclude.add(resolve(&quot;src/icons&quot;)).end();
    config.module
      .rule(&quot;icons&quot;)
      .test(/\.svg$/)
      .include.add(resolve(&quot;src/icons&quot;))
      .end()
      .use(&quot;svg-sprite-loader&quot;)
      .loader(&quot;svg-sprite-loader&quot;)
      .options(&#123;
        symbolId: &quot;icon-[name]&quot;,
      &#125;)
      .end();
  &#125;,
&#125;;
</code></pre>
<p>至此，svg 图标可以正常显示。</p>
</article><section class="jump-container is-flex is-justify-content-space-between my-6"><!-- em is empty placeholder--><em></em><a class="button is-default" href="/2022/08/16/91-vue3-ele-plus-admin/" title="91、使用vue3+element-plus写后台管理系统：（一）"><span class="has-text-weight-semibold">下一页: 91、使用vue3+element-plus写后台管理系统：（一）</span><i class="iconfont icon-next ml-2 has-text-grey"></i></a></section></div></div></main></main><footer class="is-flex is-flex-direction-column is-align-items-center is-flex-shrink-0 is-family-serif"><section class="sns-container"><!-- Github--><a title="github" target="_blank" rel="noopener nofollow" href="//github.com/Jude"><i class="iconfont icon-github"></i></a><!-- Ins--><!-- RSS--><!-- 知乎--><a title="zhihu" target="_blank" rel="noopener nofollow" href="//zhihu.com/https://www.zhihu.com"><i class="iconfont icon-zhihu"></i></a><!-- 领英--><!-- 脸书--></section><p><span>Copyright ©</span><span> Jude 2022</span></p><div class="is-flex is-justify-content-center is-flex-wrap-wrap"><p>Powered by Hexo &verbar;&nbsp;</p><p class="is-flex is-justify-content-center"><a title="Hexo theme author" target="_blank" rel="noopener" href="//github.com/haojen">Theme by Haojen&nbsp;</a></p><div style="margin-top: 2px"><a class="github-button" title="github-button" target="_blank" rel="noopener" href="https://github.com/haojen/hexo-theme-Claudia" data-color-scheme="no-preference: light; light: light; dark: dark;" data-show-count="true"></a></div></div><div><span>记住昨日的美好，过好今日的生活，憧憬明天的到来</span></div></footer><script async defer src="https://buttons.github.io/buttons.js"></script><script src="/js/post.js"></script></body></html>