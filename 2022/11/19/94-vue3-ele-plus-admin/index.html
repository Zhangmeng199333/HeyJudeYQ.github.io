<!DOCTYPE html><html class="appearance-auto" lang="zh-CN"><head><meta charset="UTF-8"><title>94、使用vue3+element-plus写后台管理系统：（四）</title><meta name="description" content="呦呦鹿鸣，食野之苹"><meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no, initial-scale=1"><!-- Google Analytics --><!-- End Google Analytics -->
<!-- Baidu Analytics --><!-- End Baidu Analytics --><link rel="icon" href="/images/favicon.png"><link rel="stylesheet" href="/style/common/bulma.css"><link rel="stylesheet" href="/style/base.css"><link rel="stylesheet" href="/style/common/helper.css"><script src="/js/common.js"></script><link rel="stylesheet" href="/style/post.css"><link rel="stylesheet" href="/style/themes/highlight-theme-light.css"><script src="/js/highlight.pack.js"></script><meta name="description" content="包括后台项目 layout 基础架构、用户主动和被动退出、动态 menu 菜单、结构路由表、侧边菜单栏的收缩、组件状态驱动的动态 CSS 值


layout 基础架构布局
layout 基本布局结构包括：Menu 菜单栏、NavBar 顶部导航栏（包含个人信息）、Main（页面主要展示区域）
1、登录成功进入首页之后，整个首页也就是上面说的分为三个部分创建三个对应的组件

layout&amp;#x2F;components&amp;#x2F;Sidebar&amp;#x2F;index.vuelayout&amp;#x2F;components&amp;#x2F;Navbar.vuelayout&amp;#x2F;components&amp;#x2F;AppMain.vue

2、在layout/index引入创建的三个组件123import Navbar.."><meta name="generator" content="Hexo 4.2.1"></head><body class="is-flex is-flex-direction-column"><header class="header-widget is-flex-shrink-0 is-hidden-mobile"><div class="container is-fullhd is-flex is-justify-content-space-between is-align-items-center is-full-height"><section class="is-hidden-mobile is-flex-shrink-0"><h2><a href="/">Jude's blog</a></h2></section><h3 class="is-hidden-mobile is-family-serif is-full-height is-flex is-align-items-center is-flex-shrink-0"><div class="is-full-height" id="postTopic"><p class="is-full-height is-flex-shrink-0 is-flex is-align-items-center is-justify-content-center">94、使用vue3+element-plus写后台管理系统：（四）</p><p class="is-full-height is-flex-shrink-0 is-flex is-align-items-center is-justify-content-center">点击返回顶部</p></div></h3><aside class="is-flex-shrink-0"><h3 class="is-inline-block"><a href="/">首页</a></h3><h3 class="is-inline-block"><a href="/about">关于</a></h3><h3 class="is-inline-block"><a href="/archives">归档</a></h3></aside></div></header><header class="is-flex header-widget is-flex-shrink-0 is-align-items-center is-justify-content-center is-hidden-tablet"><h3 class="is-inline-block"><a href="/">首页</a></h3><h3 class="is-inline-block"><a href="/about">关于</a></h3><h3 class="is-inline-block"><a href="/archives">归档</a></h3></header><main><main class="container is-max-widescreen content section post-page pt-4 px-4"><div class="columns is-flex-desktop is-justify-content-center is-flex-direction-row-reverse"><div class="column is-3 is-hidden-mobile"><ol class="toc"><li class="toc-item toc-level-4"><a class="toc-link" href="#1、登录成功进入首页之后，整个首页也就是上面说的分为三个部分"><span class="toc-text">1、登录成功进入首页之后，整个首页也就是上面说的分为三个部分</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2、在layout-index引入创建的三个组件"><span class="toc-text">2、在layout&#x2F;index引入创建的三个组件</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3、layout-index对应的布局"><span class="toc-text">3、layout&#x2F;index对应的布局</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4、在-styles-文件夹下定义-3-个-scss-文件"><span class="toc-text">4、在 styles 文件夹下定义 3 个 scss 文件</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5、创建的三个-scss-文件导入到-styles-index-scss"><span class="toc-text">5、创建的三个 scss 文件导入到 styles&#x2F;index.scss</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6、侧边栏要实现主题更换功能，sidebar-赋值动态背景颜色"><span class="toc-text">6、侧边栏要实现主题更换功能，sidebar 赋值动态背景颜色</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#7、Navbar、Sidebar、AppMain-组件初始化代码占位及样式修改"><span class="toc-text">7、Navbar、Sidebar、AppMain 组件初始化代码占位及样式修改</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#8、用户个人信息"><span class="toc-text">8、用户个人信息</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#9、element-plus-的-dropdown-avatar-组件实现用户头像信息及用户主动退出功能"><span class="toc-text">9、element-plus 的 dropdown avatar 组件实现用户头像信息及用户主动退出功能</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#10、主动退出功能-在-store-moduels-user-js-中，清除当前用户缓存数据、清除用户权限相关配置、返回到登录页"><span class="toc-text">10、主动退出功能:在 store&#x2F;moduels&#x2F;user.js 中，清除当前用户缓存数据、清除用户权限相关配置、返回到登录页</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#11、被动退出功能：token-过期、单一账户同时登录"><span class="toc-text">11、被动退出功能：token 过期、单一账户同时登录</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#12、临时menu菜单"><span class="toc-text">12、临时menu菜单</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#13、动态-menu-菜单处理"><span class="toc-text">13、动态 menu 菜单处理</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#14、创建页面组件"><span class="toc-text">14、创建页面组件</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#15、用户权限处理"><span class="toc-text">15、用户权限处理</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#16、解析路由表，获取结构化数据"><span class="toc-text">16、解析路由表，获取结构化数据</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#17、处理数据结构问题"><span class="toc-text">17、处理数据结构问题</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#18、SidebarMenu-调用-filterRouters、generateMenus-方法"><span class="toc-text">18、SidebarMenu 调用 filterRouters、generateMenus 方法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#19、生成动态-menu-菜单"><span class="toc-text">19、生成动态 menu 菜单</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#20、菜单的伸缩功能"><span class="toc-text">20、菜单的伸缩功能</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#21、创建收缩-icon-组件-hamburger"><span class="toc-text">21、创建收缩 icon 组件 hamburger</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#22、SidebarHeader-处理"><span class="toc-text">22、SidebarHeader 处理</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#23、组件状态驱动的动态-CSS-值"><span class="toc-text">23、组件状态驱动的动态 CSS 值</span></a></li></ol></div><div class="column is-9"><header class="my-4"><a href="/tags/vue3"><i class="tag post-item-tag">vue3</i></a></header><h1 class="mt-0 mb-1 is-family-serif" id="postTitle">94、使用vue3+element-plus写后台管理系统：（四）</h1><time class="has-text-grey" datetime="2022-11-19T12:00:00.000Z">2022-11-19</time><article class="mt-2 post-content"><p>包括后台项目 layout 基础架构、用户主动和被动退出、动态 menu 菜单、结构路由表、侧边菜单栏的收缩、组件状态驱动的动态 CSS 值</p>
<a id="more"></a>

<p>layout 基础架构布局</p>
<p>layout 基本布局结构包括：Menu 菜单栏、NavBar 顶部导航栏（包含个人信息）、Main（页面主要展示区域）</p>
<h4 id="1、登录成功进入首页之后，整个首页也就是上面说的分为三个部分"><a href="#1、登录成功进入首页之后，整个首页也就是上面说的分为三个部分" class="headerlink" title="1、登录成功进入首页之后，整个首页也就是上面说的分为三个部分"></a>1、登录成功进入首页之后，整个首页也就是上面说的分为三个部分</h4><p>创建三个对应的组件</p>
<blockquote>
<p>layout&#x2F;components&#x2F;Sidebar&#x2F;index.vue<br>layout&#x2F;components&#x2F;Navbar.vue<br>layout&#x2F;components&#x2F;AppMain.vue</p>
</blockquote>
<h4 id="2、在layout-index引入创建的三个组件"><a href="#2、在layout-index引入创建的三个组件" class="headerlink" title="2、在layout/index引入创建的三个组件"></a>2、在<code>layout/index</code>引入创建的三个组件</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">import</span> Navbar <span class="hljs-keyword">from</span> <span class="hljs-string">"./components/Navbar.vue"</span>;<br><span class="hljs-keyword">import</span> Sidebar <span class="hljs-keyword">from</span> <span class="hljs-string">"./components/Sidebar/index.vue"</span>;<br><span class="hljs-keyword">import</span> AppMain <span class="hljs-keyword">from</span> <span class="hljs-string">"./components/AppMain"</span>;<br></code></pre></td></tr></table></figure>

<h4 id="3、layout-index对应的布局"><a href="#3、layout-index对应的布局" class="headerlink" title="3、layout/index对应的布局"></a>3、<code>layout/index</code>对应的布局</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"app-wrapper"</span>&gt;</span><br>    <span class="hljs-comment">&lt;!-- 左侧 menu --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">sidebar</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"sidebar-container"</span> /&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"main-container"</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"fixed-header"</span>&gt;</span><br>        <span class="hljs-comment">&lt;!-- 顶部的 navbar --&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">navbar</span> /&gt;</span><br>      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>      <span class="hljs-comment">&lt;!-- 内容区 --&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">app-main</span> /&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span><br></code></pre></td></tr></table></figure>

<h4 id="4、在-styles-文件夹下定义-3-个-scss-文件"><a href="#4、在-styles-文件夹下定义-3-个-scss-文件" class="headerlink" title="4、在 styles 文件夹下定义 3 个 scss 文件"></a>4、在 styles 文件夹下定义 3 个 scss 文件</h4><blockquote>
<p>variables.scss 定义常量<br>mixin.scss 定义通用的 css<br>sidebar.scss 处理 menu 菜单的样式</p>
</blockquote>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs css">// variables.scss<br>// sidebar的样式  定义如下常量将其导出<br>$menuText: #bfcbd9;<br>$menuActiveText: #ffffff;<br>$subMenuActiveText: #f4f4f5;<br><br>$menuBg: #304156;<br>$menuHover: #263445;<br><br>$subMenuBg: #1f2d3d;<br>$subMenuHover: #001528;<br><br>$sideBarWidth: 210px;<br><br>// JS 与 scss 共享变量，在 scss 中通过 :export 进行导出，在 js 中可通过 ESM 进行导入<br><span class="hljs-selector-pseudo">:export</span> &#123;<br>  <span class="hljs-attribute">menuText</span>: $menuText;<br>  <span class="hljs-attribute">menuActiveText</span>: $menuActiveText;<br>  <span class="hljs-attribute">subMenuActiveText</span>: $subMenuActiveText;<br>  <span class="hljs-attribute">menuBg</span>: $menuBg;<br>  <span class="hljs-attribute">menuHover</span>: $menuHover;<br>  <span class="hljs-attribute">subMenuBg</span>: $subMenuBg;<br>  <span class="hljs-attribute">subMenuHover</span>: $subMenuHover;<br>  <span class="hljs-attribute">sideBarWidth</span>: $sideBarWidth;<br>&#125;<br></code></pre></td></tr></table></figure>

<blockquote>
<p><code>注意</code>:这里是使用 :export{ } 方法将 css 常量导出</p>
</blockquote>
<p><code>mixin.scss</code></p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs css">// mixin.scss<br><span class="hljs-keyword">@mixin</span> clearfix &#123;<br>  &amp;<span class="hljs-selector-pseudo">:after</span> &#123;<br>    <span class="hljs-attribute">content</span>: <span class="hljs-string">""</span>;<br>    <span class="hljs-attribute">display</span>: table;<br>    <span class="hljs-attribute">clear</span>: both;<br>  &#125;<br>&#125;<br><br><span class="hljs-keyword">@mixin</span> scrollBar &#123;<br>  &amp;<span class="hljs-selector-pseudo">::-webkit-scrollbar-track-piece</span> &#123;<br>    <span class="hljs-attribute">background</span>: <span class="hljs-number">#d3dce6</span>;<br>  &#125;<br><br>  &amp;<span class="hljs-selector-pseudo">::-webkit-scrollbar</span> &#123;<br>    <span class="hljs-attribute">width</span>: <span class="hljs-number">6px</span>;<br>  &#125;<br><br>  &amp;<span class="hljs-selector-pseudo">::-webkit-scrollbar-thumb</span> &#123;<br>    <span class="hljs-attribute">background</span>: <span class="hljs-number">#99a9bf</span>;<br>    <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">20px</span>;<br>  &#125;<br>&#125;<br><br><span class="hljs-keyword">@mixin</span> relative &#123;<br>  <span class="hljs-selector-tag">position</span>: <span class="hljs-selector-tag">relative</span>;<br>  <span class="hljs-selector-tag">width</span>: 100%;<br>  <span class="hljs-selector-tag">height</span>: 100%;<br>&#125;<br></code></pre></td></tr></table></figure>

<p><code>sidebar.scss</code></p>
<details>
<summary>点我展示代码</summary>

<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br></pre></td><td class="code"><pre><code class="hljs css">// sidebar.scss<br><span class="hljs-selector-id">#app</span> &#123;<br>  .main-container &#123;<br>    <span class="hljs-selector-tag">min-height</span>: 100%;<br>    <span class="hljs-selector-tag">transition</span>: <span class="hljs-selector-tag">margin-left</span> 0<span class="hljs-selector-class">.28s</span>;<br>    margin-left: $sideBarWidth;<br>    <span class="hljs-selector-tag">position</span>: <span class="hljs-selector-tag">relative</span>;<br>  &#125;<br><br>  <span class="hljs-selector-class">.sidebar-container</span> &#123;<br>    <span class="hljs-attribute">transition</span>: width <span class="hljs-number">0.28s</span>;<br>    <span class="hljs-attribute">width</span>: $sideBarWidth <span class="hljs-meta">!important</span>;<br>    <span class="hljs-attribute">height</span>: <span class="hljs-number">100%</span>;<br>    <span class="hljs-attribute">position</span>: fixed;<br>    <span class="hljs-attribute">top</span>: <span class="hljs-number">0</span>;<br>    <span class="hljs-attribute">bottom</span>: <span class="hljs-number">0</span>;<br>    <span class="hljs-attribute">left</span>: <span class="hljs-number">0</span>;<br>    <span class="hljs-attribute">z-index</span>: <span class="hljs-number">1001</span>;<br>    <span class="hljs-attribute">overflow</span>: hidden;<br><br>    // 重置 element-plus 的css<br>    <span class="hljs-selector-class">.horizontal-collapse-transition</span> &#123;<br>      <span class="hljs-attribute">transition</span>: <span class="hljs-number">0s</span> width ease-in-out, <span class="hljs-number">0s</span> padding-left ease-in-out,<br>        <span class="hljs-number">0s</span> padding-right ease-in-out;<br>    &#125;<br><br>    <span class="hljs-selector-class">.scrollbar-wrapper</span> &#123;<br>      <span class="hljs-attribute">overflow-x</span>: hidden <span class="hljs-meta">!important</span>;<br>    &#125;<br><br>    <span class="hljs-selector-class">.el-scrollbar__bar</span><span class="hljs-selector-class">.is-vertical</span> &#123;<br>      <span class="hljs-attribute">right</span>: <span class="hljs-number">0px</span>;<br>    &#125;<br><br>    <span class="hljs-selector-class">.el-scrollbar</span> &#123;<br>      <span class="hljs-attribute">height</span>: <span class="hljs-number">100%</span>;<br>    &#125;<br><br>    &amp;<span class="hljs-selector-class">.has-logo</span> &#123;<br>      .el-scrollbar &#123;<br>        <span class="hljs-selector-tag">height</span>: <span class="hljs-selector-tag">calc</span>(100% <span class="hljs-selector-tag">-</span> 50<span class="hljs-selector-tag">px</span>);<br>      &#125;<br>    &#125;<br><br>    <span class="hljs-selector-class">.is-horizontal</span> &#123;<br>      <span class="hljs-attribute">display</span>: none;<br>    &#125;<br><br>    <span class="hljs-selector-tag">a</span> &#123;<br>      <span class="hljs-attribute">display</span>: inline-block;<br>      <span class="hljs-attribute">width</span>: <span class="hljs-number">100%</span>;<br>      <span class="hljs-attribute">overflow</span>: hidden;<br>    &#125;<br><br>    <span class="hljs-selector-class">.svg-icon</span> &#123;<br>      <span class="hljs-attribute">margin-right</span>: <span class="hljs-number">16px</span>;<br>    &#125;<br><br>    <span class="hljs-selector-class">.sub-el-icon</span> &#123;<br>      <span class="hljs-attribute">margin-right</span>: <span class="hljs-number">12px</span>;<br>      <span class="hljs-attribute">margin-left</span>: -<span class="hljs-number">2px</span>;<br>    &#125;<br><br>    <span class="hljs-selector-class">.el-menu</span> &#123;<br>      <span class="hljs-attribute">border</span>: none;<br>      <span class="hljs-attribute">height</span>: <span class="hljs-number">100%</span>;<br>      <span class="hljs-attribute">width</span>: <span class="hljs-number">100%</span> <span class="hljs-meta">!important</span>;<br>    &#125;<br><br>    <span class="hljs-selector-class">.is-active</span> &gt; <span class="hljs-selector-class">.el-submenu__title</span> &#123;<br>      <span class="hljs-attribute">color</span>: $subMenuActiveText <span class="hljs-meta">!important</span>;<br>    &#125;<br><br>    &amp; <span class="hljs-selector-class">.nest-menu</span> <span class="hljs-selector-class">.el-submenu</span> &gt; <span class="hljs-selector-class">.el-submenu__title</span>,<br>    &amp; <span class="hljs-selector-class">.el-submenu</span> <span class="hljs-selector-class">.el-menu-item</span> &#123;<br>      <span class="hljs-attribute">min-width</span>: $sideBarWidth <span class="hljs-meta">!important</span>;<br>    &#125;<br>  &#125;<br><br>  <span class="hljs-selector-class">.hideSidebar</span> &#123;<br>    .sidebar-container &#123;<br>      <span class="hljs-selector-tag">width</span>: 54<span class="hljs-selector-tag">px</span> !<span class="hljs-selector-tag">important</span>;<br>    &#125;<br><br>    <span class="hljs-selector-class">.main-container</span> &#123;<br>      <span class="hljs-attribute">margin-left</span>: <span class="hljs-number">54px</span>;<br>    &#125;<br><br>    <span class="hljs-selector-class">.submenu-title-noDropdown</span> &#123;<br>      <span class="hljs-attribute">padding</span>: <span class="hljs-number">0</span> <span class="hljs-meta">!important</span>;<br>      <span class="hljs-attribute">position</span>: relative;<br><br>      .el-tooltip &#123;<br>        <span class="hljs-selector-tag">padding</span>: 0 !<span class="hljs-selector-tag">important</span>;<br><br>        <span class="hljs-selector-class">.svg-icon</span> &#123;<br>          <span class="hljs-attribute">margin-left</span>: <span class="hljs-number">20px</span>;<br>        &#125;<br><br>        <span class="hljs-selector-class">.sub-el-icon</span> &#123;<br>          <span class="hljs-attribute">margin-left</span>: <span class="hljs-number">19px</span>;<br>        &#125;<br>      &#125;<br>    &#125;<br><br>    <span class="hljs-selector-class">.el-submenu</span> &#123;<br>      <span class="hljs-attribute">overflow</span>: hidden;<br><br>      &amp; &gt; .el-submenu__title &#123;<br>        <span class="hljs-selector-tag">padding</span>: 0 !<span class="hljs-selector-tag">important</span>;<br><br>        <span class="hljs-selector-class">.svg-icon</span> &#123;<br>          <span class="hljs-attribute">margin-left</span>: <span class="hljs-number">20px</span>;<br>        &#125;<br><br>        <span class="hljs-selector-class">.sub-el-icon</span> &#123;<br>          <span class="hljs-attribute">margin-left</span>: <span class="hljs-number">19px</span>;<br>        &#125;<br><br>        <span class="hljs-selector-class">.el-submenu__icon-arrow</span> &#123;<br>          <span class="hljs-attribute">display</span>: none;<br>        &#125;<br>      &#125;<br>    &#125;<br><br>    <span class="hljs-selector-class">.el-menu--collapse</span> &#123;<br>      .el-submenu &#123;<br>        &amp; &gt; <span class="hljs-selector-class">.el-submenu__title</span> &#123;<br>          &amp; &gt; span &#123;<br>            <span class="hljs-selector-tag">height</span>: 0;<br>            <span class="hljs-selector-tag">width</span>: 0;<br>            <span class="hljs-selector-tag">overflow</span>: <span class="hljs-selector-tag">hidden</span>;<br>            <span class="hljs-selector-tag">visibility</span>: <span class="hljs-selector-tag">hidden</span>;<br>            <span class="hljs-selector-tag">display</span>: <span class="hljs-selector-tag">inline-block</span>;<br>          &#125;<br>        &#125;<br>      &#125;<br>    &#125;<br>  &#125;<br><br>  <span class="hljs-selector-class">.el-menu--collapse</span> <span class="hljs-selector-class">.el-menu</span> <span class="hljs-selector-class">.el-submenu</span> &#123;<br>    <span class="hljs-attribute">min-width</span>: $sideBarWidth <span class="hljs-meta">!important</span>;<br>  &#125;<br><br>  <span class="hljs-selector-class">.withoutAnimation</span> &#123;<br>    .main-container,<br>    <span class="hljs-selector-class">.sidebar-container</span> &#123;<br>      <span class="hljs-attribute">transition</span>: none;<br>    &#125;<br>  &#125;<br>&#125;<br><br><span class="hljs-selector-class">.el-menu--vertical</span> &#123;<br>  &amp; &gt; .el-menu &#123;<br>    <span class="hljs-selector-class">.svg-icon</span> &#123;<br>      <span class="hljs-attribute">margin-right</span>: <span class="hljs-number">16px</span>;<br>    &#125;<br>    <span class="hljs-selector-class">.sub-el-icon</span> &#123;<br>      <span class="hljs-attribute">margin-right</span>: <span class="hljs-number">12px</span>;<br>      <span class="hljs-attribute">margin-left</span>: -<span class="hljs-number">2px</span>;<br>    &#125;<br>  &#125;<br><br>  // 菜单项过长时<br><br>  &gt; <span class="hljs-selector-class">.el-menu--popup</span> &#123;<br>    <span class="hljs-attribute">max-height</span>: <span class="hljs-number">100vh</span>;<br>    <span class="hljs-attribute">overflow-y</span>: auto;<br><br>    &amp;::-webkit-scrollbar-track-piece &#123;<br>      <span class="hljs-selector-tag">background</span>: <span class="hljs-selector-id">#d3dce6</span>;<br>    &#125;<br><br>    &amp;<span class="hljs-selector-pseudo">::-webkit-scrollbar</span> &#123;<br>      <span class="hljs-attribute">width</span>: <span class="hljs-number">6px</span>;<br>    &#125;<br><br>    &amp;<span class="hljs-selector-pseudo">::-webkit-scrollbar-thumb</span> &#123;<br>      <span class="hljs-attribute">background</span>: <span class="hljs-number">#99a9bf</span>;<br>      <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">20px</span>;<br>    &#125;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

</details>

<h4 id="5、创建的三个-scss-文件导入到-styles-index-scss"><a href="#5、创建的三个-scss-文件导入到-styles-index-scss" class="headerlink" title="5、创建的三个 scss 文件导入到 styles&#x2F;index.scss"></a>5、创建的三个 scss 文件导入到 styles&#x2F;index.scss</h4><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs css">// index.scss<br><span class="hljs-keyword">@import</span> <span class="hljs-string">"./variables.scss"</span>;<br><span class="hljs-keyword">@import</span> <span class="hljs-string">"./mixin.scss"</span>;<br><span class="hljs-keyword">@import</span> <span class="hljs-string">"./sidebar.scss"</span>;<br></code></pre></td></tr></table></figure>

<p><code>layout/index.vue</code>写入样式</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs css">&lt;style lang="scss" scoped&gt;<br><span class="hljs-keyword">@import</span> <span class="hljs-string">'@/styles/mixin.scss'</span>;<br><span class="hljs-keyword">@import</span> <span class="hljs-string">'@/styles/variables.scss'</span>;<br><br><span class="hljs-selector-class">.app-wrapper</span> &#123;<br>  @include clearfix;<br>  <span class="hljs-selector-tag">position</span>: <span class="hljs-selector-tag">relative</span>;<br>  <span class="hljs-selector-tag">height</span>: 100%;<br>  <span class="hljs-selector-tag">width</span>: 100%;<br>&#125;<br><br><span class="hljs-selector-class">.fixed-header</span> &#123;<br>  <span class="hljs-attribute">position</span>: fixed;<br>  <span class="hljs-attribute">top</span>: <span class="hljs-number">0</span>;<br>  <span class="hljs-attribute">right</span>: <span class="hljs-number">0</span>;<br>  <span class="hljs-attribute">z-index</span>: <span class="hljs-number">9</span>;<br>  <span class="hljs-attribute">width</span>: <span class="hljs-built_in">calc</span>(<span class="hljs-number">100%</span> - #&#123;$sideBarWidth&#125;);<br>&#125;<br>&lt;/style&gt;<br></code></pre></td></tr></table></figure>

<h4 id="6、侧边栏要实现主题更换功能，sidebar-赋值动态背景颜色"><a href="#6、侧边栏要实现主题更换功能，sidebar-赋值动态背景颜色" class="headerlink" title="6、侧边栏要实现主题更换功能，sidebar 赋值动态背景颜色"></a>6、<code>侧边栏</code>要实现<code>主题更换</code>功能，sidebar 赋值动态背景颜色</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span><br>  ...<br>  <span class="hljs-comment">&lt;!-- 左侧 menu --&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">sidebar</span></span><br><span class="hljs-tag">    <span class="hljs-attr">class</span>=<span class="hljs-string">"sidebar-container"</span></span><br><span class="hljs-tag">    <span class="hljs-attr">:style</span>=<span class="hljs-string">"&#123; backgroundColor: variables.menuBg &#125;"</span></span><br><span class="hljs-tag">  /&gt;</span><br>  ...<br><span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span>&gt;</span><br><span class="javascript">  <span class="hljs-keyword">import</span> variables <span class="hljs-keyword">from</span> <span class="hljs-string">"@/styles/variables.scss"</span>;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br></code></pre></td></tr></table></figure>

<h4 id="7、Navbar、Sidebar、AppMain-组件初始化代码占位及样式修改"><a href="#7、Navbar、Sidebar、AppMain-组件初始化代码占位及样式修改" class="headerlink" title="7、Navbar、Sidebar、AppMain 组件初始化代码占位及样式修改"></a>7、Navbar、Sidebar、AppMain 组件初始化代码占位及样式修改</h4><p>需要处理 AppMain 组件和 Navbar 组件重叠问题</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"app-main"</span>&gt;</span>AppMain<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">style</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"scss"</span> <span class="hljs-attr">scoped</span>&gt;</span><br><span class="css">  <span class="hljs-selector-class">.app-main</span> &#123;</span><br>    min-height: calc(100vh - 50px);<br>    width: 100%;<br>    position: relative;<br>    overflow: hidden;<br>    padding: 61px 20px 20px 20px;<br>    box-sizing: border-box;<br>  &#125;<br><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span><br></code></pre></td></tr></table></figure>

<h4 id="8、用户个人信息"><a href="#8、用户个人信息" class="headerlink" title="8、用户个人信息"></a>8、用户个人信息</h4><p>这里需要处理一下用户个人信息展示</p>
<p><code>api/sys.js</code>文件定义方法、axios 请求拦截器对 token 进行 header 注入</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * 获取用户信息</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> getUserInfo = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> &#123;<br>  <span class="hljs-keyword">return</span> request(&#123;<br>    url: <span class="hljs-string">"/sys/profile"</span>,<br>  &#125;);<br>&#125;;<br><br><span class="hljs-comment">// utils/request.js</span><br><span class="hljs-keyword">import</span> store <span class="hljs-keyword">from</span> <span class="hljs-string">"@/store"</span>;<br><span class="hljs-comment">// 请求拦截器</span><br>service.interceptors.request.use(<br>  (config) =&gt; &#123;<br>    <span class="hljs-comment">// 在这个位置需要统一的去注入token</span><br>    <span class="hljs-keyword">if</span> (store.getters.token) &#123;<br>      <span class="hljs-comment">// 如果token存在 注入token</span><br>      config.headers.Authorization = <span class="hljs-string">`Bearer <span class="hljs-subst">$&#123;store.getters.token&#125;</span>`</span>;<br>    &#125;<br>    <span class="hljs-keyword">return</span> config; <span class="hljs-comment">// 必须返回配置</span><br>  &#125;,<br>  (error) =&gt; &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">Promise</span>.reject(error);<br>  &#125;<br>);<br></code></pre></td></tr></table></figure>

<p>定义调用接口的动作<code>store/modules/user.js</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">import</span> &#123; login, getUserInfo &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">'@/api/sys'</span><br>...<br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;<br>  namespaced: <span class="hljs-literal">true</span>,<br>  state: <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> (&#123;<br>    ...<br>    userInfo: &#123;&#125;<br>  &#125;),<br>  mutations: &#123;<br>    ...<br>    setUserInfo(state, userInfo) &#123;<br>      state.userInfo = userInfo<br>    &#125;<br>  &#125;,<br>  actions: &#123;<br>    ...<br>    <span class="hljs-keyword">async</span> getUserInfo(context) &#123;<br>      <span class="hljs-keyword">const</span> res = <span class="hljs-keyword">await</span> getUserInfo()<br>      <span class="hljs-keyword">this</span>.commit(<span class="hljs-string">'user/setUserInfo'</span>, res)<br>      <span class="hljs-keyword">return</span> res<br>    &#125;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>在权限拦截时触发的动作<code>permission.js</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs js">  <span class="hljs-keyword">if</span> (to.path === <span class="hljs-string">'/login'</span>) &#123;<br>    ...<br>  &#125; <span class="hljs-keyword">else</span> &#123;<br>    <span class="hljs-comment">// 判断用户资料是否获取</span><br>    <span class="hljs-comment">// 若不存在用户信息，则需要获取用户信息</span><br>    <span class="hljs-keyword">if</span> (!store.getters.hasUserInfo) &#123;<br>      <span class="hljs-comment">// 触发获取用户信息的 action</span><br>      <span class="hljs-keyword">await</span> store.dispatch(<span class="hljs-string">'user/getUserInfo'</span>)<br>    &#125;<br>    next()<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>写入判断用户信息<code>store/getters.js</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> getters = &#123;<br>  ...<br>  userInfo: <span class="hljs-function"><span class="hljs-params">state</span> =&gt;</span> state.user.userInfo,<br>  <span class="hljs-comment">/**</span><br><span class="hljs-comment">   * <span class="hljs-doctag">@returns </span>true 表示已存在用户信息</span><br><span class="hljs-comment">   */</span><br>  hasUserInfo: <span class="hljs-function"><span class="hljs-params">state</span> =&gt;</span> &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">JSON</span>.stringify(state.user.userInfo) !== <span class="hljs-string">'&#123;&#125;'</span><br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<h4 id="9、element-plus-的-dropdown-avatar-组件实现用户头像信息及用户主动退出功能"><a href="#9、element-plus-的-dropdown-avatar-组件实现用户头像信息及用户主动退出功能" class="headerlink" title="9、element-plus 的 dropdown avatar 组件实现用户头像信息及用户主动退出功能"></a>9、element-plus 的 dropdown avatar 组件实现用户头像信息及用户主动退出功能</h4><p><code>用户头像功能及下拉菜单栏</code></p>
<details>
<summary>点我展示代码</summary>

<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><code class="hljs html">// layout/components/navbar.vue<br><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"navbar"</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"right-menu"</span>&gt;</span><br>      <span class="hljs-comment">&lt;!-- 头像 --&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">el-dropdown</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"avatar-container"</span> <span class="hljs-attr">trigger</span>=<span class="hljs-string">"click"</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"avatar-wrapper"</span>&gt;</span><br>          <span class="hljs-tag">&lt;<span class="hljs-name">el-avatar</span></span><br><span class="hljs-tag">            <span class="hljs-attr">shape</span>=<span class="hljs-string">"square"</span></span><br><span class="hljs-tag">            <span class="hljs-attr">:size</span>=<span class="hljs-string">"40"</span></span><br><span class="hljs-tag">            <span class="hljs-attr">:src</span>=<span class="hljs-string">"$store.getters.userInfo.avatar"</span></span><br><span class="hljs-tag">          &gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">el-avatar</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">template</span> #<span class="hljs-attr">dropdown</span>&gt;</span><br>          <span class="hljs-tag">&lt;<span class="hljs-name">el-dropdown-menu</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"user-dropdown"</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">router-link</span> <span class="hljs-attr">to</span>=<span class="hljs-string">"/"</span>&gt;</span><br>              <span class="hljs-tag">&lt;<span class="hljs-name">el-dropdown-item</span>&gt;</span> 首页 <span class="hljs-tag">&lt;/<span class="hljs-name">el-dropdown-item</span>&gt;</span><br>            <span class="hljs-tag">&lt;/<span class="hljs-name">router-link</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">el-dropdown-item</span> <span class="hljs-attr">divided</span>&gt;</span> 退出登录 <span class="hljs-tag">&lt;/<span class="hljs-name">el-dropdown-item</span>&gt;</span><br>          <span class="hljs-tag">&lt;/<span class="hljs-name">el-dropdown-menu</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span><br>      <span class="hljs-tag">&lt;/<span class="hljs-name">el-dropdown</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span>&gt;</span><br><span class="javascript">  <span class="hljs-keyword">import</span> &#123;&#125; <span class="hljs-keyword">from</span> <span class="hljs-string">"vue"</span>;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">style</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"scss"</span> <span class="hljs-attr">scoped</span>&gt;</span><br><span class="css">  <span class="hljs-selector-class">.navbar</span> &#123;</span><br>    height: 50px;<br>    overflow: hidden;<br>    position: relative;<br><span class="css">    <span class="hljs-selector-tag">background</span>: <span class="hljs-selector-id">#fff</span>;</span><br><span class="css">    <span class="hljs-selector-tag">box-shadow</span>: 0 1<span class="hljs-selector-tag">px</span> 4<span class="hljs-selector-tag">px</span> <span class="hljs-selector-tag">rgba</span>(0, 21, 41, 0<span class="hljs-selector-class">.08</span>);</span><br><br><span class="css">    <span class="hljs-selector-class">.right-menu</span> &#123;</span><br>      display: flex;<br>      align-items: center;<br>      float: right;<br>      padding-right: 16px;<br><br><span class="css">      <span class="hljs-selector-pseudo">::v-deep</span> <span class="hljs-selector-class">.avatar-container</span> &#123;</span><br>        cursor: pointer;<br><span class="css">        <span class="hljs-selector-class">.avatar-wrapper</span> &#123;</span><br>          margin-top: 5px;<br>          position: relative;<br><span class="css">          <span class="hljs-selector-tag">n</span> <span class="hljs-selector-class">.el-avatar</span> &#123;</span><br>            --el-avatar-background-color: none;<br>            margin-right: 12px;<br>          &#125;<br>        &#125;<br>      &#125;<br>    &#125;<br>  &#125;<br><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span><br></code></pre></td></tr></table></figure>

</details>

<h4 id="10、主动退出功能-在-store-moduels-user-js-中，清除当前用户缓存数据、清除用户权限相关配置、返回到登录页"><a href="#10、主动退出功能-在-store-moduels-user-js-中，清除当前用户缓存数据、清除用户权限相关配置、返回到登录页" class="headerlink" title="10、主动退出功能:在 store&#x2F;moduels&#x2F;user.js 中，清除当前用户缓存数据、清除用户权限相关配置、返回到登录页"></a>10、<code>主动退出功能</code>:在 store&#x2F;moduels&#x2F;user.js 中，清除当前用户缓存数据、清除用户权限相关配置、返回到登录页</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">import</span> router <span class="hljs-keyword">from</span> <span class="hljs-string">'@/router'</span><br><br>logout() &#123;<br>    <span class="hljs-keyword">this</span>.commit(<span class="hljs-string">'user/setToken'</span>, <span class="hljs-string">''</span>)<br>    <span class="hljs-keyword">this</span>.commit(<span class="hljs-string">'user/setUserInfo'</span>, &#123;&#125;)<br>    removeAllItem()<br>    router.push(<span class="hljs-string">'/login'</span>)<br>&#125;<br></code></pre></td></tr></table></figure>

<p>退出按钮点击事件，触发 logout 的 action</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">import</span> &#123; useStore &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">"vuex"</span>;<br><br><span class="hljs-keyword">const</span> store = useStore();<br><span class="hljs-keyword">const</span> logout = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> &#123;<br>  store.dispatch(<span class="hljs-string">"user/logout"</span>);<br>&#125;;<br></code></pre></td></tr></table></figure>

<h4 id="11、被动退出功能：token-过期、单一账户同时登录"><a href="#11、被动退出功能：token-过期、单一账户同时登录" class="headerlink" title="11、被动退出功能：token 过期、单一账户同时登录"></a>11、<code>被动退出功能</code>：token 过期、单一账户同时登录</h4><p>token 表示一个用户的身份令牌，对服务端而言，只认令牌不认人，所以说一旦其他人获取了你的 token，那么可以伪装成你，来获取对应的敏感数据。</p>
<p>为了保证用户的信息安全，那么对于 token 而言就被制定了很多安全策略。<br>token 的安全策略：动态 token、刷新 token、失效 token</p>
<p>选择时效 token：服务端处理 token 时效的同时，在前端主动介入 token 时效的处理中，从而保证用户信息的安全性。</p>
<p>实现方案：</p>
<blockquote>
<p>1、在用户登录时，记录当前登录时间<br>2、制定失效时长<br>3、接口调用时，根据当前时间对比登录时间，看是否超过了时效时长。如果未超过，则正常进行后续操作；如果超过，则进行退出登录操作</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// utils/auth.js</span><br><span class="hljs-keyword">import</span> &#123; TIME_STAMP, TOKEN_TIMEOUT_VALUE &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">"@/constant"</span>;<br><span class="hljs-keyword">import</span> &#123; setItem, getItem &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">"@/utils/storage"</span>;<br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * 获取时间戳</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">export</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getTimeStamp</span>(<span class="hljs-params"></span>) </span>&#123;<br>  <span class="hljs-keyword">return</span> getItem(TIME_STAMP);<br>&#125;<br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * 设置时间戳</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">export</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">setTimeStamp</span>(<span class="hljs-params"></span>) </span>&#123;<br>  setItem(TIME_STAMP, <span class="hljs-built_in">Date</span>.now());<br>&#125;<br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * 是否超时</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">export</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">isCheckTimeout</span>(<span class="hljs-params"></span>) </span>&#123;<br>  <span class="hljs-comment">// 当前时间戳</span><br>  <span class="hljs-keyword">var</span> currentTime = <span class="hljs-built_in">Date</span>.now();<br>  <span class="hljs-comment">// 缓存时间戳</span><br>  <span class="hljs-keyword">var</span> timeStamp = getTimeStamp();<br>  <span class="hljs-keyword">return</span> currentTime - timeStamp &gt; TOKEN_TIMEOUT_VALUE;<br>&#125;<br><br><span class="hljs-comment">// token时间戳</span><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> TIME_STAMP = <span class="hljs-string">"timeStamp"</span>;<br><span class="hljs-comment">// 超时时长(毫秒) 两小时</span><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> TOKEN_TIMEOUT_VALUE = <span class="hljs-number">2</span> * <span class="hljs-number">3600</span> * <span class="hljs-number">1000</span>;<br></code></pre></td></tr></table></figure>

<p>用户登录成功之后设置时间，到 store&#x2F;user.js 的 login 中：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">import</span> &#123; setTimeStamp &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">'@/utils/auth'</span><br><br>login(context, userInfo) &#123;<br>      ...<br>      <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> &#123;<br>        ...<br>          .then(<span class="hljs-function"><span class="hljs-params">data</span> =&gt;</span> &#123;<br>            ...<br>            <span class="hljs-comment">// 保存登录时间</span><br>            setTimeStamp()<br>            resolve()<br>          &#125;)<br>      &#125;)<br>    &#125;,<br></code></pre></td></tr></table></figure>

<p>在<code>utils/request</code>对应的请求拦截器中进行主动介入</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">import</span> &#123; isCheckTimeout &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">'@/utils/auth'</span><br><br><span class="hljs-keyword">if</span> (store.getters.token) &#123;<br>      <span class="hljs-keyword">if</span> (isCheckTimeout()) &#123;<br>        <span class="hljs-comment">// 登出操作</span><br>        store.dispatch(<span class="hljs-string">'user/logout'</span>)<br>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">Promise</span>.reject(<span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">'token 失效'</span>))<br>      &#125;<br>      ...<br>    &#125;<br><br><span class="hljs-comment">// 响应拦截器</span><br>service.interceptors.response.use(<br>  response =&gt; &#123;<br>    ...<br>  &#125;,<br>  error =&gt; &#123;<br>    <span class="hljs-comment">// 处理 token 超时问题</span><br>    <span class="hljs-keyword">if</span> (<br>      error.response &amp;&amp;<br>      error.response.data &amp;&amp;<br>      error.response.data.code === <span class="hljs-number">401</span><br>    ) &#123;<br>      <span class="hljs-comment">// token超时</span><br>      store.dispatch(<span class="hljs-string">'user/logout'</span>)<br>    &#125;<br>    ElMessage.error(error.message) <span class="hljs-comment">// 提示错误信息</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">Promise</span>.reject(error)<br>  &#125;<br>)<br></code></pre></td></tr></table></figure>

<h4 id="12、临时menu菜单"><a href="#12、临时menu菜单" class="headerlink" title="12、临时menu菜单"></a>12、<code>临时menu菜单</code></h4><p>layout&#x2F;Sidebar&#x2F;SidebarMenu.vue</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span><br>  <span class="hljs-comment">&lt;!-- 一级 menu 菜单 --&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">el-menu</span></span><br><span class="hljs-tag">    <span class="hljs-attr">:uniqueOpened</span>=<span class="hljs-string">"true"</span></span><br><span class="hljs-tag">    <span class="hljs-attr">default-active</span>=<span class="hljs-string">"2"</span></span><br><span class="hljs-tag">    <span class="hljs-attr">background-color</span>=<span class="hljs-string">"#545c64"</span></span><br><span class="hljs-tag">    <span class="hljs-attr">text-color</span>=<span class="hljs-string">"#fff"</span></span><br><span class="hljs-tag">    <span class="hljs-attr">active-text-color</span>=<span class="hljs-string">"#ffd04b"</span></span><br><span class="hljs-tag">  &gt;</span><br>    <span class="hljs-comment">&lt;!-- 子集 menu 菜单 --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">el-submenu</span> <span class="hljs-attr">index</span>=<span class="hljs-string">"1"</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">template</span> #<span class="hljs-attr">title</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">i</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"el-icon-location"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">i</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>导航一<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><br>      <span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">el-menu-item</span> <span class="hljs-attr">index</span>=<span class="hljs-string">"1-1"</span>&gt;</span>选项1<span class="hljs-tag">&lt;/<span class="hljs-name">el-menu-item</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">el-menu-item</span> <span class="hljs-attr">index</span>=<span class="hljs-string">"1-2"</span>&gt;</span>选项2<span class="hljs-tag">&lt;/<span class="hljs-name">el-menu-item</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">el-submenu</span>&gt;</span><br>    <span class="hljs-comment">&lt;!-- 具体菜单项 --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">el-menu-item</span> <span class="hljs-attr">index</span>=<span class="hljs-string">"4"</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">i</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"el-icon-setting"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">i</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">template</span> #<span class="hljs-attr">title</span>&gt;</span>导航四<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">el-menu-item</span>&gt;</span><br>  <span class="hljs-tag">&lt;/<span class="hljs-name">el-menu</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span><br></code></pre></td></tr></table></figure>

<p>layout&#x2F;Sidebar&#x2F;index 导入该组件</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs js">&lt;template&gt;<br>  &lt;div <span class="hljs-class"><span class="hljs-keyword">class</span></span>=<span class="hljs-string">""</span>&gt;<br>    &lt;h1&gt;Admin&lt;<span class="hljs-regexp">/h1&gt;</span><br><span class="hljs-regexp">    &lt;el-scrollbar&gt;</span><br><span class="hljs-regexp">      &lt;sidebar-menu&gt;&lt;/</span>sidebar-menu&gt;<br>    &lt;<span class="hljs-regexp">/el-scrollbar&gt;</span><br><span class="hljs-regexp">  &lt;/</span>div&gt;<br>&lt;<span class="hljs-regexp">/template&gt;</span><br><span class="hljs-regexp"></span><br><span class="hljs-regexp">&lt;script setup&gt;</span><br><span class="hljs-regexp">import SidebarMenu from './</span>SidebarMenu<span class="hljs-string">'</span><br><span class="hljs-string">import &#123;&#125; from '</span>vue<span class="hljs-string">'</span><br><span class="hljs-string">&lt;/script&gt;</span><br></code></pre></td></tr></table></figure>

<p>生成一个临时的 menu 菜单，从这个临时的 menu 菜单可以看出，el-menu 分为三部分：</p>
<blockquote>
<p><code>el-menu</code>：整个 menu 菜单<br><code>el-sub-menu</code>:子集 menu 菜单<br><code>el-menu-item</code>:具体菜单项</p>
</blockquote>
<h4 id="13、动态-menu-菜单处理"><a href="#13、动态-menu-菜单处理" class="headerlink" title="13、动态 menu 菜单处理"></a>13、动态 menu 菜单处理</h4><blockquote>
<p>动态 menu 菜单主要和动态路由表配合来实现用户权限的（后续需要完成用户权限）。动态 menu 菜单指的是：根据路由表的配置，自动生成对应的 menu 菜单，当路由表发生变化时，menu 菜单自动发生变化。</p>
</blockquote>
<p>实现步骤：</p>
<blockquote>
<p>1、定义路由表对应的 menu 菜单规则（核心步骤）<br>2、根据规则制定路由表<br>3、根据规则，一路路由表生成 menu 菜单</p>
</blockquote>
<p>上面步骤 1 的菜单规则制定：</p>
<blockquote>
<p>1、如果<code>meta &amp;&amp; meta.title &amp;&amp; meta.icon</code> ：则显示在 <code>menu</code> 菜单中，其中 <code>title</code> 为显示的内容，<code>icon</code> 为显示的图标。如果存在 children：则展示子菜单 el-sub-menu；否则展示 el-menu-item。<br>2、不显示在 menu 中</p>
</blockquote>
<h4 id="14、创建页面组件"><a href="#14、创建页面组件" class="headerlink" title="14、创建页面组件"></a>14、<code>创建页面组件</code></h4><p>views 文件夹下创建页面：<br>（1）、创建文章:article-create<br>（2）、文章详情:article-detail<br>（3）、文章列表:article-ranking<br>（4）、401 和 404 页面:error-page&#x2F;401.vue 404.vue<br>（5）、导入:import<br>（6）、权限列表:permission-list<br>（7）、个人中心:profile<br>（8）、角色列表:role-list<br>（9）、用户信息:user-info<br>（10）、用户管理:user-manage</p>
<h4 id="15、用户权限处理"><a href="#15、用户权限处理" class="headerlink" title="15、用户权限处理"></a>15、用户权限处理</h4><p>需要先对路由表进行划分：私有路由表 privateRoutes(权限路由)、公有路由表 publicRoutes(非权限路由)</p>
<p><code>router/index.js</code></p>
<details>
<summary>显示详细代码</summary>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 私有路由表</span><br><span class="hljs-keyword">const</span> privateRoutes = [<br>  &#123;<br>    path: <span class="hljs-string">"/user"</span>,<br>    component: layout,<br>    redirect: <span class="hljs-string">"/user/manage"</span>,<br>    meta: &#123;<br>      title: <span class="hljs-string">"user"</span>,<br>      icon: <span class="hljs-string">"personnel"</span>,<br>    &#125;,<br>    children: [<br>      &#123;<br>        path: <span class="hljs-string">"/user/manage"</span>,<br>        component: <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">"@/views/user-manage/index"</span>),<br>        meta: &#123;<br>          title: <span class="hljs-string">"userManage"</span>,<br>          icon: <span class="hljs-string">"personnel-manage"</span>,<br>        &#125;,<br>      &#125;,<br>      &#123;<br>        path: <span class="hljs-string">"/user/role"</span>,<br>        component: <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">"@/views/role-list/index"</span>),<br>        meta: &#123;<br>          title: <span class="hljs-string">"roleList"</span>,<br>          icon: <span class="hljs-string">"role"</span>,<br>        &#125;,<br>      &#125;,<br>      &#123;<br>        path: <span class="hljs-string">"/user/permission"</span>,<br>        component: <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">"@/views/permission-list/index"</span>),<br>        meta: &#123;<br>          title: <span class="hljs-string">"permissionList"</span>,<br>          icon: <span class="hljs-string">"permission"</span>,<br>        &#125;,<br>      &#125;,<br>      &#123;<br>        path: <span class="hljs-string">"/user/info/:id"</span>,<br>        name: <span class="hljs-string">"userInfo"</span>,<br>        component: <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">"@/views/user-info/index"</span>),<br>        meta: &#123;<br>          title: <span class="hljs-string">"userInfo"</span>,<br>        &#125;,<br>      &#125;,<br>      &#123;<br>        path: <span class="hljs-string">"/user/import"</span>,<br>        name: <span class="hljs-string">"import"</span>,<br>        component: <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">"@/views/import/index"</span>),<br>        meta: &#123;<br>          title: <span class="hljs-string">"excelImport"</span>,<br>        &#125;,<br>      &#125;,<br>    ],<br>  &#125;,<br>  &#123;<br>    path: <span class="hljs-string">"/article"</span>,<br>    component: layout,<br>    redirect: <span class="hljs-string">"/article/ranking"</span>,<br>    meta: &#123;<br>      title: <span class="hljs-string">"article"</span>,<br>      icon: <span class="hljs-string">"article"</span>,<br>    &#125;,<br>    children: [<br>      &#123;<br>        path: <span class="hljs-string">"/article/ranking"</span>,<br>        component: <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">"@/views/article-ranking/index"</span>),<br>        meta: &#123;<br>          title: <span class="hljs-string">"articleRanking"</span>,<br>          icon: <span class="hljs-string">"article-ranking"</span>,<br>        &#125;,<br>      &#125;,<br>      &#123;<br>        path: <span class="hljs-string">"/article/:id"</span>,<br>        component: <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">"@/views/article-detail/index"</span>),<br>        meta: &#123;<br>          title: <span class="hljs-string">"articleDetail"</span>,<br>        &#125;,<br>      &#125;,<br>      &#123;<br>        path: <span class="hljs-string">"/article/create"</span>,<br>        component: <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">"@/views/article-create/index"</span>),<br>        meta: &#123;<br>          title: <span class="hljs-string">"articleCreate"</span>,<br>          icon: <span class="hljs-string">"article-create"</span>,<br>        &#125;,<br>      &#125;,<br>      &#123;<br>        path: <span class="hljs-string">"/article/editor/:id"</span>,<br>        component: <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">"@/views/article-create/index"</span>),<br>        meta: &#123;<br>          title: <span class="hljs-string">"articleEditor"</span>,<br>        &#125;,<br>      &#125;,<br>    ],<br>  &#125;,<br>];<br><span class="hljs-comment">// 公开路由表</span><br><span class="hljs-keyword">const</span> publicRoutes = [<br>  &#123;<br>    path: <span class="hljs-string">"/login"</span>,<br>    component: <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">"@/views/login/index"</span>),<br>  &#125;,<br>  &#123;<br>    path: <span class="hljs-string">"/"</span>,<br>    <span class="hljs-comment">// 注意：带有路径“/”的记录中的组件“默认”是一个不返回 Promise 的函数</span><br>    component: layout,<br>    redirect: <span class="hljs-string">"/profile"</span>,<br>    children: [<br>      &#123;<br>        path: <span class="hljs-string">"/profile"</span>,<br>        name: <span class="hljs-string">"profile"</span>,<br>        component: <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">"@/views/profile/index"</span>),<br>        meta: &#123;<br>          title: <span class="hljs-string">"profile"</span>,<br>          icon: <span class="hljs-string">"el-icon-user"</span>,<br>        &#125;,<br>      &#125;,<br>      &#123;<br>        path: <span class="hljs-string">"/404"</span>,<br>        name: <span class="hljs-string">"404"</span>,<br>        component: <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">"@/views/error-page/404"</span>),<br>      &#125;,<br>      &#123;<br>        path: <span class="hljs-string">"/401"</span>,<br>        name: <span class="hljs-string">"401"</span>,<br>        component: <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">"@/views/error-page/401"</span>),<br>      &#125;,<br>    ],<br>  &#125;,<br>];<br><br><span class="hljs-keyword">const</span> router = createRouter(&#123;<br>  history: createWebHashHistory(),<br>  routes: [...publicRoutes, ...privateRoutes],<br>&#125;);<br></code></pre></td></tr></table></figure>

</details>

<blockquote>
<p>注意：要在 <code>layout/AppMain.vue 中设置路由出口</code></p>
</blockquote>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"app-main"</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">router-view</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">router-view</span>&gt;</span><br>  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span><br></code></pre></td></tr></table></figure>

<h4 id="16、解析路由表，获取结构化数据"><a href="#16、解析路由表，获取结构化数据" class="headerlink" title="16、解析路由表，获取结构化数据"></a>16、解析路由表，获取结构化数据</h4><p>数据结构为</p>
<details>
<summary>显示详细代码</summary>

<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs json">[<br>  &#123;<br>    <span class="hljs-attr">"title"</span>: <span class="hljs-string">"个人中心"</span>,<br>    <span class="hljs-attr">"path"</span>: <span class="hljs-string">""</span><br>  &#125;,<br>  &#123;<br>    <span class="hljs-attr">"title"</span>: <span class="hljs-string">"用户"</span>,<br>    <span class="hljs-attr">"children"</span>: [<br>      &#123;<br>        <span class="hljs-attr">"title"</span>: <span class="hljs-string">"员工管理"</span>,<br>        <span class="hljs-attr">"path"</span>: <span class="hljs-string">""</span><br>      &#125;,<br>      &#123;<br>        <span class="hljs-attr">"title"</span>: <span class="hljs-string">"角色列表"</span>,<br>        <span class="hljs-attr">"path"</span>: <span class="hljs-string">""</span><br>      &#125;,<br>      &#123;<br>        <span class="hljs-attr">"title"</span>: <span class="hljs-string">"权限列表"</span>,<br>        <span class="hljs-attr">"path"</span>: <span class="hljs-string">""</span><br>      &#125;<br>    ]<br>  &#125;,<br>  &#123;<br>    <span class="hljs-attr">"title"</span>: <span class="hljs-string">"文章"</span>,<br>    <span class="hljs-attr">"children"</span>: [<br>      &#123;<br>        <span class="hljs-attr">"title"</span>: <span class="hljs-string">"文章排名"</span>,<br>        <span class="hljs-attr">"path"</span>: <span class="hljs-string">""</span><br>      &#125;,<br>      &#123;<br>        <span class="hljs-attr">"title"</span>: <span class="hljs-string">"创建文章"</span>,<br>        <span class="hljs-attr">"path"</span>: <span class="hljs-string">""</span><br>      &#125;<br>    ]<br>  &#125;<br>]<br></code></pre></td></tr></table></figure>

</details>

<p>获取路由表数据的 2 中方式：</p>
<blockquote>
<p>1、router.options.routes:初始路由列表<br>2、router.getRoutes()：获取所有路由记录的完整列表（选择此种方法）</p>
</blockquote>
<p>在 layout&#x2F;components&#x2F;Sidebar&#x2F;SidebarMenu 中</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs js">&lt;script setup&gt;<br>  <span class="hljs-keyword">import</span> &#123;useRouter&#125; <span class="hljs-keyword">from</span> <span class="hljs-string">'vue-router'</span> <span class="hljs-keyword">const</span> router = useRouter()<br>  <span class="hljs-built_in">console</span>.log(router.getRoutes()) <span class="hljs-comment">// 这里返回的是一个完整的路由表</span><br>&lt;<span class="hljs-regexp">/script&gt;</span><br></code></pre></td></tr></table></figure>

<p>打印的结果是一个完整的路由表，里面存在一些问题：</p>
<blockquote>
<p>存在重复的路由数据<br>不满足该条件 meta &amp;&amp; meta.title &amp;&amp; meta.icon 的数据不应该存在</p>
</blockquote>
<h4 id="17、处理数据结构问题"><a href="#17、处理数据结构问题" class="headerlink" title="17、处理数据结构问题"></a>17、处理数据结构问题</h4><p>创建<code>utils/route.js</code>，里面 2 个函数方法：filterRouters()&#x2F;generateMenus()很重要</p>
<details>
<summary>显示完整代码</summary>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">import</span> path <span class="hljs-keyword">from</span> <span class="hljs-string">"path"</span>;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * 返回所有子路由</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">const</span> getChildrenRoutes = <span class="hljs-function">(<span class="hljs-params">routes</span>) =&gt;</span> &#123;<br>  <span class="hljs-keyword">const</span> result = [];<br>  routes.forEach(<span class="hljs-function">(<span class="hljs-params">route</span>) =&gt;</span> &#123;<br>    <span class="hljs-keyword">if</span> (route.children &amp;&amp; route.children.length &gt; <span class="hljs-number">0</span>) &#123;<br>      result.push(...route.children);<br>    &#125;<br>  &#125;);<br>  <span class="hljs-keyword">return</span> result;<br>&#125;;<br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * 处理脱离层级的路由：某个一级路由为其他子路由，则剔除该一级路由，保留路由层级</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param <span class="hljs-type">&#123;*&#125;</span> </span>routes router.getRoutes()</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> filterRouters = <span class="hljs-function">(<span class="hljs-params">routes</span>) =&gt;</span> &#123;<br>  <span class="hljs-keyword">const</span> childrenRoutes = getChildrenRoutes(routes);<br>  <span class="hljs-keyword">return</span> routes.filter(<span class="hljs-function">(<span class="hljs-params">route</span>) =&gt;</span> &#123;<br>    <span class="hljs-keyword">return</span> !childrenRoutes.find(<span class="hljs-function">(<span class="hljs-params">childrenRoute</span>) =&gt;</span> &#123;<br>      <span class="hljs-keyword">return</span> childrenRoute.path === route.path;<br>    &#125;);<br>  &#125;);<br>&#125;;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * 判断数据是否为空值</span><br><span class="hljs-comment"> */</span><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">isNull</span>(<span class="hljs-params">data</span>) </span>&#123;<br>  <span class="hljs-keyword">if</span> (!data) <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>  <span class="hljs-keyword">if</span> (<span class="hljs-built_in">JSON</span>.stringify(data) === <span class="hljs-string">"&#123;&#125;"</span>) <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>  <span class="hljs-keyword">if</span> (<span class="hljs-built_in">JSON</span>.stringify(data) === <span class="hljs-string">"[]"</span>) <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>  <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>&#125;<br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * 根据 routes 数据，返回对应 menu 规则数组</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">export</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">generateMenus</span>(<span class="hljs-params">routes, basePath = <span class="hljs-string">""</span></span>) </span>&#123;<br>  <span class="hljs-keyword">const</span> result = [];<br>  <span class="hljs-comment">// 遍历路由表</span><br>  routes.forEach(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> &#123;<br>    <span class="hljs-comment">// 不存在 children &amp;&amp; 不存在 meta 直接 return</span><br>    <span class="hljs-keyword">if</span> (isNull(item.meta) &amp;&amp; isNull(item.children)) <span class="hljs-keyword">return</span>;<br>    <span class="hljs-comment">// 存在 children 不存在 meta，进入迭代</span><br>    <span class="hljs-keyword">if</span> (isNull(item.meta) &amp;&amp; !isNull(item.children)) &#123;<br>      result.push(...generateMenus(item.children));<br>      <span class="hljs-keyword">return</span>;<br>    &#125;<br>    <span class="hljs-comment">// 合并 path 作为跳转路径</span><br>    <span class="hljs-keyword">const</span> routePath = path.resolve(basePath, item.path);<br>    <span class="hljs-comment">// 路由分离之后，存在同名父路由的情况，需要单独处理</span><br>    <span class="hljs-keyword">let</span> route = result.find(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> item.path === routePath);<br>    <span class="hljs-keyword">if</span> (!route) &#123;<br>      route = &#123;<br>        ...item,<br>        path: routePath,<br>        children: [],<br>      &#125;;<br><br>      <span class="hljs-comment">// icon 与 title 必须全部存在</span><br>      <span class="hljs-keyword">if</span> (route.meta.icon &amp;&amp; route.meta.title) &#123;<br>        <span class="hljs-comment">// meta 存在生成 route 对象，放入 arr</span><br>        result.push(route);<br>      &#125;<br>    &#125;<br><br>    <span class="hljs-comment">// 存在 children 进入迭代到children</span><br>    <span class="hljs-keyword">if</span> (item.children) &#123;<br>      route.children.push(...generateMenus(item.children, route.path));<br>    &#125;<br>  &#125;);<br>  <span class="hljs-keyword">return</span> result;<br>&#125;<br></code></pre></td></tr></table></figure>

</details>

<h4 id="18、SidebarMenu-调用-filterRouters、generateMenus-方法"><a href="#18、SidebarMenu-调用-filterRouters、generateMenus-方法" class="headerlink" title="18、SidebarMenu 调用 filterRouters、generateMenus 方法"></a>18、SidebarMenu 调用 filterRouters、generateMenus 方法</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs js">&lt;script setup&gt;<br><span class="hljs-keyword">import</span> &#123; computed &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span><br><span class="hljs-keyword">import</span> &#123; useRouter &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">'vue-router'</span><br><span class="hljs-keyword">import</span> &#123; filterRouters, generateMenus &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">'@/utils/route'</span><br><br><span class="hljs-keyword">const</span> router = useRouter()<br><span class="hljs-keyword">const</span> routes = computed(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> &#123;<br>  <span class="hljs-keyword">const</span> filterRoutes = filterRouters(router.getRoutes())<br>  <span class="hljs-keyword">return</span> generateMenus(filterRoutes)<br>&#125;)<br><span class="hljs-built_in">console</span>.log(<span class="hljs-built_in">JSON</span>.stringify(routes.value))<br>&lt;<span class="hljs-regexp">/script&gt;</span><br></code></pre></td></tr></table></figure>

<h4 id="19、生成动态-menu-菜单"><a href="#19、生成动态-menu-菜单" class="headerlink" title="19、生成动态 menu 菜单"></a>19、生成动态 menu 菜单</h4><p>整个 menu 菜单，分为 3 个组件来进行处理</p>
<blockquote>
<p>1、SidebarMenu:处理数据，作为最顶层 menu 载体</p>
</blockquote>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span><br>  <span class="hljs-comment">&lt;!-- 一级 menu 菜单 --&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">el-menu</span> <span class="hljs-attr">...</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">sidebar-item</span></span><br><span class="hljs-tag">      <span class="hljs-attr">v-for</span>=<span class="hljs-string">"item in routes"</span></span><br><span class="hljs-tag">      <span class="hljs-attr">:key</span>=<span class="hljs-string">"item.path"</span></span><br><span class="hljs-tag">      <span class="hljs-attr">:route</span>=<span class="hljs-string">"item"</span></span><br><span class="hljs-tag">    &gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">sidebar-item</span>&gt;</span><br>  <span class="hljs-tag">&lt;/<span class="hljs-name">el-menu</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span><br></code></pre></td></tr></table></figure>

<blockquote>
<p>2、SidebarItem：根据数据处理当前项为 el-sub-menu || el-menu-item</p>
</blockquote>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span><br>  <span class="hljs-comment">&lt;!-- 支持渲染多级 menu 菜单 --&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">el-submenu</span> <span class="hljs-attr">v-if</span>=<span class="hljs-string">"route.children.length &gt; 0"</span> <span class="hljs-attr">:index</span>=<span class="hljs-string">"route.path"</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">template</span> #<span class="hljs-attr">title</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">menu-item</span> <span class="hljs-attr">:title</span>=<span class="hljs-string">"route.meta.title"</span> <span class="hljs-attr">:icon</span>=<span class="hljs-string">"route.meta.icon"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">menu-item</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span><br>    <span class="hljs-comment">&lt;!-- 循环渲染 --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">sidebar-item</span></span><br><span class="hljs-tag">      <span class="hljs-attr">v-for</span>=<span class="hljs-string">"item in route.children"</span></span><br><span class="hljs-tag">      <span class="hljs-attr">:key</span>=<span class="hljs-string">"item.path"</span></span><br><span class="hljs-tag">      <span class="hljs-attr">:route</span>=<span class="hljs-string">"item"</span></span><br><span class="hljs-tag">    &gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">sidebar-item</span>&gt;</span><br>  <span class="hljs-tag">&lt;/<span class="hljs-name">el-submenu</span>&gt;</span><br>  <span class="hljs-comment">&lt;!-- 渲染 item 项 --&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">el-menu-item</span> <span class="hljs-attr">v-else</span> <span class="hljs-attr">:index</span>=<span class="hljs-string">"route.path"</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">menu-item</span> <span class="hljs-attr">:title</span>=<span class="hljs-string">"route.meta.title"</span> <span class="hljs-attr">:icon</span>=<span class="hljs-string">"route.meta.icon"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">menu-item</span>&gt;</span><br>  <span class="hljs-tag">&lt;/<span class="hljs-name">el-menu-item</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span>&gt;</span><br><span class="javascript">  <span class="hljs-keyword">import</span> MenuItem <span class="hljs-keyword">from</span> <span class="hljs-string">"./MenuItem"</span>;</span><br><span class="javascript">  <span class="hljs-keyword">import</span> &#123; defineProps &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">"vue"</span>;</span><br><span class="actionscript">  <span class="hljs-comment">// 定义 props</span></span><br>  defineProps(&#123;<br>    route: &#123;<br><span class="javascript">      type: <span class="hljs-built_in">Object</span>,</span><br><span class="actionscript">      required: <span class="hljs-literal">true</span>,</span><br>    &#125;,<br>  &#125;);<br><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br></code></pre></td></tr></table></figure>

<blockquote>
<p>3、MenuItem:处理 el-menu-item 样式</p>
</blockquote>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">i</span> <span class="hljs-attr">v-if</span>=<span class="hljs-string">"icon.includes('el-icon')"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"sub-el-icon"</span> <span class="hljs-attr">:class</span>=<span class="hljs-string">"icon"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">i</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">svg-icon</span> <span class="hljs-attr">v-else</span> <span class="hljs-attr">:icon</span>=<span class="hljs-string">"icon"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">svg-icon</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>&#123;&#123; title &#125;&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span>&gt;</span><br><span class="javascript">  <span class="hljs-keyword">import</span> &#123; defineProps &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">"vue"</span>;</span><br>  defineProps(&#123;<br>    title: &#123;<br><span class="javascript">      type: <span class="hljs-built_in">String</span>,</span><br><span class="actionscript">      required: <span class="hljs-literal">true</span>,</span><br>    &#125;,<br>    icon: &#123;<br><span class="javascript">      type: <span class="hljs-built_in">String</span>,</span><br><span class="actionscript">      required: <span class="hljs-literal">true</span>,</span><br>    &#125;,<br>  &#125;);<br><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">style</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"scss"</span> <span class="hljs-attr">scoped</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span><br></code></pre></td></tr></table></figure>

<p>menu 菜单完成，还需解决样式问题、菜单路由跳转问题、默认激活项</p>
<p><code>样式修改</code>：store&#x2F;getters 创建快捷访问（后续加入主题更换功能，样式不能写死）</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">import</span> variables <span class="hljs-keyword">from</span> <span class="hljs-string">'@/styles/variables.scss'</span><br><span class="hljs-keyword">const</span> getters = &#123;<br>  ...<br>  cssVar: <span class="hljs-function"><span class="hljs-params">state</span> =&gt;</span> variables<br>&#125;<br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> getters<br></code></pre></td></tr></table></figure>

<p><code>SidebarMenu</code>写入样式（el-menu 里的 router 是指定路由跳转， activeMenu 为默认激活项）</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs html">// template<br><span class="hljs-tag">&lt;<span class="hljs-name">el-menu</span></span><br><span class="hljs-tag">  <span class="hljs-attr">:background-color</span>=<span class="hljs-string">"$store.getters.cssVar.menuBg"</span></span><br><span class="hljs-tag">  <span class="hljs-attr">:text-color</span>=<span class="hljs-string">"$store.getters.cssVar.menuText"</span></span><br><span class="hljs-tag">  <span class="hljs-attr">:active-text-color</span>=<span class="hljs-string">"$store.getters.cssVar.menuActiveText"</span></span><br><span class="hljs-tag">  <span class="hljs-attr">:default-active</span>=<span class="hljs-string">"activeMenu"</span></span><br><span class="hljs-tag">  <span class="hljs-attr">:unique-opened</span>=<span class="hljs-string">"true"</span></span><br><span class="hljs-tag">  <span class="hljs-attr">router</span></span><br><span class="hljs-tag">&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">el-menu</span>&gt;</span><br><br>// js<br><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span>&gt;</span><br>  ...<br><br><span class="actionscript">  <span class="hljs-comment">// 计算高亮 menu 的方法</span></span><br><span class="actionscript">  <span class="hljs-keyword">const</span> route = useRoute()</span><br><span class="javascript">  <span class="hljs-keyword">const</span> activeMenu = computed(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> &#123;</span><br><span class="actionscript">    <span class="hljs-keyword">const</span> &#123; path &#125; = route</span><br><span class="actionscript">    <span class="hljs-keyword">return</span> path</span><br>  &#125;)<br><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br></code></pre></td></tr></table></figure>

<h4 id="20、菜单的伸缩功能"><a href="#20、菜单的伸缩功能" class="headerlink" title="20、菜单的伸缩功能"></a>20、菜单的伸缩功能</h4><p>创建<code>store/modules/app.js</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;<br>  namespaced: <span class="hljs-literal">true</span>,<br>  state: <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> (&#123;<br>    sidebarOpened: <span class="hljs-literal">true</span>,<br>  &#125;),<br>  mutations: &#123;<br>    triggerSidebarOpened(state) &#123;<br>      state.sidebarOpened = !state.sidebarOpened;<br>    &#125;,<br>  &#125;,<br>  actions: &#123;&#125;,<br>&#125;;<br></code></pre></td></tr></table></figure>

<p>在<code>store/index.js</code>中引入上面的 app.js</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">import</span> app <span class="hljs-keyword">from</span> <span class="hljs-string">"./modules/app"</span>;<br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> createStore(&#123;<br>  getters,<br>  modules: &#123;<br>    user,<br>    app,<br>  &#125;,<br>&#125;);<br></code></pre></td></tr></table></figure>

<p>在 <code>store/getters</code> 中创建快捷访问</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js">sidebarOpened: <span class="hljs-function">(<span class="hljs-params">state</span>) =&gt;</span> state.app.sidebarOpened;<br></code></pre></td></tr></table></figure>

<h4 id="21、创建收缩-icon-组件-hamburger"><a href="#21、创建收缩-icon-组件-hamburger" class="headerlink" title="21、创建收缩 icon 组件 hamburger"></a>21、创建收缩 icon 组件 hamburger</h4><p>创建<code>src/components/Hamburger/index.vue</code></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"hamburger-container"</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">"toggleClick"</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">svg-icon</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"hamburger"</span> <span class="hljs-attr">:icon</span>=<span class="hljs-string">"icon"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">svg-icon</span>&gt;</span><br>  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span>&gt;</span><br><span class="javascript">  <span class="hljs-keyword">import</span> &#123; computed &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">"vue"</span>;</span><br><span class="javascript">  <span class="hljs-keyword">import</span> &#123; useStore &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">"vuex"</span>;</span><br><br><span class="actionscript">  <span class="hljs-keyword">const</span> store = useStore();</span><br><span class="javascript">  <span class="hljs-keyword">const</span> toggleClick = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> &#123;</span><br><span class="actionscript">    store.commit(<span class="hljs-string">"app/triggerSidebarOpened"</span>);</span><br>  &#125;;<br><br><span class="javascript">  <span class="hljs-keyword">const</span> icon = computed(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span></span><br><span class="actionscript">    store.getters.sidebarOpened ? <span class="hljs-string">"hamburger-opened"</span> : <span class="hljs-string">"hamburger-closed"</span></span><br>  );<br><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">style</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"scss"</span> <span class="hljs-attr">scoped</span>&gt;</span><br><span class="css">  <span class="hljs-selector-class">.hamburger-container</span> &#123;</span><br>    padding: 0 16px;<br><span class="css">    <span class="hljs-selector-class">.hamburger</span> &#123;</span><br>      display: inline-block;<br>      vertical-align: middle;<br>      width: 20px;<br>      height: 20px;<br>    &#125;<br>  &#125;<br><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span><br></code></pre></td></tr></table></figure>

<p>在<code>layout/components/Navbar.vue</code>中使用 Hamburger 组件</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"navbar"</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">hamburger</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"hamburger-container"</span> /&gt;</span><br>    ...<br>  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span>&gt;</span><br><span class="javascript">  <span class="hljs-keyword">import</span> Hamburger <span class="hljs-keyword">from</span> <span class="hljs-string">'@/components/Hamburger'</span></span><br>  ...<br><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">style</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"scss"</span> <span class="hljs-attr">scoped</span>&gt;</span><br><span class="css">  <span class="hljs-selector-class">.navbar</span> &#123;</span><br>    ...<br><br><span class="css">    <span class="hljs-selector-class">.hamburger-container</span> &#123;</span><br>      line-height: 46px;<br>      height: 100%;<br>      float: left;<br>      cursor: pointer;<br>      // hover 动画<br><span class="css">      <span class="hljs-selector-tag">transition</span>: <span class="hljs-selector-tag">background</span> 0<span class="hljs-selector-class">.5s</span>;</span><br><br><span class="css">      &amp;<span class="hljs-selector-pseudo">:hover</span> &#123;</span><br><span class="css">        <span class="hljs-selector-tag">background</span>: <span class="hljs-selector-tag">rgba</span>(0, 0, 0, 0<span class="hljs-selector-class">.1</span>);</span><br>      &#125;<br>    &#125;<br><br>   ...<br>  &#125;<br><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span><br></code></pre></td></tr></table></figure>

<p>在<code>layout/components/Sidebar/SidebarMenu.vue</code>中添加控制 el-menu 的<code>collapse</code>属性</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">el-menu</span></span><br><span class="hljs-tag">    <span class="hljs-attr">:collapse</span>=<span class="hljs-string">"!$store.getters.sidebarOpened"</span></span><br><span class="hljs-tag">    <span class="hljs-attr">...</span></span><br></code></pre></td></tr></table></figure>

<p>在<code>layout/index.vue</code>中指定侧边栏的宽度和缩放动画</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">div</span></span><br><span class="hljs-tag">  <span class="hljs-attr">class</span>=<span class="hljs-string">"app-wrapper"</span></span><br><span class="hljs-tag">  <span class="hljs-attr">:class</span>=<span class="hljs-string">"[$store.getters.sidebarOpened ? 'openSidebar' : 'hideSidebar']"</span></span><br><span class="hljs-tag">&gt;</span><br>  ...<br><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">style</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"scss"</span> <span class="hljs-attr">scoped</span>&gt;</span><br><span class="css">  ... <span class="hljs-selector-class">.fixed-header</span> &#123;</span><br>    position: fixed;<br>    top: 0;<br>    right: 0;<br>    z-index: 9;<br>    width: calc(100% - #&#123;$sideBarWidth&#125;);<br><span class="css">    <span class="hljs-selector-tag">transition</span>: <span class="hljs-selector-tag">width</span> 0<span class="hljs-selector-class">.28s</span>;</span><br>  &#125;<br><br><span class="css">  <span class="hljs-selector-class">.hideSidebar</span> <span class="hljs-selector-class">.fixed-header</span> &#123;</span><br>    width: calc(100% - #&#123;$hideSideBarWidth&#125;);<br>  &#125;<br><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><br>  // 在 `styles/variables.scss` 中指定 `hideSideBarWidth`<br>  $hideSideBarWidth: 54px;<br><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span><br></code></pre></td></tr></table></figure>

<h4 id="22、SidebarHeader-处理"><a href="#22、SidebarHeader-处理" class="headerlink" title="22、SidebarHeader 处理"></a>22、SidebarHeader 处理</h4><details>
<summary>显示详细代码</summary>

<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">""</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"logo-container"</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">el-avatar</span> <span class="hljs-attr">size</span>=<span class="hljs-string">"44"</span> <span class="hljs-attr">shape</span>=<span class="hljs-string">"square"</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"http://xxxxx.com"</span> /&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">h1</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"logo-title"</span> <span class="hljs-attr">v-if</span>=<span class="hljs-string">"$store.getters.sidebarOpened"</span>&gt;</span>Admin<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>    ...<br>  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">style</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"scss"</span> <span class="hljs-attr">scoped</span>&gt;</span><br><span class="css">  <span class="hljs-selector-class">.logo-container</span> &#123;</span><br>    height: 44px;<br>    padding: 10px 0 22px 0;<br>    display: flex;<br>    align-items: center;<br>    justify-content: center;<br><span class="css">    <span class="hljs-selector-class">.logo-title</span> &#123;</span><br>      margin-left: 10px;<br><span class="css">      <span class="hljs-selector-tag">color</span>: <span class="hljs-selector-id">#fff</span>;</span><br>      font-weight: 600;<br>      line-height: 50px;<br>      font-size: 16px;<br>      white-space: nowrap;<br>    &#125;<br>  &#125;<br><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span><br></code></pre></td></tr></table></figure>

</details>

<blockquote>
<p>处理 el-avatar 的图片背景问题</p>
</blockquote>
<p>创建 <code>styles/element.scss</code>,然后将其导入到<code>style/index.scss</code></p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-selector-class">.el-avatar</span> &#123;<br>  <span class="hljs-attribute">--el-avatar-background-color</span>: none;<br>&#125;<br></code></pre></td></tr></table></figure>

<blockquote>
<p>处理动画问题</p>
</blockquote>
<p>在 <code>styles/variables.scss</code> 中，加入以下变量</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs css">$sideBarDuration: 0.28s;<br></code></pre></td></tr></table></figure>

<p><code>styles/sidebar.scss</code> 修改时长</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-selector-class">.main-container</span> &#123;<br>  <span class="hljs-attribute">transition</span>: margin-left #&#123;$sideBarDuration&#125;;<br> ...<br>&#125;<br><br><span class="hljs-selector-class">.sidebar-container</span> &#123;<br>  <span class="hljs-attribute">transition</span>: width #&#123;$sideBarDuration&#125;;<br>	...<br>&#125;<br></code></pre></td></tr></table></figure>

<p><code>layout/index</code> 修改样式</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-selector-class">.fixed-header</span> &#123;<br>  ...<br>  transition: width #&#123;$sideBarDuration&#125;;<br>&#125;<br></code></pre></td></tr></table></figure>

<h4 id="23、组件状态驱动的动态-CSS-值"><a href="#23、组件状态驱动的动态-CSS-值" class="headerlink" title="23、组件状态驱动的动态 CSS 值"></a>23、组件状态驱动的动态 CSS 值</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs html">&lt;template&gt; ... &lt;el-avatar :size="logoHeight" ... &lt;/template&gt;<br><br><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span>&gt;</span><br>  ...<br><span class="actionscript">  <span class="hljs-keyword">const</span> logoHeight = <span class="hljs-number">44</span></span><br><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">style</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"scss"</span> <span class="hljs-attr">scoped</span>&gt;</span><br><span class="css">  <span class="hljs-selector-class">.logo-container</span> &#123;</span><br>    height: v-bind(logoHeight) + 'px';<br>  ...<br>  &#125;<br><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span><br></code></pre></td></tr></table></figure>
</article><section class="jump-container is-flex is-justify-content-space-between my-6"><!-- em is empty placeholder--><a class="button is-default" href="/2022/11/21/95-v-deep/" title="95、vue3.0使用sass预处理器使用::v-deep深度选择器抛出警告"><i class="iconfont icon-prev mr-2 has-text-grey"></i><span class="has-text-weight-semibold">上一页: 95、vue3.0使用sass预处理器使用::v-deep深度选择器抛出警告</span></a><a class="button is-default" href="/2022/11/10/93-vue3-ele-plus-admin/" title="93、使用vue3+element-plus写后台管理系统：（三）"><span class="has-text-weight-semibold">下一页: 93、使用vue3+element-plus写后台管理系统：（三）</span><i class="iconfont icon-next ml-2 has-text-grey"></i></a></section></div></div></main></main><footer class="is-flex is-flex-direction-column is-align-items-center is-flex-shrink-0 is-family-serif"><section class="sns-container"><!-- Github--><a title="github" target="_blank" rel="noopener nofollow" href="//github.com/Jude"><i class="iconfont icon-github"></i></a><!-- Ins--><!-- RSS--><!-- 知乎--><a title="zhihu" target="_blank" rel="noopener nofollow" href="//zhihu.com/https://www.zhihu.com/hot"><i class="iconfont icon-zhihu"></i></a><!-- 领英--><!-- 脸书--></section><p><span>Copyright ©</span><span> Jude 2024</span></p><div class="is-flex is-justify-content-center is-flex-wrap-wrap"><p>Powered by Hexo &verbar;&nbsp;</p><p class="is-flex is-justify-content-center"><a title="Hexo theme author" href="//github.com/haojen" target="_blank" rel="noopener">Theme by Haojen&nbsp;</a></p><div style="margin-top: 2px"><a class="github-button" title="github-button" href="https://github.com/haojen/hexo-theme-Claudia" target="_blank" rel="noopener" data-color-scheme="no-preference: light; light: light; dark: dark;" data-show-count="true"></a></div></div><div><span>记住昨日的美好，过好今日的生活，憧憬明天的到来</span></div></footer><script async defer src="https://buttons.github.io/buttons.js"></script><script src="/js/post.js"></script></body></html>