<!DOCTYPE html><html class="appearance-auto" lang="zh-CN"><head><meta charset="UTF-8"><title>101、富文本与markdown对文本的处理</title><meta name="description" content="呦呦鹿鸣，食野之苹"><meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no, initial-scale=1"><!-- Google Analytics --><!-- End Google Analytics -->
<!-- Baidu Analytics --><!-- End Baidu Analytics --><link rel="icon" href="/images/favicon.png"><link rel="stylesheet" href="/style/common/bulma.css"><link rel="stylesheet" href="/style/base.css"><link rel="stylesheet" href="/style/common/helper.css"><script src="/js/common.js"></script><link rel="stylesheet" href="/style/post.css"><link rel="stylesheet" href="/style/themes/highlight-theme-light.css"><script src="/js/highlight.pack.js"></script><meta name="description" content="

编辑文本的 2 种方式：1、富文本; 2、markdown。这 2 种编辑形式在前端中有很多第 3 方库。
一、创建文本基本结构1-1 创建文本基本结构，主要分为三部分：1、article-create 页面：基本结构
2、Editor 组件：富文本编辑器
3、Markdown 组件： markdown 编辑器
src 目录下的项目结构：
12345views &amp;#x2F; article - create &amp;#x2F; components &amp;#x2F; Editor.vue;views &amp;#x2F; article - create &amp;#x2F; components &amp;#x2F; Markdown.vue;views &amp;#x2F; article - create &amp;#x2F; index.vue.."><meta name="generator" content="Hexo 4.2.1"></head><body class="is-flex is-flex-direction-column"><header class="header-widget is-flex-shrink-0 is-hidden-mobile"><div class="container is-fullhd is-flex is-justify-content-space-between is-align-items-center is-full-height"><section class="is-hidden-mobile is-flex-shrink-0"><h2><a href="/">Jude's blog</a></h2></section><h3 class="is-hidden-mobile is-family-serif is-full-height is-flex is-align-items-center is-flex-shrink-0"><div class="is-full-height" id="postTopic"><p class="is-full-height is-flex-shrink-0 is-flex is-align-items-center is-justify-content-center">101、富文本与markdown对文本的处理</p><p class="is-full-height is-flex-shrink-0 is-flex is-align-items-center is-justify-content-center">点击返回顶部</p></div></h3><aside class="is-flex-shrink-0"><h3 class="is-inline-block"><a href="/">首页</a></h3><h3 class="is-inline-block"><a href="/about">关于</a></h3><h3 class="is-inline-block"><a href="/archives">归档</a></h3></aside></div></header><header class="is-flex header-widget is-flex-shrink-0 is-align-items-center is-justify-content-center is-hidden-tablet"><h3 class="is-inline-block"><a href="/">首页</a></h3><h3 class="is-inline-block"><a href="/about">关于</a></h3><h3 class="is-inline-block"><a href="/archives">归档</a></h3></header><main><main class="container is-max-widescreen content section post-page pt-4 px-4"><div class="columns is-flex-desktop is-justify-content-center is-flex-direction-row-reverse"><div class="column is-3 is-hidden-mobile"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#一、创建文本基本结构"><span class="toc-text">一、创建文本基本结构</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-1-创建文本基本结构，主要分为三部分："><span class="toc-text">1-1 创建文本基本结构，主要分为三部分：</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-2-创建文本父组件"><span class="toc-text">1-2 创建文本父组件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-3-markdown-编辑器：tui-editor"><span class="toc-text">1-3 markdown 编辑器：tui.editor</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-4-富文本编辑器：wangEditor"><span class="toc-text">1-4 富文本编辑器：wangEditor</span></a></li></ol></div><div class="column is-9"><header class="my-4"><a href="/tags/vue3"><i class="tag post-item-tag">vue3</i></a></header><h1 class="mt-0 mb-1 is-family-serif" id="postTitle">101、富文本与markdown对文本的处理</h1><time class="has-text-grey" datetime="2022-12-01T12:00:00.000Z">2022-12-01</time><article class="mt-2 post-content"><a id="more"></a>

<p>编辑文本的 2 种方式：1、富文本; 2、markdown。这 2 种编辑形式在前端中有很多第 3 方库。</p>
<h2 id="一、创建文本基本结构"><a href="#一、创建文本基本结构" class="headerlink" title="一、创建文本基本结构"></a>一、创建文本基本结构</h2><h2 id="1-1-创建文本基本结构，主要分为三部分："><a href="#1-1-创建文本基本结构，主要分为三部分：" class="headerlink" title="1-1 创建文本基本结构，主要分为三部分："></a>1-1 创建文本基本结构，主要分为三部分：</h2><p>1、article-create 页面：基本结构</p>
<p>2、Editor 组件：富文本编辑器</p>
<p>3、Markdown 组件： markdown 编辑器</p>
<p>src 目录下的项目结构：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs plain">views &#x2F; article - create &#x2F; components &#x2F; Editor.vue;<br><br>views &#x2F; article - create &#x2F; components &#x2F; Markdown.vue;<br><br>views &#x2F; article - create &#x2F; index.vue;<br></code></pre></td></tr></table></figure>

<h2 id="1-2-创建文本父组件"><a href="#1-2-创建文本父组件" class="headerlink" title="1-2 创建文本父组件"></a>1-2 创建文本父组件</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;template&gt;<br>  &lt;div class&#x3D;&quot;article-create&quot;&gt;<br>    &lt;el-card&gt;<br>      &lt;el-input<br>        class&#x3D;&quot;title-input&quot;<br>        placeholder&#x3D;&quot;请输入标题&quot;<br>        v-model&#x3D;&quot;title&quot;<br>        maxlength&#x3D;&quot;20&quot;<br>        clearable<br>      &gt;<br>      &lt;&#x2F;el-input&gt;<br>      &lt;el-tabs v-model&#x3D;&quot;activeName&quot;&gt;<br>        &lt;el-tab-pane label&#x3D;&quot;markdown&quot; name&#x3D;&quot;markdown&quot;&gt;<br>          &lt;markdown&gt;&lt;&#x2F;markdown&gt;<br>        &lt;&#x2F;el-tab-pane&gt;<br>        &lt;el-tab-pane label&#x3D;&quot;富文本&quot; name&#x3D;&quot;editor&quot;&gt;<br>          &lt;editor&gt;&lt;&#x2F;editor&gt;<br>        &lt;&#x2F;el-tab-pane&gt;<br>      &lt;&#x2F;el-tabs&gt;<br>    &lt;&#x2F;el-card&gt;<br>  &lt;&#x2F;div&gt;<br>&lt;&#x2F;template&gt;<br><br>&lt;script setup&gt;<br>import Editor from &quot;.&#x2F;components&#x2F;Editor.vue&quot;;<br>import Markdown from &quot;.&#x2F;components&#x2F;Markdown.vue&quot;;<br>import &#123; ref &#125; from &quot;vue&quot;;<br><br>const activeName &#x3D; ref(&quot;markdown&quot;);<br>const title &#x3D; ref(&quot;&quot;);<br>&lt;&#x2F;script&gt;<br><br>&lt;style lang&#x3D;&quot;scss&quot; scoped&gt;<br>.title-input &#123;<br>  margin-bottom: 20px;<br>&#125;<br>&lt;&#x2F;style&gt;<br></code></pre></td></tr></table></figure>

<h2 id="1-3-markdown-编辑器：tui-editor"><a href="#1-3-markdown-编辑器：tui-editor" class="headerlink" title="1-3 markdown 编辑器：tui.editor"></a>1-3 markdown 编辑器：tui.editor</h2><blockquote>
<p>安装 plugin：</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">npm i @toast-ui/editor@3.0.2<br></code></pre></td></tr></table></figure>

<blockquote>
<p>渲染 markdown 基本结构</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;template&gt;<br>  &lt;div class&#x3D;&quot;markdown-container&quot;&gt;<br>    &lt;!-- 渲染区 --&gt;<br>    &lt;div id&#x3D;&quot;markdown-box&quot;&gt;&lt;&#x2F;div&gt;<br>    &lt;div class&#x3D;&quot;bottom&quot;&gt;<br>      &lt;el-button type&#x3D;&quot;primary&quot; @click&#x3D;&quot;onSubmitClick&quot;&gt;提交&lt;&#x2F;el-button&gt;<br>    &lt;&#x2F;div&gt;<br>  &lt;&#x2F;div&gt;<br>&lt;&#x2F;template&gt;<br><br>&lt;script setup&gt;<br>import &#123;&#125; from &quot;vue&quot;;<br>&lt;&#x2F;script&gt;<br><br>&lt;style lang&#x3D;&quot;scss&quot; scoped&gt;<br>.markdown-container &#123;<br>  .bottom &#123;<br>    margin-top: 20px;<br>    text-align: right;<br>  &#125;<br>&#125;<br>&lt;&#x2F;style&gt;<br></code></pre></td></tr></table></figure>

<blockquote>
<p>初始化 editor</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs js">&lt;script setup&gt;<br><span class="hljs-keyword">import</span> MkEditor <span class="hljs-keyword">from</span> <span class="hljs-string">'@toast-ui/editor'</span><br><span class="hljs-keyword">import</span> <span class="hljs-string">'@toast-ui/editor/dist/toastui-editor.css'</span><br><span class="hljs-comment">// 国际化部分</span><br><span class="hljs-comment">// import '@toast-ui/editor/dist/i18n/zh-cn'</span><br><span class="hljs-keyword">import</span> &#123; onMounted &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span><br><span class="hljs-keyword">import</span> &#123; useStore &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">'vuex'</span><br><br><span class="hljs-comment">// Editor实例</span><br><span class="hljs-keyword">let</span> mkEditor<br><span class="hljs-comment">// 处理离开页面切换语言导致 dom 无法被获取</span><br><span class="hljs-keyword">let</span> el<br>onMounted(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> &#123;<br>  el = <span class="hljs-built_in">document</span>.querySelector(<span class="hljs-string">'#markdown-box'</span>)<br>  initEditor()<br>&#125;)<br><br><span class="hljs-keyword">const</span> store = useStore()<br><span class="hljs-keyword">const</span> initEditor = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> &#123;<br>  mkEditor = <span class="hljs-keyword">new</span> MkEditor(&#123;<br>    el,<br>    height: <span class="hljs-string">'500px'</span>,<br>    previewStyle: <span class="hljs-string">'vertical'</span><br>  &#125;)<br><br>  mkEditor.getMarkdown()<br>&#125;<br>&lt;<span class="hljs-regexp">/script&gt;</span><br></code></pre></td></tr></table></figure>

<blockquote>
<p>新建文本及新建文本的提交</p>
</blockquote>
<p>接口定义：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// src/api/article.js</span><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * 创建文章</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> createArticle = <span class="hljs-function">(<span class="hljs-params">data</span>) =&gt;</span> &#123;<br>  <span class="hljs-keyword">return</span> request(&#123;<br>    url: <span class="hljs-string">"/article/create"</span>,<br>    method: <span class="hljs-string">"POST"</span>,<br>    data,<br>  &#125;);<br>&#125;;<br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * 编辑文章详情</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> articleEdit = <span class="hljs-function">(<span class="hljs-params">data</span>) =&gt;</span> &#123;<br>  <span class="hljs-keyword">return</span> request(&#123;<br>    url: <span class="hljs-string">"/article/edit"</span>,<br>    method: <span class="hljs-string">"POST"</span>,<br>    data,<br>  &#125;);<br>&#125;;<br></code></pre></td></tr></table></figure>

<blockquote>
<blockquote>
<p>注意：markwodn 和富文本最终都会处理提交事件，将提交合并到一个模块实现</p>
</blockquote>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// src/views/article-create/components/commit.js</span><br><span class="hljs-keyword">import</span> &#123; createArticle, articleEdit &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">"@/api/article"</span>;<br><span class="hljs-keyword">import</span> &#123; ElMessage &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">"element-plus"</span>;<br><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> commitArticle = <span class="hljs-keyword">async</span> (data) =&gt; &#123;<br>  <span class="hljs-keyword">const</span> res = <span class="hljs-keyword">await</span> createArticle(data);<br>  ElMessage.success(<span class="hljs-string">"创建成功！"</span>);<br>  <span class="hljs-keyword">return</span> res;<br>&#125;;<br><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> editArticle = <span class="hljs-keyword">async</span> (data) =&gt; &#123;<br>  <span class="hljs-keyword">const</span> res = <span class="hljs-keyword">await</span> articleEdit(data);<br>  ElMessage.success(<span class="hljs-string">"编辑成功！"</span>);<br>  <span class="hljs-keyword">return</span> res;<br>&#125;;<br><br><span class="hljs-comment">// 将此方法导入到markdown.vue中</span><br><span class="hljs-keyword">import</span> &#123; commitArticle &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">"./commit"</span>;<br></code></pre></td></tr></table></figure>

<blockquote>
<p>提交文本事件的触发</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// markdown.vue</span><br><span class="hljs-keyword">const</span> props = defineProps(&#123;<br>  title: &#123;<br>    required: <span class="hljs-literal">true</span>,<br>    type: <span class="hljs-built_in">String</span><br>  &#125;<br>&#125;)<br><br><span class="hljs-keyword">const</span> emits = defineEmits([<span class="hljs-string">'onSuccess'</span>])<br>...<br><span class="hljs-comment">// 处理提交</span><br><span class="hljs-keyword">const</span> onSubmitClick = <span class="hljs-keyword">async</span> () =&gt; &#123;<br>  <span class="hljs-comment">// 创建文章</span><br>  <span class="hljs-keyword">await</span> commitArticle(&#123;<br>    title: props.title,<br>    content: mkEditor.getHTML()<br>  &#125;)<br>  <span class="hljs-comment">// 重置一下</span><br>  mkEditor.reset()<br>  emits(<span class="hljs-string">'onSuccess'</span>)<br>&#125;<br></code></pre></td></tr></table></figure>

<blockquote>
<p>父组件中处理传递的 title，处理 onSuccess 事件</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 创建成功</span><br><span class="hljs-keyword">const</span> onSuccess = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> &#123;<br>  title.value = <span class="hljs-string">""</span>;<br>&#125;;<br></code></pre></td></tr></table></figure>

<blockquote>
<p>markdown 文本编辑</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 路径为src/views/article-detail/index.vue</span><br>&lt;template&gt;<br>  &lt;div <span class="hljs-class"><span class="hljs-keyword">class</span></span>=<span class="hljs-string">"article-detail-container"</span>&gt;<br>    &lt;h2 <span class="hljs-class"><span class="hljs-keyword">class</span></span>=<span class="hljs-string">"title"</span>&gt;&#123;&#123; detail.title &#125;&#125;&lt;<span class="hljs-regexp">/h2&gt;</span><br><span class="hljs-regexp">    &lt;div class="header"&gt;</span><br><span class="hljs-regexp">      &lt;span class="author"&gt;</span><br><span class="hljs-regexp">        作者：&#123;&#123; detail.author &#125;&#125;</span><br><span class="hljs-regexp">      &lt;/</span>span&gt;<br>      &lt;span <span class="hljs-class"><span class="hljs-keyword">class</span></span>=<span class="hljs-string">"time"</span>&gt;<br>        时间: &#123;&#123; $filters.relativeTime(detail.publicDate) &#125;&#125;<br>      &lt;<span class="hljs-regexp">/span&gt;</span><br><span class="hljs-regexp">      &lt;el-button type="text" class="edit" @click="onEditClick"&gt;编辑&lt;/</span>el-button&gt;<br>    &lt;<span class="hljs-regexp">/div&gt;</span><br><span class="hljs-regexp">    &lt;div class="content" v-html="detail.content"&gt;&lt;/</span>div&gt;<br>  &lt;<span class="hljs-regexp">/div&gt;</span><br><span class="hljs-regexp">&lt;/</span>template&gt;<br>&lt;script setup&gt;<br><span class="hljs-keyword">import</span> &#123; ref &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span><br><span class="hljs-keyword">import</span> &#123; useRoute, useRouter &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">'vue-router'</span><br><span class="hljs-keyword">import</span> &#123; articleDetail &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">'@/api/article'</span><br><br><span class="hljs-comment">// 获取数据</span><br><span class="hljs-keyword">const</span> route = useRoute()<br><span class="hljs-keyword">const</span> articleId = route.params.id<br><span class="hljs-keyword">const</span> detail = ref(&#123;&#125;)<br><span class="hljs-keyword">const</span> getArticleDetail = <span class="hljs-keyword">async</span> () =&gt; &#123;<br>  detail.value = <span class="hljs-keyword">await</span> articleDetail(articleId)<br>&#125;<br>getArticleDetail()<br><span class="hljs-comment">// 编辑</span><br><span class="hljs-keyword">const</span> router = useRouter()<br><span class="hljs-keyword">const</span> onEditClick = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> &#123;<br>  router.push(<span class="hljs-string">`/article/editor/<span class="hljs-subst">$&#123;articleId&#125;</span>`</span>)<br>&#125;<br>&lt;<span class="hljs-regexp">/script&gt;</span><br><span class="hljs-regexp"></span><br><span class="hljs-regexp">&lt;style lang="scss" scoped&gt;</span><br><span class="hljs-regexp">.article-detail-container &#123;</span><br><span class="hljs-regexp">  .title &#123;</span><br><span class="hljs-regexp">    font-size: 22px;</span><br><span class="hljs-regexp">    text-align: center;</span><br><span class="hljs-regexp">    padding: 12px 0;</span><br><span class="hljs-regexp">  &#125;</span><br><span class="hljs-regexp"></span><br><span class="hljs-regexp">  .header &#123;</span><br><span class="hljs-regexp">    padding: 26px 0;</span><br><span class="hljs-regexp"></span><br><span class="hljs-regexp">    .author &#123;</span><br><span class="hljs-regexp">      font-size: 14px;</span><br><span class="hljs-regexp">      color: #555666;</span><br><span class="hljs-regexp">      margin-right: 20px;</span><br><span class="hljs-regexp">    &#125;</span><br><span class="hljs-regexp"></span><br><span class="hljs-regexp">    .time &#123;</span><br><span class="hljs-regexp">      font-size: 14px;</span><br><span class="hljs-regexp">      color: #999aaa;</span><br><span class="hljs-regexp">      margin-right: 20px;</span><br><span class="hljs-regexp">    &#125;</span><br><span class="hljs-regexp"></span><br><span class="hljs-regexp">    .edit &#123;</span><br><span class="hljs-regexp">      float: right;</span><br><span class="hljs-regexp">    &#125;</span><br><span class="hljs-regexp">  &#125;</span><br><span class="hljs-regexp"></span><br><span class="hljs-regexp">  .content &#123;</span><br><span class="hljs-regexp">    font-size: 14px;</span><br><span class="hljs-regexp">    padding: 20px 0;</span><br><span class="hljs-regexp">    border-top: 1px solid #d4d4d4;</span><br><span class="hljs-regexp">    ;</span><br><span class="hljs-regexp">  &#125;</span><br><span class="hljs-regexp">&#125;</span><br><span class="hljs-regexp">&lt;/</span>style&gt;<br></code></pre></td></tr></table></figure>

<blockquote>
<p>将数据传递给 markdown 组件</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs js">&lt;markdown :title=<span class="hljs-string">"title"</span> :detail=<span class="hljs-string">"detail"</span> @onSuccess=<span class="hljs-string">"onSuccess"</span>&gt;&lt;<span class="hljs-regexp">/markdown&gt;</span><br><span class="hljs-regexp"></span><br><span class="hljs-regexp">/</span><span class="hljs-regexp">/ 数据接收</span><br><span class="hljs-regexp">const props = defineProps(&#123;</span><br><span class="hljs-regexp">  title: &#123;</span><br><span class="hljs-regexp">    required: true,</span><br><span class="hljs-regexp">    type: String</span><br><span class="hljs-regexp">  &#125;,</span><br><span class="hljs-regexp">  detail: &#123;</span><br><span class="hljs-regexp">    type: Object</span><br><span class="hljs-regexp">  &#125;</span><br><span class="hljs-regexp">&#125;)</span><br></code></pre></td></tr></table></figure>

<blockquote>
<p>使用 watch 检测数据变化，存在 detail 时，将 detail 赋值给 mkEditor</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 编辑相关</span><br>watch(<br>  () =&gt; props.detail,<br>  (val) =&gt; &#123;<br>    <span class="hljs-keyword">if</span> (val &amp;&amp; val.content) &#123;<br>      mkEditor.setHTML(val.content);<br>    &#125;<br>  &#125;,<br>  &#123;<br>    immediate: <span class="hljs-literal">true</span>,<br>  &#125;<br>);<br></code></pre></td></tr></table></figure>

<blockquote>
<p>markdown 组件中处理提交事件</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 处理提交</span><br><span class="hljs-keyword">const</span> onSubmitClick = <span class="hljs-keyword">async</span> () =&gt; &#123;<br>  <span class="hljs-keyword">if</span> (props.detail &amp;&amp; props.detail._id) &#123;<br>    <span class="hljs-comment">// 编辑文章</span><br>    <span class="hljs-keyword">await</span> editArticle(&#123;<br>      id: props.detail._id,<br>      title: props.title,<br>      content: mkEditor.getHTML(),<br>    &#125;);<br>  &#125; <span class="hljs-keyword">else</span> &#123;<br>    <span class="hljs-comment">// 创建文章</span><br>    <span class="hljs-keyword">await</span> commitArticle(&#123;<br>      title: props.title,<br>      content: mkEditor.getHTML(),<br>    &#125;);<br>  &#125;<br><br>  mkEditor.reset();<br>  emits(<span class="hljs-string">"onSuccess"</span>);<br>&#125;;<br></code></pre></td></tr></table></figure>

<h2 id="1-4-富文本编辑器：wangEditor"><a href="#1-4-富文本编辑器：wangEditor" class="headerlink" title="1-4 富文本编辑器：wangEditor"></a>1-4 富文本编辑器：wangEditor</h2><blockquote>
<p>安装 plugin</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">npm i wangeditor@4.7.6<br></code></pre></td></tr></table></figure>

<blockquote>
<p>富文本的基本组件结构和 markdown 组件基本一致</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br></pre></td><td class="code"><pre><code class="hljs js">&lt;template&gt;<br>  &lt;div <span class="hljs-class"><span class="hljs-keyword">class</span></span>=<span class="hljs-string">"editor-container"</span>&gt;<br>    &lt;div id=<span class="hljs-string">"editor-box"</span>&gt;&lt;<span class="hljs-regexp">/div&gt;</span><br><span class="hljs-regexp">    &lt;div class="bottom"&gt;</span><br><span class="hljs-regexp">      &lt;el-button type="primary" @click="onSubmitClick"&gt;提交&lt;/</span>el-button&gt;<br>    &lt;<span class="hljs-regexp">/div&gt;</span><br><span class="hljs-regexp">  &lt;/</span>div&gt;<br>&lt;<span class="hljs-regexp">/template&gt;</span><br><span class="hljs-regexp"></span><br><span class="hljs-regexp">&lt;script setup&gt;</span><br><span class="hljs-regexp">import E from 'wangeditor'</span><br><span class="hljs-regexp">import &#123; onMounted, defineProps, defineEmits, watch &#125; from 'vue'</span><br><span class="hljs-regexp">import &#123; useStore &#125; from 'vuex'</span><br><span class="hljs-regexp">import &#123; commitArticle, editArticle &#125; from './</span>commit<span class="hljs-string">'</span><br><span class="hljs-string"></span><br><span class="hljs-string">const props = defineProps(&#123;</span><br><span class="hljs-string">  title: &#123;</span><br><span class="hljs-string">    required: true,</span><br><span class="hljs-string">    type: String</span><br><span class="hljs-string">  &#125;,</span><br><span class="hljs-string">  detail: &#123;</span><br><span class="hljs-string">    type: Object</span><br><span class="hljs-string">  &#125;</span><br><span class="hljs-string">&#125;)</span><br><span class="hljs-string"></span><br><span class="hljs-string">const emits = defineEmits(['</span>onSuccess<span class="hljs-string">'])</span><br><span class="hljs-string"></span><br><span class="hljs-string">const store = useStore()</span><br><span class="hljs-string"></span><br><span class="hljs-string">// Editor实例</span><br><span class="hljs-string">let editor</span><br><span class="hljs-string">// 处理离开页面切换语言导致 dom 无法被获取</span><br><span class="hljs-string">let el</span><br><span class="hljs-string">onMounted(() =&gt; &#123;</span><br>  el = document.querySelector('#editor-box')<br>  initEditor()<br>&#125;)<br><br><span class="hljs-keyword">const</span> initEditor = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> &#123;<br>  editor = <span class="hljs-keyword">new</span> E(el)<br>  editor.config.zIndex = <span class="hljs-number">1</span><br>  <span class="hljs-comment">// 菜单栏提示</span><br>  editor.config.showMenuTooltips = <span class="hljs-literal">true</span><br>  editor.config.menuTooltipPosition = <span class="hljs-string">'down'</span><br><br>  editor.create()<br>&#125;<br><br><span class="hljs-comment">// 编辑相关</span><br>watch(<br>  () =&gt; props.detail,<br>  val =&gt; &#123;<br>    <span class="hljs-keyword">if</span> (val &amp;&amp; val.content) &#123;<br>      editor.txt.html(val.content)<br>    &#125;<br>  &#125;,<br>  &#123;<br>    immediate: <span class="hljs-literal">true</span><br>  &#125;<br>)<br><br><span class="hljs-comment">// 处理文本提交的事件</span><br><span class="hljs-keyword">const</span> onSubmitClick = <span class="hljs-keyword">async</span> () =&gt; &#123;<br>  <span class="hljs-keyword">if</span> (props.detail &amp;&amp; props.detail._id) &#123;<br>    <span class="hljs-comment">// 编辑文章</span><br>    <span class="hljs-keyword">await</span> editArticle(&#123;<br>      id: props.detail._id,<br>      title: props.title,<br>      content: editor.txt.html()<br>    &#125;)<br>  &#125; <span class="hljs-keyword">else</span> &#123;<br>    <span class="hljs-comment">// 创建文章</span><br>    <span class="hljs-keyword">await</span> commitArticle(&#123;<br>      title: props.title,<br>      content: editor.txt.html()<br>    &#125;)<br>  &#125;<br><br>  editor.txt.html(<span class="hljs-string">''</span>)<br>  emits(<span class="hljs-string">'onSuccess'</span>)<br>&#125;<br>&lt;<span class="hljs-regexp">/script&gt;</span><br><span class="hljs-regexp"></span><br><span class="hljs-regexp">&lt;style lang="scss" scoped&gt;</span><br><span class="hljs-regexp">.editor-container &#123;</span><br><span class="hljs-regexp">  .bottom &#123;</span><br><span class="hljs-regexp">    margin-top: 20px;</span><br><span class="hljs-regexp">    text-align: right;</span><br><span class="hljs-regexp">  &#125;</span><br><span class="hljs-regexp">&#125;</span><br><span class="hljs-regexp">&lt;/</span>style&gt;<br></code></pre></td></tr></table></figure>
</article><section class="jump-container is-flex is-justify-content-space-between my-6"><!-- em is empty placeholder--><a class="button is-default" href="/2022/12/03/102-deploy/" title="102、项目部署通用方案"><i class="iconfont icon-prev mr-2 has-text-grey"></i><span class="has-text-weight-semibold">上一页: 102、项目部署通用方案</span></a><a class="button is-default" href="/2022/11/29/100-vuex/" title="100、vuex的缺点及从0写一个vuex的思路"><span class="has-text-weight-semibold">下一页: 100、vuex的缺点及从0写一个vuex的思路</span><i class="iconfont icon-next ml-2 has-text-grey"></i></a></section></div></div></main></main><footer class="is-flex is-flex-direction-column is-align-items-center is-flex-shrink-0 is-family-serif"><section class="sns-container"><!-- Github--><a title="github" target="_blank" rel="noopener nofollow" href="//github.com/Jude"><i class="iconfont icon-github"></i></a><!-- Ins--><!-- RSS--><!-- 知乎--><a title="zhihu" target="_blank" rel="noopener nofollow" href="//zhihu.com/https://www.zhihu.com/hot"><i class="iconfont icon-zhihu"></i></a><!-- 领英--><!-- 脸书--></section><p><span>Copyright ©</span><span> Jude 2024</span></p><div class="is-flex is-justify-content-center is-flex-wrap-wrap"><p>Powered by Hexo &verbar;&nbsp;</p><p class="is-flex is-justify-content-center"><a title="Hexo theme author" href="//github.com/haojen" target="_blank" rel="noopener">Theme by Haojen&nbsp;</a></p><div style="margin-top: 2px"><a class="github-button" title="github-button" href="https://github.com/haojen/hexo-theme-Claudia" target="_blank" rel="noopener" data-color-scheme="no-preference: light; light: light; dark: dark;" data-show-count="true"></a></div></div><div><span>记住昨日的美好，过好今日的生活，憧憬明天的到来</span></div></footer><script async defer src="https://buttons.github.io/buttons.js"></script><script src="/js/post.js"></script></body></html>