<!DOCTYPE html><html class="appearance-auto" lang="zh-CN"><head><meta charset="UTF-8"><title>121、ProTable</title><meta name="description" content="呦呦鹿鸣，食野之苹"><meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no, initial-scale=1"><!-- Google Analytics --><!-- End Google Analytics -->
<!-- Baidu Analytics --><!-- End Baidu Analytics --><link rel="icon" href="/images/favicon.png"><link rel="stylesheet" href="/style/common/bulma.css"><link rel="stylesheet" href="/style/base.css"><link rel="stylesheet" href="/style/common/helper.css"><script src="/js/common.js"></script><link rel="stylesheet" href="/style/post.css"><link rel="stylesheet" href="/style/themes/highlight-theme-light.css"><script src="/js/highlight.pack.js"></script><meta name="description" content="ProTable 是基于 Vue3.2 + Element-Plus 二次封装 el-table,首先我们在封装 ProTable 组件的时候，在不影响 el-table 原有的属性、事件、方法的前提下，然后在其基础上做二次封装。



ProTable 组件目前使用属性透传进行重构，支持 el-table &amp;amp;&amp;amp; el-table-column 所有属性、事件、方法的调用。ProTable 组件上的绑定的所有属性和事件都会通过 v-bind=&amp;quot;$attrs&amp;quot; 透传到 el-table 上。ProTable 组件内部暴露了 el-table DOM，可通过 proTable.value.element.方法名 调用其方法。

思路把一个表格页面所有重复的功能 （表格多选、查.."><meta name="generator" content="Hexo 5.4.1"></head><body class="is-flex is-flex-direction-column"><header class="header-widget is-flex-shrink-0 is-hidden-mobile"><div class="container is-fullhd is-flex is-justify-content-space-between is-align-items-center is-full-height"><section class="is-hidden-mobile is-flex-shrink-0"><h2><a href="/">Jude's blog</a></h2></section><h3 class="is-hidden-mobile is-family-serif is-full-height is-flex is-align-items-center is-flex-shrink-0"><div class="is-full-height" id="postTopic"><p class="is-full-height is-flex-shrink-0 is-flex is-align-items-center is-justify-content-center">121、ProTable</p><p class="is-full-height is-flex-shrink-0 is-flex is-align-items-center is-justify-content-center">点击返回顶部</p></div></h3><aside class="is-flex-shrink-0"><h3 class="is-inline-block"><a href="/">首页</a></h3><h3 class="is-inline-block"><a href="/about">关于</a></h3><h3 class="is-inline-block"><a href="/archives">归档</a></h3></aside></div></header><header class="is-flex header-widget is-flex-shrink-0 is-align-items-center is-justify-content-center is-hidden-tablet"><h3 class="is-inline-block"><a href="/">首页</a></h3><h3 class="is-inline-block"><a href="/about">关于</a></h3><h3 class="is-inline-block"><a href="/archives">归档</a></h3></header><main><main class="container is-max-widescreen content section post-page pt-4 px-4"><div class="columns is-flex-desktop is-justify-content-center is-flex-direction-row-reverse"><div class="column is-3 is-hidden-mobile"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%80%9D%E8%B7%AF"><span class="toc-text">思路</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80%E3%80%81ProTable-%E5%8A%9F%E8%83%BD"><span class="toc-text">一、ProTable 功能</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C%E3%80%81ProTable-%E9%9C%80%E6%B1%82%E5%88%86%E6%9E%90"><span class="toc-text">二、ProTable 需求分析</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1%E3%80%81%E8%A1%A8%E6%A0%BC%E6%90%9C%E7%B4%A2%E5%8C%BA"><span class="toc-text">1、表格搜索区</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2%E3%80%81%E8%A1%A8%E6%A0%BC%E6%95%B0%E6%8D%AE%E6%93%8D%E4%BD%9C%E6%8C%89%E9%92%AE"><span class="toc-text">2、表格数据操作按钮</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3%E3%80%81%E8%A1%A8%E6%A0%BC%E5%8A%9F%E8%83%BD%E6%8C%89%E9%92%AE"><span class="toc-text">3、表格功能按钮</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4%E3%80%81%E8%A1%A8%E6%A0%BC%E4%B8%BB%E4%BD%93%E5%86%85%E5%AE%B9%E5%B1%95%E7%A4%BA%E5%8C%BA%E5%9F%9F"><span class="toc-text">4、表格主体内容展示区域</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5%E3%80%81%E8%A1%A8%E6%A0%BC%E5%88%86%E9%A1%B5"><span class="toc-text">5、表格分页</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%89%E3%80%81Hooks-%E5%87%BD%E6%95%B0"><span class="toc-text">三、Hooks 函数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%9B%E3%80%81ProTable-%E7%BB%84%E4%BB%B6%E9%83%A8%E5%88%86%E4%BB%A3%E7%A0%81"><span class="toc-text">四、ProTable 组件部分代码</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#ProTable-vue"><span class="toc-text">ProTable.vue</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#TableColumn-vue"><span class="toc-text">TableColumn.vue</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8-ProTable-%E7%BB%84%E4%BB%B6"><span class="toc-text">使用 ProTable 组件</span></a></li></ol></li></ol></li></ol></div><div class="column is-9"><header class="my-4"><a href="/tags/vue3"><i class="tag post-item-tag">vue3</i></a></header><h1 class="mt-0 mb-1 is-family-serif" id="postTitle">121、ProTable</h1><time class="has-text-grey" datetime="2023-02-08T12:00:00.000Z">2023-02-08</time><article class="mt-2 post-content"><p>ProTable 是基于 Vue3.2 + Element-Plus 二次封装 el-table,首先我们在封装 ProTable 组件的时候，在不影响 el-table 原有的属性、事件、方法的前提下，然后在其基础上做二次封装。</p>
<span id="more"></span>

<blockquote>
<p><code>ProTable 组件目前使用属性透传进行重构，支持 el-table &amp;&amp; el-table-column 所有属性、事件、方法的调用。ProTable 组件上的绑定的所有属性和事件都会通过 v-bind=&quot;$attrs&quot; 透传到 el-table 上。ProTable 组件内部暴露了 el-table DOM，可通过 proTable.value.element.方法名 调用其方法。</code></p>
</blockquote>
<h2 id="思路"><a href="#思路" class="headerlink" title="思路"></a>思路</h2><p>把一个表格页面所有重复的功能 （表格多选、查询、重置、刷新、分页、数据操作二次确认、文件下载、文件上传） 都封装成 Hooks 函数钩子或组件，然后在 ProTable 组件中使用这些函数钩子或组件。在页面中使用的时，只需传给 ProTable 当前表格数据的请求 API、表格配置项 columns 就行了，数据传输都使用 作用域插槽 或 tsx 语法从 ProTable 传递给父组件就能在页面上获取到了。</p>
<h2 id="一、ProTable-功能"><a href="#一、ProTable-功能" class="headerlink" title="一、ProTable 功能"></a>一、ProTable 功能</h2><p>1、表格内容自适应屏幕宽高，溢出内容表格内部滚动（flex 布局）<br>2、表格搜索、重置、分页查询 Hooks 封装 （页面使用不会存在任何搜索、重置、分页查询逻辑）<br>3、表格数据操作 Hooks 封装 （单条数据删除、批量删除、重置密码、状态切换等操作）<br>4、表格数据多选 Hooks 封装 （支持现跨页勾选数据）<br>5、表格数据导入组件、导出 Hooks 封装<br>6、表格搜索区域使用 Grid 布局重构，支持自定义响应式配置<br>7、表格分页组件封装（Pagination）<br>8、表格数据刷新、列显隐、列排序、搜索区域显隐设置<br>9、表格数据打印功能（可勾选行数据、隐藏列打印）<br>10、表格配置支持多级 prop（示例 ==&gt; prop: user.detail.name）<br>11、单元格内容格式化、tag 标签显示（有字典 enum 会根据字典 enum 自动格式化）<br>12、支持多级表头、表头内容自定义渲染（支持作用域插槽、tsx 语法、h 函数）<br>13、支持单元格内容自定义渲染（支持作用域插槽、tsx 语法、h 函数）<br>14、配合 TreeFilter、SelectFilter 组件使用更佳</p>
<h2 id="二、ProTable-需求分析"><a href="#二、ProTable-需求分析" class="headerlink" title="二、ProTable 需求分析"></a>二、ProTable 需求分析</h2><p>ProTable 主要分为五个模块：</p>
<h4 id="1、表格搜索区"><a href="#1、表格搜索区" class="headerlink" title="1、表格搜索区"></a>1、表格搜索区</h4><blockquote>
<p>搜索区域的字段都是存在于表格当中的，并且每个页面的搜索、重置方法都是一样的逻辑，只是不同的查询参数而已。我们完全可以在传表格配置项 columns 时，直接指定某个 column 的 search 配置，就能把该项变为搜索项，然后使用 el 字段可以指定搜索框的类型，最后把表格的搜索方法都封装成 Hooks 钩子函数。页面上完全就不会存在任何搜索、重置逻辑了。</p>
</blockquote>
<p>通过 component :is 动态组件 &amp;&amp; v-bind 属性透传实现，将用户传递的参数全部透传到组件上，所以可以直接根据 element 官方文档在 props 中传递参数了。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;template&gt;<br>  &lt;component<br>    :is=&quot;column.search?.render ?? `el-$&#123;column.search?.el&#125;`&quot;<br>    v-bind=&quot;&#123; ...handleSearchProps, ...placeholder, searchParam, clearable &#125;&quot;<br>    v-model.trim=&quot;searchParam[column.search?.key ?? handleProp(column.prop!)]&quot;<br>    :data=&quot;column.search?.el === &#x27;tree-select&#x27; ? columnEnum : []&quot;<br>    :options=&quot;[&#x27;cascader&#x27;, &#x27;select-v2&#x27;].includes(column.search?.el!) ? columnEnum : []&quot;<br>  &gt;<br>    &lt;template #default=&quot;&#123; data &#125;&quot; v-if=&quot;column.search?.el === &#x27;cascader&#x27;&quot;&gt;<br>      &lt;span&gt;&#123;&#123; data[fieldNames.label] &#125;&#125;&lt;/span&gt;<br>    &lt;/template&gt;<br>    &lt;template v-if=&quot;column.search?.el === &#x27;select&#x27;&quot;&gt;<br>      &lt;component<br>        :is=&quot;`el-option`&quot;<br>        v-for=&quot;(col, index) in columnEnum&quot;<br>        :key=&quot;index&quot;<br>        :label=&quot;col[fieldNames.label]&quot;<br>        :value=&quot;col[fieldNames.value]&quot;<br>      &gt;&lt;/component&gt;<br>    &lt;/template&gt;<br>    &lt;slot v-else&gt;&lt;/slot&gt;<br>  &lt;/component&gt;<br>&lt;/template&gt;<br><br>&lt;script setup lang=&quot;ts&quot; name=&quot;SearchFormItem&quot;&gt;<br>import &#123; computed, inject, ref &#125; from &quot;vue&quot;;<br>import &#123; handleProp &#125; from &quot;@/utils&quot;;<br>import &#123; ColumnProps &#125; from &quot;@/components/ProTable/interface&quot;;<br><br>interface SearchFormItem &#123;<br>  column: ColumnProps;<br>  searchParam: &#123; [key: string]: any &#125;;<br>&#125;<br>const props = defineProps&lt;SearchFormItem&gt;();<br><br>// 判断 fieldNames 设置 label &amp;&amp; value &amp;&amp; children 的 key 值<br>const fieldNames = computed(() =&gt; &#123;<br>  return &#123;<br>    label: props.column.fieldNames?.label ?? &quot;label&quot;,<br>    value: props.column.fieldNames?.value ?? &quot;value&quot;,<br>    children: props.column.fieldNames?.children ?? &quot;children&quot;,<br>  &#125;;<br>&#125;);<br><br>// 接收 enumMap (el 为 select-v2 需单独处理 enumData)<br>const enumMap = inject(&quot;enumMap&quot;, ref(new Map()));<br>const columnEnum = computed(() =&gt; &#123;<br>  let enumData = enumMap.value.get(props.column.prop);<br>  if (!enumData) return [];<br>  if (props.column.search?.el === &quot;select-v2&quot; &amp;&amp; props.column.fieldNames) &#123;<br>    enumData = enumData.map((item: &#123; [key: string]: any &#125;) =&gt; &#123;<br>      return &#123;<br>        ...item,<br>        label: item[fieldNames.value.label],<br>        value: item[fieldNames.value.value],<br>      &#125;;<br>    &#125;);<br>  &#125;<br>  return enumData;<br>&#125;);<br><br>// 处理透传的 searchProps (el 为 tree-select、cascader 的时候需要给下默认 label &amp;&amp; value &amp;&amp; children)<br>const handleSearchProps = computed(() =&gt; &#123;<br>  const label = fieldNames.value.label;<br>  const value = fieldNames.value.value;<br>  const children = fieldNames.value.children;<br>  const searchEl = props.column.search?.el;<br>  let searchProps = props.column.search?.props ?? &#123;&#125;;<br>  if (searchEl === &quot;tree-select&quot;) &#123;<br>    searchProps = &#123;<br>      ...searchProps,<br>      props: &#123; ...searchProps.props, label, children &#125;,<br>      nodeKey: value,<br>    &#125;;<br>  &#125;<br>  if (searchEl === &quot;cascader&quot;) &#123;<br>    searchProps = &#123;<br>      ...searchProps,<br>      props: &#123; ...searchProps.props, label, value, children &#125;,<br>    &#125;;<br>  &#125;<br>  return searchProps;<br>&#125;);<br><br>// 处理默认 placeholder<br>const placeholder = computed(() =&gt; &#123;<br>  const search = props.column.search;<br>  if (<br>    [&quot;datetimerange&quot;, &quot;daterange&quot;, &quot;monthrange&quot;].includes(<br>      search?.props?.type<br>    ) ||<br>    search?.props?.isRange<br>  ) &#123;<br>    return &#123;<br>      rangeSeparator: &quot;至&quot;,<br>      startPlaceholder: &quot;开始时间&quot;,<br>      endPlaceholder: &quot;结束时间&quot;,<br>    &#125;;<br>  &#125;<br>  const placeholder =<br>    search?.props?.placeholder ??<br>    (search?.el?.includes(&quot;input&quot;) ? &quot;请输入&quot; : &quot;请选择&quot;);<br>  return &#123; placeholder &#125;;<br>&#125;);<br><br>// 是否有清除按钮 (当搜索项有默认值时，清除按钮不显示)<br>const clearable = computed(() =&gt; &#123;<br>  const search = props.column.search;<br>  return (<br>    search?.props?.clearable ??<br>    (search?.defaultValue == null || search?.defaultValue == undefined)<br>  );<br>&#125;);<br>&lt;/script&gt;<br></code></pre></td></tr></table></figure>

<p>表格搜索项可以使用 tsx 组件自定义渲染</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;script setup lang=&quot;tsx&quot;&gt;<br>const columns: ColumnProps[] = [<br>  &#123;<br>    prop: &quot;user.detail.age&quot;,<br>    label: &quot;年龄&quot;,<br>    search: &#123;<br>      // 自定义 search 组件<br>      render: (&#123; searchParam &#125;) =&gt; &#123;<br>        return (<br>          &lt;div class=&quot;flx-center&quot;&gt;<br>            &lt;el-input<br>              vModel_trim=&#123;searchParam.minAge&#125;<br>              placeholder=&quot;最小年龄&quot;<br>              style=&#123;&#123; width: &quot;50%&quot; &#125;&#125;<br>            /&gt;<br>            &lt;span class=&quot;mr10 ml10&quot;&gt;-&lt;/span&gt;<br>            &lt;el-input<br>              vModel_trim=&#123;searchParam.maxAge&#125;<br>              placeholder=&quot;最大年龄&quot;<br>              style=&#123;&#123; width: &quot;50%&quot; &#125;&#125;<br>            /&gt;<br>          &lt;/div&gt;<br>        );<br>      &#125;,<br>    &#125;,<br>  &#125;,<br>];<br>&lt;/script&gt;<br></code></pre></td></tr></table></figure>

<h4 id="2、表格数据操作按钮"><a href="#2、表格数据操作按钮" class="headerlink" title="2、表格数据操作按钮"></a>2、表格数据操作按钮</h4><blockquote>
<p>表格数据操作按钮基本上每个页面都会不一样，所以我们直接使用 作用域插槽 来完成每个页面的数据操作按钮区域，作用域插槽 可以将表格多选数据信息从 ProTable 的 Hooks 多选钩子函数中传到页面上使用。<br>scope 数据中包含：selectedList（当前选择的数据）、selectedListIds（当前选择的数据 id）、isSelected（当前是否选中的数据）</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;!-- ProTable 中 tableHeader 插槽 --&gt;<br>&lt;slot<br>  name=&quot;tableHeader&quot;<br>  :selectList=&quot;selectedList&quot;<br>  :selectedListIds=&quot;selectedListIds&quot;<br>  :isSelected=&quot;isSelected&quot;<br>&gt;&lt;/slot&gt;<br><br>&lt;!-- 页面使用 --&gt;<br>&lt;template #tableHeader=&quot;scope&quot;&gt;<br>  &lt;el-button type=&quot;primary&quot; :icon=&quot;CirclePlus&quot; @click=&quot;openDrawer(&#x27;新增&#x27;)&quot;<br>    &gt;新增用户&lt;/el-button<br>  &gt;<br>  &lt;el-button type=&quot;primary&quot; :icon=&quot;Upload&quot; plain @click=&quot;batchAdd&quot;<br>    &gt;批量添加用户&lt;/el-button<br>  &gt;<br>  &lt;el-button type=&quot;primary&quot; :icon=&quot;Download&quot; plain @click=&quot;downloadFile&quot;<br>    &gt;导出用户数据&lt;/el-button<br>  &gt;<br>  &lt;el-button<br>    type=&quot;danger&quot;<br>    :icon=&quot;Delete&quot;<br>    plain<br>    @click=&quot;batchDelete(scope.selectedListIds)&quot;<br>    :disabled=&quot;!scope.isSelected&quot;<br>    &gt;批量删除用户&lt;/el-button<br>  &gt;<br>&lt;/template&gt;<br></code></pre></td></tr></table></figure>

<h4 id="3、表格功能按钮"><a href="#3、表格功能按钮" class="headerlink" title="3、表格功能按钮"></a>3、表格功能按钮</h4><blockquote>
<p>表格功能按钮包括：表格数据刷新（一直会携带当前查询和分页条件）、表格数据打印、表格列设置（列显隐、列排序）、表格搜索区域显隐（方便展示更多的数据信息）。 可通过 toolButton 属性控制这块区域的显隐。<br>表格打印基于 PrintJs 实现，因 PrintJs 不支持多级表头打印，所以当页面存在多级表头时，只会打印最后一级表头。表格打印功能可根据显示的列和勾选的数据动态打印，默认打印当前显示的所有数据。</p>
</blockquote>
<h4 id="4、表格主体内容展示区域"><a href="#4、表格主体内容展示区域" class="headerlink" title="4、表格主体内容展示区域"></a>4、表格主体内容展示区域</h4><p>这里是最重要的数据展示区域，表头和单元格内容可以自定义渲染，表头支持 headerRender 方法（避免与 el-table-column 上的属性重名导致报错）、作用域插槽（column.prop + ‘Header’）两种方式自定义，单元格内容支持 render 方法和作用域插槽（column 上的 prop 属性）两种方式自定义。</p>
<p>作用域插槽：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;!-- 使用作用域插槽自定义单元格内容 username --&gt;<br>&lt;template #username=&quot;scope&quot;&gt;<br>  &#123;&#123; scope.row.username &#125;&#125;<br>&lt;/template&gt;<br><br>&lt;!-- 使用作用域插槽自定义表头内容 username --&gt;<br>&lt;template #usernameHeader=&quot;scope&quot;&gt;<br>  &lt;el-button<br>    type=&quot;primary&quot;<br>    @click=&quot;ElMessage.success(&#x27;我是通过作用域插槽渲染的表头&#x27;)&quot;<br>  &gt;<br>    &#123;&#123; scope.column.label &#125;&#125;<br>  &lt;/el-button&gt;<br>&lt;/template&gt;<br></code></pre></td></tr></table></figure>

<p>tsx 语法：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;script setup lang=&quot;tsx&quot;&gt;<br>const columns: ColumnProps[] = [<br> &#123;<br>    prop: &quot;username&quot;,<br>    label: &quot;用户姓名&quot;,<br>    // 使用 headerRender 自定义表头<br>    headerRender: scope =&gt; &#123;<br>      return (<br>        &lt;el-button<br>          type=&quot;primary&quot;<br>          onClick=&#123;() =&gt; &#123;<br>            ElMessage.success(&quot;我是通过 tsx 语法渲染的表头&quot;);<br>          &#125;&#125;<br>        &gt;<br>          &#123;scope.column.label&#125;<br>        &lt;/el-button&gt;<br>      );<br>    &#125;<br>  &#125;,<br>  &#123;<br>    prop: &quot;status&quot;,<br>    label: &quot;用户状态&quot;,<br>    // 使用 render 自定义表格内容<br>    render: scope =&gt; &#123;<br>      return (<br>          &lt;el-switch<br>            model-value=&#123;scope.row.status&#125;<br>            active-text=&#123;scope.row.status ? &quot;启用&quot; : &quot;禁用&quot;&#125;<br>            active-value=&#123;1&#125;<br>            inactive-value=&#123;0&#125;<br>            onClick=&#123;() =&gt; changeStatus(scope.row)&#125;<br>          /&gt;<br>        )<br>      );<br>    &#125;<br>  &#125;,<br>];<br>&lt;/script&gt;<br></code></pre></td></tr></table></figure>

<blockquote>
<p>如果你想使用 el-table 的任何属性、事件，目前通过属性透传都能支持。</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;template&gt;<br>  &lt;el-table ref=&quot;tableRef&quot; v-bind=&quot;$attrs&quot;&gt; &lt;/el-table&gt;<br>&lt;/template&gt;<br><br>&lt;script setup lang=&quot;ts&quot; name=&quot;ProTable&quot;&gt;<br>import &#123; ref &#125; from &quot;vue&quot;;<br>import &#123; ElTable &#125; from &quot;element-plus&quot;;<br><br>const tableRef = ref&lt;InstanceType&lt;typeof ElTable&gt;&gt;();<br><br>defineExpose(&#123; element: tableRef &#125;);<br>&lt;/script&gt;<br></code></pre></td></tr></table></figure>

<h4 id="5、表格分页"><a href="#5、表格分页" class="headerlink" title="5、表格分页"></a>5、表格分页</h4><p>表格分页的封装可以使 ProTable 页面不存在分页逻辑。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;template&gt;<br>  &lt;!-- 分页组件 --&gt;<br>  &lt;el-pagination<br>    :background=&quot;true&quot;<br>    :current-page=&quot;pageable.pageNum&quot;<br>    :page-size=&quot;pageable.pageSize&quot;<br>    :page-sizes=&quot;[10, 25, 50, 100]&quot;<br>    :total=&quot;pageable.total&quot;<br>    layout=&quot;total, sizes, prev, pager, next, jumper&quot;<br>    @size-change=&quot;handleSizeChange&quot;<br>    @current-change=&quot;handleCurrentChange&quot;<br>  &gt;&lt;/el-pagination&gt;<br>&lt;/template&gt;<br><br>&lt;script setup lang=&quot;ts&quot; name=&quot;Pagination&quot;&gt;<br>interface Pageable &#123;<br>  pageNum: number;<br>  pageSize: number;<br>  total: number;<br>&#125;<br><br>interface PaginationProps &#123;<br>  pageable: Pageable;<br>  handleSizeChange: (size: number) =&gt; void;<br>  handleCurrentChange: (currentPage: number) =&gt; void;<br>&#125;<br><br>defineProps&lt;PaginationProps&gt;();<br>&lt;/script&gt;<br></code></pre></td></tr></table></figure>

<h2 id="三、Hooks-函数"><a href="#三、Hooks-函数" class="headerlink" title="三、Hooks 函数"></a>三、Hooks 函数</h2><p>1、useTable</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">import</span> &#123; Table &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;./interface&quot;</span>;<br><span class="hljs-keyword">import</span> &#123; reactive, computed, toRefs &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;vue&quot;</span>;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@description </span>table 页面操作方法封装</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param <span class="hljs-type">&#123;Function&#125;</span> </span>api 获取表格数据 api 方法 (必传)</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param <span class="hljs-type">&#123;Object&#125;</span> </span>initParam 获取数据初始化参数 (非必传，默认为&#123;&#125;)</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param <span class="hljs-type">&#123;Boolean&#125;</span> </span>isPageable 是否有分页 (非必传，默认为true)</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param <span class="hljs-type">&#123;Function&#125;</span> </span>dataCallBack 对后台返回的数据进行处理的方法 (非必传)</span><br><span class="hljs-comment"> * */</span><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> useTable = <span class="hljs-function">(<span class="hljs-params"></span></span><br><span class="hljs-params"><span class="hljs-function">  api?: (params: <span class="hljs-built_in">any</span>) =&gt; <span class="hljs-built_in">Promise</span>&lt;<span class="hljs-built_in">any</span>&gt;,</span></span><br><span class="hljs-params"><span class="hljs-function">  initParam: <span class="hljs-built_in">object</span> = &#123;&#125;,</span></span><br><span class="hljs-params"><span class="hljs-function">  isPageable: <span class="hljs-built_in">boolean</span> = <span class="hljs-literal">true</span>,</span></span><br><span class="hljs-params"><span class="hljs-function">  dataCallBack?: (data: <span class="hljs-built_in">any</span>) =&gt; <span class="hljs-built_in">any</span>,</span></span><br><span class="hljs-params"><span class="hljs-function">  requestError?: (error: <span class="hljs-built_in">any</span>) =&gt; <span class="hljs-built_in">void</span></span></span><br><span class="hljs-params"><span class="hljs-function"></span>) =&gt;</span> &#123;<br>  <span class="hljs-keyword">const</span> state = reactive&lt;Table.TableStateProps&gt;(&#123;<br>    <span class="hljs-comment">// 表格数据</span><br>    <span class="hljs-attr">tableData</span>: [],<br>    <span class="hljs-comment">// 分页数据</span><br>    <span class="hljs-attr">pageable</span>: &#123;<br>      <span class="hljs-comment">// 当前页数</span><br>      <span class="hljs-attr">pageNum</span>: <span class="hljs-number">1</span>,<br>      <span class="hljs-comment">// 每页显示条数</span><br>      <span class="hljs-attr">pageSize</span>: <span class="hljs-number">10</span>,<br>      <span class="hljs-comment">// 总条数</span><br>      <span class="hljs-attr">total</span>: <span class="hljs-number">0</span>,<br>    &#125;,<br>    <span class="hljs-comment">// 查询参数(只包括查询)</span><br>    <span class="hljs-attr">searchParam</span>: &#123;&#125;,<br>    <span class="hljs-comment">// 初始化默认的查询参数</span><br>    <span class="hljs-attr">searchInitParam</span>: &#123;&#125;,<br>    <span class="hljs-comment">// 总参数(包含分页和查询参数)</span><br>    <span class="hljs-attr">totalParam</span>: &#123;&#125;,<br>  &#125;);<br><br>  <span class="hljs-comment">/**</span><br><span class="hljs-comment">   * <span class="hljs-doctag">@description </span>分页查询参数(只包括分页和表格字段排序,其他排序方式可自行配置)</span><br><span class="hljs-comment">   * */</span><br>  <span class="hljs-keyword">const</span> pageParam = computed(&#123;<br>    <span class="hljs-attr">get</span>: <span class="hljs-function">() =&gt;</span> &#123;<br>      <span class="hljs-keyword">return</span> &#123;<br>        <span class="hljs-attr">pageNum</span>: state.pageable.pageNum,<br>        <span class="hljs-attr">pageSize</span>: state.pageable.pageSize,<br>      &#125;;<br>    &#125;,<br>    <span class="hljs-attr">set</span>: <span class="hljs-function">(<span class="hljs-params">newVal: <span class="hljs-built_in">any</span></span>) =&gt;</span> &#123;<br>      <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&quot;我是分页更新之后的值&quot;</span>, newVal);<br>    &#125;,<br>  &#125;);<br><br>  <span class="hljs-comment">/**</span><br><span class="hljs-comment">   * <span class="hljs-doctag">@description </span>获取表格数据</span><br><span class="hljs-comment">   * <span class="hljs-doctag">@return <span class="hljs-variable">void</span></span></span><br><span class="hljs-comment">   * */</span><br>  <span class="hljs-keyword">const</span> getTableList = <span class="hljs-keyword">async</span> () =&gt; &#123;<br>    <span class="hljs-keyword">if</span> (!api) <span class="hljs-keyword">return</span>;<br>    <span class="hljs-keyword">try</span> &#123;<br>      <span class="hljs-comment">// 先把初始化参数和分页参数放到总参数里面</span><br>      <span class="hljs-built_in">Object</span>.assign(<br>        state.totalParam,<br>        initParam,<br>        isPageable ? pageParam.value : &#123;&#125;<br>      );<br>      <span class="hljs-keyword">let</span> &#123; data &#125; = <span class="hljs-keyword">await</span> api(&#123;<br>        ...state.searchInitParam,<br>        ...state.totalParam,<br>      &#125;);<br>      dataCallBack &amp;&amp; (data = dataCallBack(data));<br>      state.tableData = isPageable ? data.list : data;<br>      <span class="hljs-comment">// 解构后台返回的分页数据 (如果有分页更新分页信息)</span><br>      <span class="hljs-keyword">const</span> &#123; pageNum, pageSize, total &#125; = data;<br>      isPageable &amp;&amp; updatePageable(&#123; pageNum, pageSize, total &#125;);<br>    &#125; <span class="hljs-keyword">catch</span> (error) &#123;<br>      requestError &amp;&amp; requestError(error);<br>    &#125;<br>  &#125;;<br><br>  <span class="hljs-comment">/**</span><br><span class="hljs-comment">   * <span class="hljs-doctag">@description </span>更新查询参数</span><br><span class="hljs-comment">   * <span class="hljs-doctag">@return <span class="hljs-variable">void</span></span></span><br><span class="hljs-comment">   * */</span><br>  <span class="hljs-keyword">const</span> updatedTotalParam = <span class="hljs-function">() =&gt;</span> &#123;<br>    state.totalParam = &#123;&#125;;<br>    <span class="hljs-comment">// 处理查询参数，可以给查询参数加自定义前缀操作</span><br>    <span class="hljs-keyword">let</span> nowSearchParam: &#123; [key: <span class="hljs-built_in">string</span>]: <span class="hljs-built_in">any</span> &#125; = &#123;&#125;;<br>    <span class="hljs-comment">// 防止手动清空输入框携带参数（这里可以自定义查询参数前缀）</span><br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> key <span class="hljs-keyword">in</span> state.searchParam) &#123;<br>      <span class="hljs-comment">// * 某些情况下参数为 false/0 也应该携带参数</span><br>      <span class="hljs-keyword">if</span> (<br>        state.searchParam[key] ||<br>        state.searchParam[key] === <span class="hljs-literal">false</span> ||<br>        state.searchParam[key] === <span class="hljs-number">0</span><br>      ) &#123;<br>        nowSearchParam[key] = state.searchParam[key];<br>      &#125;<br>    &#125;<br>    <span class="hljs-built_in">Object</span>.assign(<br>      state.totalParam,<br>      nowSearchParam,<br>      isPageable ? pageParam.value : &#123;&#125;<br>    );<br>  &#125;;<br><br>  <span class="hljs-comment">/**</span><br><span class="hljs-comment">   * <span class="hljs-doctag">@description </span>更新分页信息</span><br><span class="hljs-comment">   * <span class="hljs-doctag">@param <span class="hljs-type">&#123;Object&#125;</span> </span>resPageable 后台返回的分页数据</span><br><span class="hljs-comment">   * <span class="hljs-doctag">@return <span class="hljs-variable">void</span></span></span><br><span class="hljs-comment">   * */</span><br>  <span class="hljs-keyword">const</span> updatePageable = <span class="hljs-function">(<span class="hljs-params">resPageable: Table.Pageable</span>) =&gt;</span> &#123;<br>    <span class="hljs-built_in">Object</span>.assign(state.pageable, resPageable);<br>  &#125;;<br><br>  <span class="hljs-comment">/**</span><br><span class="hljs-comment">   * <span class="hljs-doctag">@description </span>表格数据查询</span><br><span class="hljs-comment">   * <span class="hljs-doctag">@return <span class="hljs-variable">void</span></span></span><br><span class="hljs-comment">   * */</span><br>  <span class="hljs-keyword">const</span> search = <span class="hljs-function">() =&gt;</span> &#123;<br>    state.pageable.pageNum = <span class="hljs-number">1</span>;<br>    updatedTotalParam();<br>    getTableList();<br>  &#125;;<br><br>  <span class="hljs-comment">/**</span><br><span class="hljs-comment">   * <span class="hljs-doctag">@description </span>表格数据重置</span><br><span class="hljs-comment">   * <span class="hljs-doctag">@return <span class="hljs-variable">void</span></span></span><br><span class="hljs-comment">   * */</span><br>  <span class="hljs-keyword">const</span> reset = <span class="hljs-function">() =&gt;</span> &#123;<br>    state.pageable.pageNum = <span class="hljs-number">1</span>;<br>    state.searchParam = &#123;&#125;;<br>    <span class="hljs-comment">// 重置搜索表单的时，如果有默认搜索参数，则重置默认的搜索参数</span><br>    <span class="hljs-built_in">Object</span>.keys(state.searchInitParam).forEach(<span class="hljs-function">(<span class="hljs-params">key</span>) =&gt;</span> &#123;<br>      state.searchParam[key] = state.searchInitParam[key];<br>    &#125;);<br>    updatedTotalParam();<br>    getTableList();<br>  &#125;;<br><br>  <span class="hljs-comment">/**</span><br><span class="hljs-comment">   * <span class="hljs-doctag">@description </span>每页条数改变</span><br><span class="hljs-comment">   * <span class="hljs-doctag">@param <span class="hljs-type">&#123;Number&#125;</span> </span>val 当前条数</span><br><span class="hljs-comment">   * <span class="hljs-doctag">@return <span class="hljs-variable">void</span></span></span><br><span class="hljs-comment">   * */</span><br>  <span class="hljs-keyword">const</span> handleSizeChange = <span class="hljs-function">(<span class="hljs-params">val: <span class="hljs-built_in">number</span></span>) =&gt;</span> &#123;<br>    state.pageable.pageNum = <span class="hljs-number">1</span>;<br>    state.pageable.pageSize = val;<br>    getTableList();<br>  &#125;;<br><br>  <span class="hljs-comment">/**</span><br><span class="hljs-comment">   * <span class="hljs-doctag">@description </span>当前页改变</span><br><span class="hljs-comment">   * <span class="hljs-doctag">@param <span class="hljs-type">&#123;Number&#125;</span> </span>val 当前页</span><br><span class="hljs-comment">   * <span class="hljs-doctag">@return <span class="hljs-variable">void</span></span></span><br><span class="hljs-comment">   * */</span><br>  <span class="hljs-keyword">const</span> handleCurrentChange = <span class="hljs-function">(<span class="hljs-params">val: <span class="hljs-built_in">number</span></span>) =&gt;</span> &#123;<br>    state.pageable.pageNum = val;<br>    getTableList();<br>  &#125;;<br><br>  <span class="hljs-keyword">return</span> &#123;<br>    ...toRefs(state),<br>    getTableList,<br>    search,<br>    reset,<br>    handleSizeChange,<br>    handleCurrentChange,<br>    updatedTotalParam,<br>  &#125;;<br>&#125;;<br></code></pre></td></tr></table></figure>

<p>2、useSelection</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">import</span> &#123; ref, computed &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;vue&quot;</span>;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@description </span>表格多选数据操作</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param <span class="hljs-type">&#123;String&#125;</span> </span>rowKey 当表格可以多选时，所指定的 id</span><br><span class="hljs-comment"> * */</span><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> useSelection = <span class="hljs-function">(<span class="hljs-params">rowKey: <span class="hljs-built_in">string</span> = <span class="hljs-string">&quot;id&quot;</span></span>) =&gt;</span> &#123;<br>  <span class="hljs-keyword">const</span> isSelected = ref&lt;<span class="hljs-built_in">boolean</span>&gt;(<span class="hljs-literal">false</span>);<br>  <span class="hljs-keyword">const</span> selectedList = ref&lt;&#123; [key: <span class="hljs-built_in">string</span>]: <span class="hljs-built_in">any</span> &#125;[]&gt;([]);<br><br>  <span class="hljs-comment">// 当前选中的所有 ids 数组</span><br>  <span class="hljs-keyword">const</span> selectedListIds = computed((): <span class="hljs-built_in">string</span>[] =&gt; &#123;<br>    <span class="hljs-keyword">let</span> ids: <span class="hljs-built_in">string</span>[] = [];<br>    selectedList.value.forEach(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> ids.push(item[rowKey]));<br>    <span class="hljs-keyword">return</span> ids;<br>  &#125;);<br><br>  <span class="hljs-comment">/**</span><br><span class="hljs-comment">   * <span class="hljs-doctag">@description </span>多选操作</span><br><span class="hljs-comment">   * <span class="hljs-doctag">@param <span class="hljs-type">&#123;Array&#125;</span> </span>rowArr 当前选择的所有数据</span><br><span class="hljs-comment">   * <span class="hljs-doctag">@return <span class="hljs-variable">void</span></span></span><br><span class="hljs-comment">   */</span><br>  <span class="hljs-keyword">const</span> selectionChange = <span class="hljs-function">(<span class="hljs-params">rowArr: &#123; [key: <span class="hljs-built_in">string</span>]: <span class="hljs-built_in">any</span> &#125;[]</span>) =&gt;</span> &#123;<br>    rowArr.length ? (isSelected.value = <span class="hljs-literal">true</span>) : (isSelected.value = <span class="hljs-literal">false</span>);<br>    selectedList.value = rowArr;<br>  &#125;;<br><br>  <span class="hljs-keyword">return</span> &#123;<br>    isSelected,<br>    selectedList,<br>    selectedListIds,<br>    selectionChange,<br>  &#125;;<br>&#125;;<br></code></pre></td></tr></table></figure>

<p>3、useDownload</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">import</span> &#123; ElNotification &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;element-plus&quot;</span>;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@description </span>接收数据流生成 blob，创建链接，下载文件</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param <span class="hljs-type">&#123;Function&#125;</span> </span>api 导出表格的api方法 (必传)</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param <span class="hljs-type">&#123;String&#125;</span> </span>tempName 导出的文件名 (必传)</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param <span class="hljs-type">&#123;Object&#125;</span> </span>params 导出的参数 (默认&#123;&#125;)</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param <span class="hljs-type">&#123;Boolean&#125;</span> </span>isNotify 是否有导出消息提示 (默认为 true)</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param <span class="hljs-type">&#123;String&#125;</span> </span>fileType 导出的文件格式 (默认为.xlsx)</span><br><span class="hljs-comment"> * */</span><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> useDownload = <span class="hljs-keyword">async</span> (<br>  api: <span class="hljs-function">(<span class="hljs-params">param: <span class="hljs-built_in">any</span></span>) =&gt;</span> <span class="hljs-built_in">Promise</span>&lt;<span class="hljs-built_in">any</span>&gt;,<br>  tempName: <span class="hljs-built_in">string</span>,<br>  <span class="hljs-attr">params</span>: <span class="hljs-built_in">any</span> = &#123;&#125;,<br>  <span class="hljs-attr">isNotify</span>: <span class="hljs-built_in">boolean</span> = <span class="hljs-literal">true</span>,<br>  <span class="hljs-attr">fileType</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">&quot;.xlsx&quot;</span><br>) =&gt; &#123;<br>  <span class="hljs-keyword">if</span> (isNotify) &#123;<br>    ElNotification(&#123;<br>      <span class="hljs-attr">title</span>: <span class="hljs-string">&quot;温馨提示&quot;</span>,<br>      <span class="hljs-attr">message</span>: <span class="hljs-string">&quot;如果数据庞大会导致下载缓慢哦，请您耐心等待！&quot;</span>,<br>      <span class="hljs-attr">type</span>: <span class="hljs-string">&quot;info&quot;</span>,<br>      <span class="hljs-attr">duration</span>: <span class="hljs-number">3000</span>,<br>    &#125;);<br>  &#125;<br>  <span class="hljs-keyword">try</span> &#123;<br>    <span class="hljs-keyword">const</span> res = <span class="hljs-keyword">await</span> api(params);<br>    <span class="hljs-keyword">const</span> blob = <span class="hljs-keyword">new</span> Blob([res]);<br>    <span class="hljs-comment">// 兼容 edge 不支持 createObjectURL 方法</span><br>    <span class="hljs-keyword">if</span> (<span class="hljs-string">&quot;msSaveOrOpenBlob&quot;</span> <span class="hljs-keyword">in</span> navigator)<br>      <span class="hljs-keyword">return</span> <span class="hljs-built_in">window</span>.navigator.msSaveOrOpenBlob(blob, tempName + fileType);<br>    <span class="hljs-keyword">const</span> blobUrl = <span class="hljs-built_in">window</span>.URL.createObjectURL(blob);<br>    <span class="hljs-keyword">const</span> exportFile = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">&quot;a&quot;</span>);<br>    exportFile.style.display = <span class="hljs-string">&quot;none&quot;</span>;<br>    exportFile.download = <span class="hljs-string">`<span class="hljs-subst">$&#123;tempName&#125;</span><span class="hljs-subst">$&#123;fileType&#125;</span>`</span>;<br>    exportFile.href = blobUrl;<br>    <span class="hljs-built_in">document</span>.body.appendChild(exportFile);<br>    exportFile.click();<br>    <span class="hljs-comment">// 去除下载对 url 的影响</span><br>    <span class="hljs-built_in">document</span>.body.removeChild(exportFile);<br>    <span class="hljs-built_in">window</span>.URL.revokeObjectURL(blobUrl);<br>  &#125; <span class="hljs-keyword">catch</span> (error) &#123;<br>    <span class="hljs-built_in">console</span>.log(error);<br>  &#125;<br>&#125;;<br></code></pre></td></tr></table></figure>

<p>4、useHandledata</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">import</span> &#123; ElMessageBox, ElMessage &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;element-plus&quot;</span>;<br><span class="hljs-keyword">import</span> &#123; HandleData &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;./interface&quot;</span>;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@description </span>操作单条数据信息 (二次确认【删除、禁用、启用、重置密码】)</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param <span class="hljs-type">&#123;Function&#125;</span> </span>api 操作数据接口的api方法 (必传)</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param <span class="hljs-type">&#123;Object&#125;</span> </span>params 携带的操作数据参数 &#123;id,params&#125; (必传)</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param <span class="hljs-type">&#123;String&#125;</span> </span>message 提示信息 (必传)</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param <span class="hljs-type">&#123;String&#125;</span> </span>confirmType icon类型 (不必传,默认为 warning)</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@returns <span class="hljs-type">&#123;Promise&#125;</span></span></span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> useHandleData = <span class="hljs-function">(<span class="hljs-params"></span></span><br><span class="hljs-params"><span class="hljs-function">  api: (params: <span class="hljs-built_in">any</span>) =&gt; <span class="hljs-built_in">Promise</span>&lt;<span class="hljs-built_in">any</span>&gt;,</span></span><br><span class="hljs-params"><span class="hljs-function">  params: <span class="hljs-built_in">any</span> = &#123;&#125;,</span></span><br><span class="hljs-params"><span class="hljs-function">  message: <span class="hljs-built_in">string</span>,</span></span><br><span class="hljs-params"><span class="hljs-function">  confirmType: HandleData.MessageType = <span class="hljs-string">&quot;warning&quot;</span></span></span><br><span class="hljs-params"><span class="hljs-function"></span>) =&gt;</span> &#123;<br>  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> &#123;<br>    ElMessageBox.confirm(<span class="hljs-string">`是否<span class="hljs-subst">$&#123;message&#125;</span>?`</span>, <span class="hljs-string">&quot;温馨提示&quot;</span>, &#123;<br>      <span class="hljs-attr">confirmButtonText</span>: <span class="hljs-string">&quot;确定&quot;</span>,<br>      <span class="hljs-attr">cancelButtonText</span>: <span class="hljs-string">&quot;取消&quot;</span>,<br>      <span class="hljs-attr">type</span>: confirmType,<br>      <span class="hljs-attr">draggable</span>: <span class="hljs-literal">true</span>,<br>    &#125;).then(<span class="hljs-keyword">async</span> () =&gt; &#123;<br>      <span class="hljs-keyword">const</span> res = <span class="hljs-keyword">await</span> api(params);<br>      <span class="hljs-keyword">if</span> (!res) <span class="hljs-keyword">return</span> reject(<span class="hljs-literal">false</span>);<br>      ElMessage(&#123;<br>        <span class="hljs-attr">type</span>: <span class="hljs-string">&quot;success&quot;</span>,<br>        <span class="hljs-attr">message</span>: <span class="hljs-string">`<span class="hljs-subst">$&#123;message&#125;</span>成功!`</span>,<br>      &#125;);<br>      resolve(<span class="hljs-literal">true</span>);<br>    &#125;);<br>  &#125;);<br>&#125;;<br></code></pre></td></tr></table></figure>

<h2 id="四、ProTable-组件部分代码"><a href="#四、ProTable-组件部分代码" class="headerlink" title="四、ProTable 组件部分代码"></a>四、ProTable 组件部分代码</h2><h4 id="ProTable-vue"><a href="#ProTable-vue" class="headerlink" title="ProTable.vue"></a>ProTable.vue</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;template&gt;<br>  &lt;!-- 查询表单 card --&gt;<br>  &lt;SearchForm<br>    :search=&quot;search&quot;<br>    :reset=&quot;reset&quot;<br>    :columns=&quot;searchColumns&quot;<br>    :search-param=&quot;searchParam&quot;<br>    :search-col=&quot;searchCol&quot;<br>    v-show=&quot;isShowSearch&quot;<br>  /&gt;<br><br>  &lt;!-- 表格内容 card --&gt;<br>  &lt;div class=&quot;card table-main&quot;&gt;<br>    &lt;!-- 表格头部 操作按钮 --&gt;<br>    &lt;div class=&quot;table-header&quot;&gt;<br>      &lt;div class=&quot;header-button-lf&quot;&gt;<br>        &lt;slot<br>          name=&quot;tableHeader&quot;<br>          :selectedListIds=&quot;selectedListIds&quot;<br>          :selectedList=&quot;selectedList&quot;<br>          :isSelected=&quot;isSelected&quot;<br>        /&gt;<br>      &lt;/div&gt;<br>      &lt;div class=&quot;header-button-ri&quot; v-if=&quot;toolButton&quot;&gt;<br>        &lt;slot name=&quot;toolButton&quot;&gt;<br>          &lt;el-button :icon=&quot;Refresh&quot; circle @click=&quot;getTableList&quot; /&gt;<br>          &lt;el-button<br>            :icon=&quot;Printer&quot;<br>            circle<br>            v-if=&quot;columns.length&quot;<br>            @click=&quot;print&quot;<br>          /&gt;<br>          &lt;el-button<br>            :icon=&quot;Operation&quot;<br>            circle<br>            v-if=&quot;columns.length&quot;<br>            @click=&quot;openColSetting&quot;<br>          /&gt;<br>          &lt;el-button<br>            :icon=&quot;Search&quot;<br>            circle<br>            v-if=&quot;searchColumns.length&quot;<br>            @click=&quot;isShowSearch = !isShowSearch&quot;<br>          /&gt;<br>        &lt;/slot&gt;<br>      &lt;/div&gt;<br>    &lt;/div&gt;<br>    &lt;!-- 表格主体 --&gt;<br>    &lt;el-table<br>      ref=&quot;tableRef&quot;<br>      v-bind=&quot;$attrs&quot;<br>      :data=&quot;data ?? tableData&quot;<br>      :border=&quot;border&quot;<br>      :row-key=&quot;rowKey&quot;<br>      @selection-change=&quot;selectionChange&quot;<br>    &gt;<br>      &lt;!-- 默认插槽 --&gt;<br>      &lt;slot&gt;&lt;/slot&gt;<br>      &lt;template v-for=&quot;item in tableColumns&quot; :key=&quot;item&quot;&gt;<br>        &lt;!-- selection || index || expand --&gt;<br>        &lt;el-table-column<br>          v-bind=&quot;item&quot;<br>          :align=&quot;item.align ?? &#x27;center&#x27;&quot;<br>          :reserve-selection=&quot;item.type == &#x27;selection&#x27;&quot;<br>          v-if=&quot;<br>            item.type &amp;&amp; [&#x27;selection&#x27;, &#x27;index&#x27;, &#x27;expand&#x27;].includes(item.type)<br>          &quot;<br>        &gt;<br>          &lt;template #default=&quot;scope&quot; v-if=&quot;item.type == &#x27;expand&#x27;&quot;&gt;<br>            &lt;component :is=&quot;item.render&quot; v-bind=&quot;scope&quot; v-if=&quot;item.render&quot;&gt;<br>            &lt;/component&gt;<br>            &lt;slot :name=&quot;item.type&quot; v-bind=&quot;scope&quot; v-else&gt;&lt;/slot&gt;<br>          &lt;/template&gt;<br>        &lt;/el-table-column&gt;<br>        &lt;!-- other --&gt;<br>        &lt;TableColumn<br>          v-if=&quot;!item.type &amp;&amp; item.prop &amp;&amp; item.isShow&quot;<br>          :column=&quot;item&quot;<br>        &gt;<br>          &lt;template v-for=&quot;slot in Object.keys($slots)&quot; #[slot]=&quot;scope&quot;&gt;<br>            &lt;slot :name=&quot;slot&quot; v-bind=&quot;scope&quot;&gt;&lt;/slot&gt;<br>          &lt;/template&gt;<br>        &lt;/TableColumn&gt;<br>      &lt;/template&gt;<br>      &lt;!-- 插入表格最后一行之后的插槽 --&gt;<br>      &lt;template #append&gt;<br>        &lt;slot name=&quot;append&quot;&gt; &lt;/slot&gt;<br>      &lt;/template&gt;<br>      &lt;!-- 无数据 --&gt;<br>      &lt;template #empty&gt;<br>        &lt;div class=&quot;table-empty&quot;&gt;<br>          &lt;slot name=&quot;empty&quot;&gt;<br>            &lt;img src=&quot;@/assets/images/notData.png&quot; alt=&quot;notData&quot; /&gt;<br>            &lt;div&gt;暂无数据&lt;/div&gt;<br>          &lt;/slot&gt;<br>        &lt;/div&gt;<br>      &lt;/template&gt;<br>    &lt;/el-table&gt;<br>    &lt;!-- 分页组件 --&gt;<br>    &lt;slot name=&quot;pagination&quot;&gt;<br>      &lt;Pagination<br>        v-if=&quot;pagination&quot;<br>        :pageable=&quot;pageable&quot;<br>        :handle-size-change=&quot;handleSizeChange&quot;<br>        :handle-current-change=&quot;handleCurrentChange&quot;<br>      /&gt;<br>    &lt;/slot&gt;<br>  &lt;/div&gt;<br>  &lt;!-- 列设置 --&gt;<br>  &lt;ColSetting v-if=&quot;toolButton&quot; ref=&quot;colRef&quot; v-model:col-setting=&quot;colSetting&quot; /&gt;<br>&lt;/template&gt;<br><br>&lt;script setup lang=&quot;ts&quot; name=&quot;ProTable&quot;&gt;<br>import &#123; ref, watch, computed, provide, onMounted &#125; from &quot;vue&quot;;<br>import &#123; ElTable &#125; from &quot;element-plus&quot;;<br>import &#123; useTable &#125; from &quot;@/hooks/useTable&quot;;<br>import &#123; useSelection &#125; from &quot;@/hooks/useSelection&quot;;<br>import &#123; BreakPoint &#125; from &quot;@/components/Grid/interface&quot;;<br>import &#123; ColumnProps &#125; from &quot;@/components/ProTable/interface&quot;;<br>import &#123; Refresh, Printer, Operation, Search &#125; from &quot;@element-plus/icons-vue&quot;;<br>import &#123;<br>  filterEnum,<br>  formatValue,<br>  handleProp,<br>  handleRowAccordingToProp,<br>&#125; from &quot;@/utils&quot;;<br>import SearchForm from &quot;@/components/SearchForm/index.vue&quot;;<br>import Pagination from &quot;./components/Pagination.vue&quot;;<br>import ColSetting from &quot;./components/ColSetting.vue&quot;;<br>import TableColumn from &quot;./components/TableColumn.vue&quot;;<br>import printJS from &quot;print-js&quot;;<br><br>export interface ProTableProps &#123;<br>  columns: ColumnProps[]; // 列配置项  ==&gt; 必传<br>  data?: any[]; // 静态 table data 数据，若存在则不会使用 requestApi 返回的 data ==&gt; 非必传<br>  requestApi?: (params: any) =&gt; Promise&lt;any&gt;; // 请求表格数据的 api ==&gt; 非必传<br>  requestAuto?: boolean; // 是否自动执行请求 api ==&gt; 非必传（默认为true）<br>  requestError?: (params: any) =&gt; void; // 表格 api 请求错误监听 ==&gt; 非必传<br>  dataCallback?: (data: any) =&gt; any; // 返回数据的回调函数，可以对数据进行处理 ==&gt; 非必传<br>  title?: string; // 表格标题，目前只在打印的时候用到 ==&gt; 非必传<br>  pagination?: boolean; // 是否需要分页组件 ==&gt; 非必传（默认为true）<br>  initParam?: any; // 初始化请求参数 ==&gt; 非必传（默认为&#123;&#125;）<br>  border?: boolean; // 是否带有纵向边框 ==&gt; 非必传（默认为true）<br>  toolButton?: boolean; // 是否显示表格功能按钮 ==&gt; 非必传（默认为true）<br>  rowKey?: string; // 行数据的 Key，用来优化 Table 的渲染，当表格数据多选时，所指定的 id ==&gt; 非必传（默认为 id）<br>  searchCol?: number | Record&lt;BreakPoint, number&gt;; // 表格搜索项 每列占比配置 ==&gt; 非必传 &#123; xs: 1, sm: 2, md: 2, lg: 3, xl: 4 &#125;<br>&#125;<br><br>// 接受父组件参数，配置默认值<br>const props = withDefaults(defineProps&lt;ProTableProps&gt;(), &#123;<br>  columns: () =&gt; [],<br>  requestAuto: true,<br>  pagination: true,<br>  initParam: &#123;&#125;,<br>  border: true,<br>  toolButton: true,<br>  rowKey: &quot;id&quot;,<br>  searchCol: () =&gt; (&#123; xs: 1, sm: 2, md: 2, lg: 3, xl: 4 &#125;),<br>&#125;);<br><br>// 是否显示搜索模块<br>const isShowSearch = ref(true);<br><br>// 表格 DOM 元素<br>const tableRef = ref&lt;InstanceType&lt;typeof ElTable&gt;&gt;();<br><br>// 表格多选 Hooks<br>const &#123; selectionChange, selectedList, selectedListIds, isSelected &#125; =<br>  useSelection(props.rowKey);<br><br>// 表格操作 Hooks<br>const &#123;<br>  tableData,<br>  pageable,<br>  searchParam,<br>  searchInitParam,<br>  getTableList,<br>  search,<br>  reset,<br>  handleSizeChange,<br>  handleCurrentChange,<br>&#125; = useTable(<br>  props.requestApi,<br>  props.initParam,<br>  props.pagination,<br>  props.dataCallback,<br>  props.requestError<br>);<br><br>// 清空选中数据列表<br>const clearSelection = () =&gt; tableRef.value!.clearSelection();<br><br>// 初始化请求<br>onMounted(() =&gt; props.requestAuto &amp;&amp; getTableList());<br><br>// 监听页面 initParam 改化，重新获取表格数据<br>watch(() =&gt; props.initParam, getTableList, &#123; deep: true &#125;);<br><br>// 接收 columns 并设置为响应式<br>const tableColumns = ref&lt;ColumnProps[]&gt;(props.columns);<br><br>// 定义 enumMap 存储 enum 值（避免异步请求无法格式化单元格内容 || 无法填充搜索下拉选择）<br>const enumMap = ref(new Map&lt;string, &#123; [key: string]: any &#125;[]&gt;());<br>provide(&quot;enumMap&quot;, enumMap);<br>const setEnumMap = async (col: ColumnProps) =&gt; &#123;<br>  if (!col.enum) return;<br>  // 如果当前 enum 为后台数据需要请求数据，则调用该请求接口，并存储到 enumMap<br>  if (typeof col.enum !== &quot;function&quot;)<br>    return enumMap.value.set(col.prop!, col.enum!);<br>  const &#123; data &#125; = await col.enum();<br>  enumMap.value.set(col.prop!, data);<br>&#125;;<br><br>// 扁平化 columns<br>const flatColumnsFunc = (<br>  columns: ColumnProps[],<br>  flatArr: ColumnProps[] = []<br>) =&gt; &#123;<br>  columns.forEach(async (col) =&gt; &#123;<br>    if (col._children?.length) flatArr.push(...flatColumnsFunc(col._children));<br>    flatArr.push(col);<br><br>    // 给每一项 column 添加 isShow &amp;&amp; isFilterEnum 默认属性<br>    col.isShow = col.isShow ?? true;<br>    col.isFilterEnum = col.isFilterEnum ?? true;<br><br>    // 设置 enumMap<br>    setEnumMap(col);<br>  &#125;);<br>  return flatArr.filter((item) =&gt; !item._children?.length);<br>&#125;;<br><br>// flatColumns<br>const flatColumns = ref&lt;ColumnProps[]&gt;();<br>flatColumns.value = flatColumnsFunc(tableColumns.value);<br><br>// 过滤需要搜索的配置项<br>const searchColumns = flatColumns.value.filter(<br>  (item) =&gt; item.search?.el || item.search?.render<br>);<br><br>// 设置搜索表单排序默认值 &amp;&amp; 设置搜索表单项的默认值<br>searchColumns.forEach((column, index) =&gt; &#123;<br>  column.search!.order = column.search!.order ?? index + 2;<br>  if (<br>    column.search?.defaultValue !== undefined &amp;&amp;<br>    column.search?.defaultValue !== null<br>  ) &#123;<br>    searchInitParam.value[column.search.key ?? handleProp(column.prop!)] =<br>      column.search?.defaultValue;<br>    searchParam.value[column.search.key ?? handleProp(column.prop!)] =<br>      column.search?.defaultValue;<br>  &#125;<br>&#125;);<br><br>// 排序搜索表单项<br>searchColumns.sort((a, b) =&gt; a.search!.order! - b.search!.order!);<br><br>// 列设置 ==&gt; 过滤掉不需要设置的列<br>const colRef = ref();<br>const colSetting = tableColumns.value!.filter(<br>  (item) =&gt;<br>    ![&quot;selection&quot;, &quot;index&quot;, &quot;expand&quot;].includes(item.type!) &amp;&amp;<br>    item.prop !== &quot;operation&quot; &amp;&amp;<br>    item.isShow<br>);<br>const openColSetting = () =&gt; colRef.value.openColSetting();<br><br>// 🙅‍♀️ 不需要打印可以把以下方法删除，打印功能目前存在很多 bug<br>// 处理打印数据（把后台返回的值根据 enum 做转换）<br>const printData = computed(() =&gt; &#123;<br>  const handleData = props.data ?? tableData.value;<br>  const printDataList = JSON.parse(<br>    JSON.stringify(selectedList.value.length ? selectedList.value : handleData)<br>  );<br>  // 找出需要转换数据的列（有 enum || 多级 prop &amp;&amp; 需要根据 enum 格式化）<br>  const needTransformCol = flatColumns.value!.filter(<br>    (item) =&gt;<br>      (item.enum || (item.prop &amp;&amp; item.prop.split(&quot;.&quot;).length &gt; 1)) &amp;&amp;<br>      item.isFilterEnum<br>  );<br>  needTransformCol.forEach((colItem) =&gt; &#123;<br>    printDataList.forEach((tableItem: &#123; [key: string]: any &#125;) =&gt; &#123;<br>      tableItem[handleProp(colItem.prop!)] =<br>        colItem.prop!.split(&quot;.&quot;).length &gt; 1 &amp;&amp; !colItem.enum<br>          ? formatValue(handleRowAccordingToProp(tableItem, colItem.prop!))<br>          : filterEnum(<br>              handleRowAccordingToProp(tableItem, colItem.prop!),<br>              enumMap.value.get(colItem.prop!),<br>              colItem.fieldNames<br>            );<br>      for (const key in tableItem) &#123;<br>        if (tableItem[key] === null)<br>          tableItem[key] = formatValue(tableItem[key]);<br>      &#125;<br>    &#125;);<br>  &#125;);<br>  return printDataList;<br>&#125;);<br><br>// 打印表格数据（💥 多级表头数据打印时，只能扁平化成一维数组，printJs 不支持多级表头打印）<br>const print = () =&gt; &#123;<br>  const header = `&lt;div style=&quot;text-align: center&quot;&gt;&lt;h2&gt;$&#123;props.title&#125;&lt;/h2&gt;&lt;/div&gt;`;<br>  const gridHeaderStyle =<br>    &quot;border: 1px solid #ebeef5;height: 45px;color: #232425;text-align: center;background-color: #fafafa;&quot;;<br>  const gridStyle =<br>    &quot;border: 1px solid #ebeef5;height: 40px;color: #494b4e;text-align: center&quot;;<br>  printJS(&#123;<br>    printable: printData.value,<br>    header: props.title &amp;&amp; header,<br>    properties: flatColumns<br>      .value!.filter(<br>        (item) =&gt;<br>          ![&quot;selection&quot;, &quot;index&quot;, &quot;expand&quot;].includes(item.type!) &amp;&amp;<br>          item.isShow &amp;&amp;<br>          item.prop !== &quot;operation&quot;<br>      )<br>      .map((item: ColumnProps) =&gt; (&#123;<br>        field: handleProp(item.prop!),<br>        displayName: item.label,<br>      &#125;)),<br>    type: &quot;json&quot;,<br>    gridHeaderStyle,<br>    gridStyle,<br>  &#125;);<br>&#125;;<br><br>// 暴露给父组件的参数和方法(外部需要什么，都可以从这里暴露出去)<br>defineExpose(&#123;<br>  element: tableRef,<br>  tableData,<br>  pageable,<br>  searchParam,<br>  searchInitParam,<br>  getTableList,<br>  search,<br>  reset,<br>  handleSizeChange,<br>  handleCurrentChange,<br>  clearSelection,<br>  enumMap,<br>  isSelected,<br>  selectedList,<br>  selectedListIds,<br>&#125;);<br>&lt;/script&gt;<br></code></pre></td></tr></table></figure>

<h4 id="TableColumn-vue"><a href="#TableColumn-vue" class="headerlink" title="TableColumn.vue"></a>TableColumn.vue</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;template&gt;<br>  &lt;RenderTableColumn v-bind=&quot;column&quot; /&gt;<br>&lt;/template&gt;<br><br>&lt;script setup lang=&quot;tsx&quot; name=&quot;TableColumn&quot;&gt;<br>import &#123; inject, ref, useSlots &#125; from &quot;vue&quot;;<br>import &#123;<br>  ColumnProps,<br>  RenderScope,<br>  HeaderRenderScope,<br>&#125; from &quot;@/components/ProTable/interface&quot;;<br>import &#123;<br>  filterEnum,<br>  formatValue,<br>  handleProp,<br>  handleRowAccordingToProp,<br>&#125; from &quot;@/utils&quot;;<br><br>defineProps&lt;&#123; column: ColumnProps &#125;&gt;();<br><br>const slots = useSlots();<br><br>const enumMap = inject(&quot;enumMap&quot;, ref(new Map()));<br><br>// 渲染表格数据<br>const renderCellData = (item: ColumnProps, scope: RenderScope&lt;any&gt;) =&gt; &#123;<br>  return enumMap.value.get(item.prop) &amp;&amp; item.isFilterEnum<br>    ? filterEnum(<br>        handleRowAccordingToProp(scope.row, item.prop!),<br>        enumMap.value.get(item.prop)!,<br>        item.fieldNames<br>      )<br>    : formatValue(handleRowAccordingToProp(scope.row, item.prop!));<br>&#125;;<br><br>// 获取 tag 类型<br>const getTagType = (item: ColumnProps, scope: RenderScope&lt;any&gt;) =&gt; &#123;<br>  return filterEnum(<br>    handleRowAccordingToProp(scope.row, item.prop!),<br>    enumMap.value.get(item.prop),<br>    item.fieldNames,<br>    &quot;tag&quot;<br>  );<br>&#125;;<br><br>const RenderTableColumn = (item: ColumnProps) =&gt; &#123;<br>  return (<br>    &lt;&gt;<br>      &#123;item.isShow &amp;&amp; (<br>        &lt;el-table-column<br>          &#123;...item&#125;<br>          align=&#123;item.align ?? &quot;center&quot;&#125;<br>          showOverflowTooltip=&#123;<br>            item.showOverflowTooltip ?? item.prop !== &quot;operation&quot;<br>          &#125;<br>        &gt;<br>          &#123;&#123;<br>            default: (scope: RenderScope&lt;any&gt;) =&gt; &#123;<br>              if (item._children)<br>                return item._children.map((child) =&gt; RenderTableColumn(child));<br>              if (item.render) return item.render(scope);<br>              if (slots[handleProp(item.prop!)])<br>                return slots[handleProp(item.prop!)]!(scope);<br>              if (item.tag)<br>                return (<br>                  &lt;el-tag type=&#123;getTagType(item, scope)&#125;&gt;<br>                    &#123;renderCellData(item, scope)&#125;<br>                  &lt;/el-tag&gt;<br>                );<br>              return renderCellData(item, scope);<br>            &#125;,<br>            header: (scope: HeaderRenderScope&lt;any&gt;) =&gt; &#123;<br>              if (item.headerRender) return item.headerRender(scope);<br>              if (slots[`$&#123;handleProp(item.prop!)&#125;Header`])<br>                return slots[`$&#123;handleProp(item.prop!)&#125;Header`]!(scope);<br>              return item.label;<br>            &#125;,<br>          &#125;&#125;<br>        &lt;/el-table-column&gt;<br>      )&#125;<br>    &lt;/&gt;<br>  );<br>&#125;;<br>&lt;/script&gt;<br></code></pre></td></tr></table></figure>

<h4 id="使用-ProTable-组件"><a href="#使用-ProTable-组件" class="headerlink" title="使用 ProTable 组件"></a>使用 ProTable 组件</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;template&gt;<br>  &lt;div class=&quot;table-box&quot;&gt;<br>    &lt;ProTable<br>      ref=&quot;proTable&quot;<br>      title=&quot;用户列表&quot;<br>      :columns=&quot;columns&quot;<br>      :request-api=&quot;getTableList&quot;<br>      :init-param=&quot;initParam&quot;<br>      :data-callback=&quot;dataCallback&quot;<br>    &gt;<br>      &lt;!-- 表格 header 按钮 --&gt;<br>      &lt;template #tableHeader=&quot;scope&quot;&gt;<br>        &lt;el-button<br>          type=&quot;primary&quot;<br>          :icon=&quot;CirclePlus&quot;<br>          @click=&quot;openDrawer(&#x27;新增&#x27;)&quot;<br>          v-auth=&quot;&#x27;add&#x27;&quot;<br>          &gt;新增用户&lt;/el-button<br>        &gt;<br>        &lt;el-button<br>          type=&quot;primary&quot;<br>          :icon=&quot;Upload&quot;<br>          plain<br>          @click=&quot;batchAdd&quot;<br>          v-auth=&quot;&#x27;batchAdd&#x27;&quot;<br>          &gt;批量添加用户&lt;/el-button<br>        &gt;<br>        &lt;el-button<br>          type=&quot;primary&quot;<br>          :icon=&quot;Download&quot;<br>          plain<br>          @click=&quot;downloadFile&quot;<br>          v-auth=&quot;&#x27;export&#x27;&quot;<br>          &gt;导出用户数据&lt;/el-button<br>        &gt;<br>        &lt;el-button type=&quot;primary&quot; plain @click=&quot;toDetail&quot;<br>          &gt;To 子集详情页面&lt;/el-button<br>        &gt;<br>        &lt;el-button<br>          type=&quot;danger&quot;<br>          :icon=&quot;Delete&quot;<br>          plain<br>          @click=&quot;batchDelete(scope.selectedListIds)&quot;<br>          :disabled=&quot;!scope.isSelected&quot;<br>        &gt;<br>          批量删除用户<br>        &lt;/el-button&gt;<br>      &lt;/template&gt;<br>      &lt;!-- Expand --&gt;<br>      &lt;template #expand=&quot;scope&quot;&gt;<br>        &#123;&#123; scope.row &#125;&#125;<br>      &lt;/template&gt;<br>      &lt;!-- usernameHeader --&gt;<br>      &lt;template #usernameHeader=&quot;scope&quot;&gt;<br>        &lt;el-button<br>          type=&quot;primary&quot;<br>          @click=&quot;ElMessage.success(&#x27;我是通过作用域插槽渲染的表头&#x27;)&quot;<br>        &gt;<br>          &#123;&#123; scope.column.label &#125;&#125;<br>        &lt;/el-button&gt;<br>      &lt;/template&gt;<br>      &lt;!-- createTime --&gt;<br>      &lt;template #createTime=&quot;scope&quot;&gt;<br>        &lt;el-button<br>          type=&quot;primary&quot;<br>          link<br>          @click=&quot;ElMessage.success(&#x27;我是通过作用域插槽渲染的内容&#x27;)&quot;<br>        &gt;<br>          &#123;&#123; scope.row.createTime &#125;&#125;<br>        &lt;/el-button&gt;<br>      &lt;/template&gt;<br>      &lt;!-- 表格操作 --&gt;<br>      &lt;template #operation=&quot;scope&quot;&gt;<br>        &lt;el-button<br>          type=&quot;primary&quot;<br>          link<br>          :icon=&quot;View&quot;<br>          @click=&quot;openDrawer(&#x27;查看&#x27;, scope.row)&quot;<br>          &gt;查看&lt;/el-button<br>        &gt;<br>        &lt;el-button<br>          type=&quot;primary&quot;<br>          link<br>          :icon=&quot;EditPen&quot;<br>          @click=&quot;openDrawer(&#x27;编辑&#x27;, scope.row)&quot;<br>          &gt;编辑&lt;/el-button<br>        &gt;<br>        &lt;el-button<br>          type=&quot;primary&quot;<br>          link<br>          :icon=&quot;Refresh&quot;<br>          @click=&quot;resetPass(scope.row)&quot;<br>          &gt;重置密码&lt;/el-button<br>        &gt;<br>        &lt;el-button<br>          type=&quot;primary&quot;<br>          link<br>          :icon=&quot;Delete&quot;<br>          @click=&quot;deleteAccount(scope.row)&quot;<br>          &gt;删除&lt;/el-button<br>        &gt;<br>      &lt;/template&gt;<br>    &lt;/ProTable&gt;<br>    &lt;UserDrawer ref=&quot;drawerRef&quot; /&gt;<br>    &lt;ImportExcel ref=&quot;dialogRef&quot; /&gt;<br>  &lt;/div&gt;<br>&lt;/template&gt;<br><br>&lt;script setup lang=&quot;tsx&quot; name=&quot;useProTable&quot;&gt;<br>import &#123; ref, reactive &#125; from &quot;vue&quot;;<br>import &#123; useRouter &#125; from &quot;vue-router&quot;;<br>import &#123; User &#125; from &quot;@/api/interface&quot;;<br>import &#123; useHandleData &#125; from &quot;@/hooks/useHandleData&quot;;<br>import &#123; useDownload &#125; from &quot;@/hooks/useDownload&quot;;<br>import &#123; useAuthButtons &#125; from &quot;@/hooks/useAuthButtons&quot;;<br>import &#123; ElMessage, ElMessageBox &#125; from &quot;element-plus&quot;;<br>import ProTable from &quot;@/components/ProTable/index.vue&quot;;<br>import ImportExcel from &quot;@/components/ImportExcel/index.vue&quot;;<br>import UserDrawer from &quot;@/views/proTable/components/UserDrawer.vue&quot;;<br>import &#123;<br>  ProTableInstance,<br>  ColumnProps,<br>  HeaderRenderScope,<br>&#125; from &quot;@/components/ProTable/interface&quot;;<br>import &#123;<br>  CirclePlus,<br>  Delete,<br>  EditPen,<br>  Download,<br>  Upload,<br>  View,<br>  Refresh,<br>&#125; from &quot;@element-plus/icons-vue&quot;;<br>import &#123;<br>  getUserList,<br>  deleteUser,<br>  editUser,<br>  addUser,<br>  changeUserStatus,<br>  resetUserPassWord,<br>  exportUserInfo,<br>  BatchAddUser,<br>  getUserStatus,<br>  getUserGender,<br>&#125; from &quot;@/api/modules/user&quot;;<br><br>const router = useRouter();<br><br>// 跳转详情页<br>const toDetail = () =&gt; &#123;<br>  router.push(<br>    `/proTable/useProTable/detail/$&#123;Math.random().toFixed(<br>      3<br>    )&#125;?params=detail-page`<br>  );<br>&#125;;<br><br>// 获取 ProTable 元素，调用其获取刷新数据方法（还能获取到当前查询参数，方便导出携带参数）<br>const proTable = ref&lt;ProTableInstance&gt;();<br><br>// 如果表格需要初始化请求参数，直接定义传给 ProTable(之后每次请求都会自动带上该参数，此参数更改之后也会一直带上，改变此参数会自动刷新表格数据)<br>const initParam = reactive(&#123; type: 1 &#125;);<br><br>// dataCallback 是对于返回的表格数据做处理，如果你后台返回的数据不是 list &amp;&amp; total &amp;&amp; pageNum &amp;&amp; pageSize 这些字段，那么你可以在这里进行处理成这些字段<br>// 或者直接去 hooks/useTable.ts 文件中把字段改为你后端对应的就行<br>const dataCallback = (data: any) =&gt; &#123;<br>  return &#123;<br>    list: data.list,<br>    total: data.total,<br>    pageNum: data.pageNum,<br>    pageSize: data.pageSize,<br>  &#125;;<br>&#125;;<br><br>// 如果你想在请求之前对当前请求参数做一些操作，可以自定义如下函数：params 为当前所有的请求参数（包括分页），最后返回请求列表接口<br>// 默认不做操作就直接在 ProTable 组件上绑定	:requestApi=&quot;getUserList&quot;<br>const getTableList = (params: any) =&gt; &#123;<br>  let newParams = JSON.parse(JSON.stringify(params));<br>  newParams.createTime &amp;&amp; (newParams.startTime = newParams.createTime[0]);<br>  newParams.createTime &amp;&amp; (newParams.endTime = newParams.createTime[1]);<br>  delete newParams.createTime;<br>  return getUserList(newParams);<br>&#125;;<br><br>// 页面按钮权限（按钮权限既可以使用 hooks，也可以直接使用 v-auth 指令，指令适合直接绑定在按钮上，hooks 适合根据按钮权限显示不同的内容）<br>const &#123; BUTTONS &#125; = useAuthButtons();<br><br>// 自定义渲染表头（使用tsx语法）<br>const headerRender = (scope: HeaderRenderScope&lt;User.ResUserList&gt;) =&gt; &#123;<br>  return (<br>    &lt;el-button<br>      type=&quot;primary&quot;<br>      onClick=&#123;() =&gt; ElMessage.success(&quot;我是通过 tsx 语法渲染的表头&quot;)&#125;<br>    &gt;<br>      &#123;scope.column.label&#125;<br>    &lt;/el-button&gt;<br>  );<br>&#125;;<br><br>// 表格配置项<br>const columns: ColumnProps&lt;User.ResUserList&gt;[] = [<br>  &#123; type: &quot;selection&quot;, fixed: &quot;left&quot;, width: 80 &#125;,<br>  &#123; type: &quot;index&quot;, label: &quot;#&quot;, width: 80 &#125;,<br>  &#123; type: &quot;expand&quot;, label: &quot;Expand&quot;, width: 100 &#125;,<br>  &#123;<br>    prop: &quot;username&quot;,<br>    label: &quot;用户姓名&quot;,<br>    search: &#123; el: &quot;input&quot; &#125;,<br>    render: (scope) =&gt; &#123;<br>      return (<br>        &lt;el-button<br>          type=&quot;primary&quot;<br>          link<br>          onClick=&#123;() =&gt; ElMessage.success(&quot;我是通过 tsx 语法渲染的内容&quot;)&#125;<br>        &gt;<br>          &#123;scope.row.username&#125;<br>        &lt;/el-button&gt;<br>      );<br>    &#125;,<br>  &#125;,<br>  &#123;<br>    prop: &quot;gender&quot;,<br>    label: &quot;性别&quot;,<br>    // 字典数据<br>    // enum: genderType,<br>    // 字典请求不带参数<br>    enum: getUserGender,<br>    // 字典请求携带参数<br>    // enum: () =&gt; getUserGender(&#123; id: 1 &#125;),<br>    search: &#123; el: &quot;select&quot;, props: &#123; filterable: true &#125; &#125;,<br>    fieldNames: &#123; label: &quot;genderLabel&quot;, value: &quot;genderValue&quot; &#125;,<br>  &#125;,<br>  &#123;<br>    // 多级 prop<br>    prop: &quot;user.detail.age&quot;,<br>    label: &quot;年龄&quot;,<br>    search: &#123;<br>      // 自定义 search 显示内容<br>      render: (&#123; searchParam &#125;) =&gt; &#123;<br>        return (<br>          &lt;div class=&quot;flx-center&quot;&gt;<br>            &lt;el-input vModel_trim=&#123;searchParam.minAge&#125; placeholder=&quot;最小年龄&quot; /&gt;<br>            &lt;span class=&quot;mr10 ml10&quot;&gt;-&lt;/span&gt;<br>            &lt;el-input vModel_trim=&#123;searchParam.maxAge&#125; placeholder=&quot;最大年龄&quot; /&gt;<br>          &lt;/div&gt;<br>        );<br>      &#125;,<br>    &#125;,<br>  &#125;,<br>  &#123; prop: &quot;idCard&quot;, label: &quot;身份证号&quot;, search: &#123; el: &quot;input&quot; &#125; &#125;,<br>  &#123; prop: &quot;email&quot;, label: &quot;邮箱&quot; &#125;,<br>  &#123; prop: &quot;address&quot;, label: &quot;居住地址&quot; &#125;,<br>  &#123;<br>    prop: &quot;status&quot;,<br>    label: &quot;用户状态&quot;,<br>    enum: getUserStatus,<br>    search: &#123; el: &quot;tree-select&quot;, props: &#123; filterable: true &#125; &#125;,<br>    fieldNames: &#123; label: &quot;userLabel&quot;, value: &quot;userStatus&quot; &#125;,<br>    render: (scope) =&gt; &#123;<br>      return (<br>        &lt;&gt;<br>          &#123;BUTTONS.value.status ? (<br>            &lt;el-switch<br>              model-value=&#123;scope.row.status&#125;<br>              active-text=&#123;scope.row.status ? &quot;启用&quot; : &quot;禁用&quot;&#125;<br>              active-value=&#123;1&#125;<br>              inactive-value=&#123;0&#125;<br>              onClick=&#123;() =&gt; changeStatus(scope.row)&#125;<br>            /&gt;<br>          ) : (<br>            &lt;el-tag type=&#123;scope.row.status ? &quot;success&quot; : &quot;danger&quot;&#125;&gt;<br>              &#123;scope.row.status ? &quot;启用&quot; : &quot;禁用&quot;&#125;<br>            &lt;/el-tag&gt;<br>          )&#125;<br>        &lt;/&gt;<br>      );<br>    &#125;,<br>  &#125;,<br>  &#123;<br>    prop: &quot;createTime&quot;,<br>    label: &quot;创建时间&quot;,<br>    headerRender,<br>    width: 180,<br>    search: &#123;<br>      el: &quot;date-picker&quot;,<br>      span: 2,<br>      props: &#123; type: &quot;datetimerange&quot;, valueFormat: &quot;YYYY-MM-DD HH:mm:ss&quot; &#125;,<br>      defaultValue: [&quot;2022-11-12 11:35:00&quot;, &quot;2022-12-12 11:35:00&quot;],<br>    &#125;,<br>  &#125;,<br>  &#123; prop: &quot;operation&quot;, label: &quot;操作&quot;, fixed: &quot;right&quot;, width: 330 &#125;,<br>];<br><br>// 删除用户信息<br>const deleteAccount = async (params: User.ResUserList) =&gt; &#123;<br>  await useHandleData(<br>    deleteUser,<br>    &#123; id: [params.id] &#125;,<br>    `删除【$&#123;params.username&#125;】用户`<br>  );<br>  proTable.value?.getTableList();<br>&#125;;<br><br>// 批量删除用户信息<br>const batchDelete = async (id: string[]) =&gt; &#123;<br>  await useHandleData(deleteUser, &#123; id &#125;, &quot;删除所选用户信息&quot;);<br>  proTable.value?.clearSelection();<br>  proTable.value?.getTableList();<br>&#125;;<br><br>// 重置用户密码<br>const resetPass = async (params: User.ResUserList) =&gt; &#123;<br>  await useHandleData(<br>    resetUserPassWord,<br>    &#123; id: params.id &#125;,<br>    `重置【$&#123;params.username&#125;】用户密码`<br>  );<br>  proTable.value?.getTableList();<br>&#125;;<br><br>// 切换用户状态<br>const changeStatus = async (row: User.ResUserList) =&gt; &#123;<br>  await useHandleData(<br>    changeUserStatus,<br>    &#123; id: row.id, status: row.status == 1 ? 0 : 1 &#125;,<br>    `切换【$&#123;row.username&#125;】用户状态`<br>  );<br>  proTable.value?.getTableList();<br>&#125;;<br><br>// 导出用户列表<br>const downloadFile = async () =&gt; &#123;<br>  ElMessageBox.confirm(&quot;确认导出用户数据?&quot;, &quot;温馨提示&quot;, &#123;<br>    type: &quot;warning&quot;,<br>  &#125;).then(() =&gt;<br>    useDownload(exportUserInfo, &quot;用户列表&quot;, proTable.value?.searchParam)<br>  );<br>&#125;;<br><br>// 批量添加用户<br>const dialogRef = ref&lt;InstanceType&lt;typeof ImportExcel&gt; | null&gt;(null);<br>const batchAdd = () =&gt; &#123;<br>  const params = &#123;<br>    title: &quot;用户&quot;,<br>    tempApi: exportUserInfo,<br>    importApi: BatchAddUser,<br>    getTableList: proTable.value?.getTableList,<br>  &#125;;<br>  dialogRef.value?.acceptParams(params);<br>&#125;;<br><br>// 打开 drawer(新增、查看、编辑)<br>const drawerRef = ref&lt;InstanceType&lt;typeof UserDrawer&gt; | null&gt;(null);<br>const openDrawer = (title: string, row: Partial&lt;User.ResUserList&gt; = &#123;&#125;) =&gt; &#123;<br>  const params = &#123;<br>    title,<br>    isView: title === &quot;查看&quot;,<br>    row: &#123; ...row &#125;,<br>    api: title === &quot;新增&quot; ? addUser : title === &quot;编辑&quot; ? editUser : undefined,<br>    getTableList: proTable.value?.getTableList,<br>  &#125;;<br>  drawerRef.value?.acceptParams(params);<br>&#125;;<br>&lt;/script&gt;<br></code></pre></td></tr></table></figure>
</article><section class="jump-container is-flex is-justify-content-space-between my-6"><!-- em is empty placeholder--><em></em><a class="button is-default" href="/2023/02/03/120-github/" title="120、git提交代码终端出现“Enter passphrase for key ‘/Users/yq/.ssh/id_rsa”"><span class="has-text-weight-semibold">下一页: 120、git提交代码终端出现“Enter passphrase for key ‘/Users/yq/.ssh/id_rsa”</span><i class="iconfont icon-next ml-2 has-text-grey"></i></a></section></div></div></main></main><footer class="is-flex is-flex-direction-column is-align-items-center is-flex-shrink-0 is-family-serif"><section class="sns-container"><!-- Github--><a title="github" target="_blank" rel="noopener nofollow" href="//github.com/Jude"><i class="iconfont icon-github"></i></a><!-- Ins--><!-- RSS--><!-- 知乎--><a title="zhihu" target="_blank" rel="noopener nofollow" href="//zhihu.com/https://www.zhihu.com/hot"><i class="iconfont icon-zhihu"></i></a><!-- 领英--><!-- 脸书--></section><p><span>Copyright ©</span><span> Jude 2023</span></p><div class="is-flex is-justify-content-center is-flex-wrap-wrap"><p>Powered by Hexo &verbar;&nbsp;</p><p class="is-flex is-justify-content-center"><a title="Hexo theme author" target="_blank" rel="noopener" href="//github.com/haojen">Theme by Haojen&nbsp;</a></p><div style="margin-top: 2px"><a class="github-button" title="github-button" target="_blank" rel="noopener" href="https://github.com/haojen/hexo-theme-Claudia" data-color-scheme="no-preference: light; light: light; dark: dark;" data-show-count="true"></a></div></div><div><span>记住昨日的美好，过好今日的生活，憧憬明天的到来</span></div></footer><script async defer src="https://buttons.github.io/buttons.js"></script><script src="/js/post.js"></script></body></html>