{"title":"8、解决Vue项目热更新打包时间过长","uid":"d744e261b67622d7a554778fbe8d666f","slug":"8-hot","date":"2019-12-11T12:00:00.000Z","updated":"2022-09-05T07:32:36.000Z","comments":true,"path":"api/articles/8-hot.json","keywords":null,"cover":null,"content":"<p>维护公司一个项目的时候，发现在项目启动、热更新和打包项目的时候，时间长的“感人”。</p>\n<span id=\"more\"></span>\n<p>当你改动项目的一些地方想要立即看到效果的时候，却发现热更新的编译过程却花了你很长时间，“心态崩了。。。”。</p>\n<h3 id=\"1、解决Vue项目热更新打包时间过长\"><a href=\"#1、解决Vue项目热更新打包时间过长\" class=\"headerlink\" title=\"1、解决Vue项目热更新打包时间过长\"></a>1、解决Vue项目热更新打包时间过长</h3><p>解决方法：</p>\n<p>1、使用html-webpack-plugin-for-multihtml插件</p>\n<p>2、在build-webpack.dev.conf.js文件中</p>\n<div class=\"language-js\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">js</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #C792EA\">const</span><span style=\"color: #BABED8\"> HtmlWebpackPlugin </span><span style=\"color: #89DDFF\">=</span><span style=\"color: #BABED8\"> </span><span style=\"color: #82AAFF\">require</span><span style=\"color: #BABED8\">(</span><span style=\"color: #89DDFF\">&#39;</span><span style=\"color: #C3E88D\">html-webpack-plugin</span><span style=\"color: #89DDFF\">&#39;</span><span style=\"color: #BABED8\">)</span><span style=\"color: #89DDFF\">;</span></span>\n<span class=\"line\"><span style=\"color: #89DDFF\">    </span><span style=\"color: #676E95; font-style: italic\">// 替换成</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #C792EA\">const</span><span style=\"color: #BABED8\"> HtmlWebpackPlugin </span><span style=\"color: #89DDFF\">=</span><span style=\"color: #BABED8\"> </span><span style=\"color: #82AAFF\">require</span><span style=\"color: #BABED8\">(</span><span style=\"color: #89DDFF\">&#39;</span><span style=\"color: #C3E88D\">html-webpack-plugin-for-multihtml</span><span style=\"color: #89DDFF\">&#39;</span><span style=\"color: #BABED8\">)</span><span style=\"color: #89DDFF\">;</span></span></code></pre></div><p>3、multihtmlCache:true  解决多页热部署的关键</p>\n<div class=\"language-js\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">js</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #89DDFF; font-style: italic\">for</span><span style=\"color: #BABED8\"> (</span><span style=\"color: #C792EA\">var</span><span style=\"color: #BABED8\"> pathname </span><span style=\"color: #89DDFF\">in</span><span style=\"color: #BABED8\"> pages) </span><span style=\"color: #89DDFF\">&#123;</span></span>\n<span class=\"line\"><span style=\"color: #89DDFF\">  </span><span style=\"color: #676E95; font-style: italic\">// 配置生成的html文件，定义路径等</span></span>\n<span class=\"line\"><span style=\"color: #F07178\">  </span><span style=\"color: #C792EA\">var</span><span style=\"color: #F07178\"> </span><span style=\"color: #BABED8\">conf</span><span style=\"color: #F07178\"> </span><span style=\"color: #89DDFF\">=</span><span style=\"color: #F07178\"> </span><span style=\"color: #89DDFF\">&#123;</span></span>\n<span class=\"line\"><span style=\"color: #F07178\">    filename</span><span style=\"color: #89DDFF\">:</span><span style=\"color: #F07178\"> </span><span style=\"color: #BABED8\">pathname</span><span style=\"color: #F07178\"> </span><span style=\"color: #89DDFF\">+</span><span style=\"color: #F07178\"> </span><span style=\"color: #89DDFF\">&#39;</span><span style=\"color: #C3E88D\">.html</span><span style=\"color: #89DDFF\">&#39;</span><span style=\"color: #89DDFF\">,</span></span>\n<span class=\"line\"><span style=\"color: #F07178\">    template</span><span style=\"color: #89DDFF\">:</span><span style=\"color: #F07178\"> </span><span style=\"color: #BABED8\">pages</span><span style=\"color: #F07178\">[</span><span style=\"color: #BABED8\">pathname</span><span style=\"color: #F07178\">]</span><span style=\"color: #89DDFF\">,</span><span style=\"color: #F07178\">   </span><span style=\"color: #676E95; font-style: italic\">// 模板路径</span></span>\n<span class=\"line\"><span style=\"color: #F07178\">    inject</span><span style=\"color: #89DDFF\">:</span><span style=\"color: #F07178\"> </span><span style=\"color: #FF9CAC\">true</span><span style=\"color: #89DDFF\">,</span><span style=\"color: #F07178\">              </span><span style=\"color: #676E95; font-style: italic\">// js插入位置</span></span>\n<span class=\"line\"><span style=\"color: #F07178\">    multihtmlCache</span><span style=\"color: #89DDFF\">:</span><span style=\"color: #F07178\"> </span><span style=\"color: #FF9CAC\">true</span><span style=\"color: #89DDFF\">,</span><span style=\"color: #F07178\">    </span><span style=\"color: #676E95; font-style: italic\">// 解决多页热部署的关键 这里这里这里这里这里很重要！！！</span></span>\n<span class=\"line\"><span style=\"color: #89DDFF\">    </span><span style=\"color: #676E95; font-style: italic\">// necessary to consistently work with multiple chunks via CommonsChunkPlugin</span></span>\n<span class=\"line\"><span style=\"color: #F07178\">    chunksSortMode</span><span style=\"color: #89DDFF\">:</span><span style=\"color: #F07178\"> </span><span style=\"color: #89DDFF\">&#39;</span><span style=\"color: #C3E88D\">dependency</span><span style=\"color: #89DDFF\">&#39;</span></span>\n<span class=\"line\"><span style=\"color: #F07178\">  </span><span style=\"color: #89DDFF\">&#125;;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #F07178\">  </span><span style=\"color: #89DDFF; font-style: italic\">if</span><span style=\"color: #F07178\"> (</span><span style=\"color: #BABED8\">pathname</span><span style=\"color: #F07178\"> </span><span style=\"color: #89DDFF\">in</span><span style=\"color: #F07178\"> </span><span style=\"color: #BABED8\">devWebpackConfig</span><span style=\"color: #89DDFF\">.</span><span style=\"color: #BABED8\">entry</span><span style=\"color: #F07178\">) </span><span style=\"color: #89DDFF\">&#123;</span></span>\n<span class=\"line\"><span style=\"color: #F07178\">    </span><span style=\"color: #BABED8\">conf</span><span style=\"color: #89DDFF\">.</span><span style=\"color: #BABED8\">chunks</span><span style=\"color: #F07178\"> </span><span style=\"color: #89DDFF\">=</span><span style=\"color: #F07178\"> [</span><span style=\"color: #89DDFF\">&#39;</span><span style=\"color: #C3E88D\">manifest</span><span style=\"color: #89DDFF\">&#39;</span><span style=\"color: #89DDFF\">,</span><span style=\"color: #89DDFF\">&#39;</span><span style=\"color: #C3E88D\">vendor</span><span style=\"color: #89DDFF\">&#39;</span><span style=\"color: #89DDFF\">,</span><span style=\"color: #F07178\"> </span><span style=\"color: #BABED8\">pathname</span><span style=\"color: #F07178\">]</span><span style=\"color: #89DDFF\">;</span></span>\n<span class=\"line\"><span style=\"color: #F07178\">    </span><span style=\"color: #BABED8\">conf</span><span style=\"color: #89DDFF\">.</span><span style=\"color: #BABED8\">hash</span><span style=\"color: #F07178\"> </span><span style=\"color: #89DDFF\">=</span><span style=\"color: #F07178\"> </span><span style=\"color: #FF9CAC\">false</span><span style=\"color: #89DDFF\">;</span></span>\n<span class=\"line\"><span style=\"color: #F07178\">  </span><span style=\"color: #89DDFF\">&#125;</span></span>\n<span class=\"line\"><span style=\"color: #F07178\">  </span><span style=\"color: #BABED8\">devWebpackConfig</span><span style=\"color: #89DDFF\">.</span><span style=\"color: #BABED8\">plugins</span><span style=\"color: #89DDFF\">.</span><span style=\"color: #82AAFF\">push</span><span style=\"color: #F07178\">(</span><span style=\"color: #89DDFF\">new</span><span style=\"color: #F07178\"> </span><span style=\"color: #82AAFF\">HtmlWebpackPlugin</span><span style=\"color: #F07178\">(</span><span style=\"color: #BABED8\">conf</span><span style=\"color: #F07178\">))</span><span style=\"color: #89DDFF\">;</span></span>\n<span class=\"line\"><span style=\"color: #89DDFF\">&#125;</span></span></code></pre></div><p>4、router.js中使用路由懒加载</p>\n<p>这时候再启动项目，热更新、编译和打包的速度会大大提升。</p>\n<h3 id=\"2、项目打包由4M变为1M\"><a href=\"#2、项目打包由4M变为1M\" class=\"headerlink\" title=\"2、项目打包由4M变为1M\"></a>2、项目打包由4M变为1M</h3><p>公司有一个H5微信公众号网页的项目，项目打包之后文件有4M；</p>\n<p>修改webpack.prod.conf.js里的UglifyJsPlugin，这里的意思是打包后不产生后缀名为.map的文件。</p>\n<div class=\"language-javascript\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">javascript</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #BABED8\">webpack</span><span style=\"color: #89DDFF\">.</span><span style=\"color: #BABED8\">prod</span><span style=\"color: #89DDFF\">.</span><span style=\"color: #BABED8\">conf</span><span style=\"color: #89DDFF\">.</span><span style=\"color: #BABED8\">js</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #89DDFF\">new</span><span style=\"color: #BABED8\"> </span><span style=\"color: #82AAFF\">UglifyJsPlugin</span><span style=\"color: #BABED8\">(</span><span style=\"color: #89DDFF\">&#123;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">      </span><span style=\"color: #F07178\">uglifyOptions</span><span style=\"color: #89DDFF\">:</span><span style=\"color: #BABED8\"> </span><span style=\"color: #89DDFF\">&#123;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">        </span><span style=\"color: #F07178\">compress</span><span style=\"color: #89DDFF\">:</span><span style=\"color: #BABED8\"> </span><span style=\"color: #89DDFF\">&#123;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">          </span><span style=\"color: #F07178\">warnings</span><span style=\"color: #89DDFF\">:</span><span style=\"color: #BABED8\"> </span><span style=\"color: #FF9CAC\">false</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">        </span><span style=\"color: #89DDFF\">&#125;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">      </span><span style=\"color: #89DDFF\">&#125;,</span></span>\n<span class=\"line\"><span style=\"color: #89DDFF\">      </span><span style=\"color: #676E95; font-style: italic\">// sourceMap: config.build.productionSourceMap, 将这行代码注释掉。</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">      </span><span style=\"color: #F07178\">parallel</span><span style=\"color: #89DDFF\">:</span><span style=\"color: #BABED8\"> </span><span style=\"color: #FF9CAC\">true</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #89DDFF\">&#125;</span><span style=\"color: #BABED8\">)</span></span></code></pre></div><p>处理后打包的文件的大小为1M</p>\n","text":"维护公司一个项目的时候，发现在项目启动、热更新和打包项目的时候，时间长的“感人”。 当你改动项目的一些地方想要立即看到效果的时候，却发现热更新的编译过程却花了你...","permalink":"/post/8-hot","photos":[],"count_time":{"symbolsCount":"1.4k","symbolsTime":"1 mins."},"categories":[],"tags":[{"name":"dev","slug":"dev","count":15,"path":"api/tags/dev.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#1%E3%80%81%E8%A7%A3%E5%86%B3Vue%E9%A1%B9%E7%9B%AE%E7%83%AD%E6%9B%B4%E6%96%B0%E6%89%93%E5%8C%85%E6%97%B6%E9%97%B4%E8%BF%87%E9%95%BF\"><span class=\"toc-text\">1、解决Vue项目热更新打包时间过长</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#2%E3%80%81%E9%A1%B9%E7%9B%AE%E6%89%93%E5%8C%85%E7%94%B14M%E5%8F%98%E4%B8%BA1M\"><span class=\"toc-text\">2、项目打包由4M变为1M</span></a></li></ol>","author":{"name":"Jude","slug":"blog-author","avatar":"","link":"/","description":"","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"hidden":false,"prev_post":{"title":"9、h5扫码功能的实现","uid":"66b773f5ea2d0fd7877b90a347385c98","slug":"9-h5-scan","date":"2019-12-20T12:00:00.000Z","updated":"2022-09-05T07:32:57.000Z","comments":true,"path":"api/articles/9-h5-scan.json","keywords":null,"cover":null,"text":"使用H5 API barcode实现扫码。 html&lt;template&gt; &lt;div&gt; &lt;div @click=&quot;hand...","permalink":"/post/9-h5-scan","photos":[],"count_time":{"symbolsCount":"2.2k","symbolsTime":"2 mins."},"categories":[],"tags":[{"name":"h5","slug":"h5","count":1,"path":"api/tags/h5.json"}],"author":{"name":"Jude","slug":"blog-author","avatar":"","link":"/","description":"","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}},"next_post":{"title":"7、markdown语法","uid":"8043aa771423d32acc708d099583647c","slug":"7-markdown","date":"2019-12-05T12:00:00.000Z","updated":"2022-09-05T07:31:23.000Z","comments":true,"path":"api/articles/7-markdown.json","keywords":null,"cover":null,"text":"markdown语法整理 Markdown标题 使用#号标记，使用 # 号可表示 1-6 级标题，一级标题对应一个 # 号，二级标题对应两个 # 号，以此类推。...","permalink":"/post/7-markdown","photos":[],"count_time":{"symbolsCount":"1.4k","symbolsTime":"1 mins."},"categories":[],"tags":[{"name":"markdown","slug":"markdown","count":1,"path":"api/tags/markdown.json"}],"author":{"name":"Jude","slug":"blog-author","avatar":"","link":"/","description":"","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}}}