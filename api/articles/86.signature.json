{"title":"86、canvas电子签名","uid":"b9ee1ea0abd68e724076c2d54440fea9","slug":"86.signature","date":"2022-08-08T15:00:00.000Z","updated":"2022-10-13T03:04:35.000Z","comments":true,"path":"api/articles/86.signature.json","keywords":null,"cover":null,"content":"<p>canvas电子签名</p>\n<span id=\"more\"></span>\n\n<div class=\"language-html\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">html</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #BABED8\">&lt;!DOCTYPE html&gt;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">&lt;html lang=&quot;en&quot;&gt;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">  &lt;head&gt;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    &lt;meta charset=&quot;UTF-8&quot; /&gt;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    &lt;meta http-equiv=&quot;X-UA-Compatible&quot; content=&quot;IE=edge&quot; /&gt;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot; /&gt;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    &lt;title&gt;Document&lt;/title&gt;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    &lt;style&gt;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">      #cvs &#123;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">        background-color: #000;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">        background: #000;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">      &#125;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">      body &#123;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">        height: 100vh;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">        background-color: rgb(26, 25, 25);</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">      &#125;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    &lt;/style&gt;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">  &lt;/head&gt;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">  &lt;body&gt;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    &lt;canvas id=&quot;cvs&quot;&gt;&lt;/canvas&gt;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    &lt;div style=&quot;margin-top: 50px&quot;&gt;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">      &lt;button id=&quot;clear&quot;&gt;清空&lt;/button&gt;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">      &lt;button id=&quot;back&quot;&gt;回退&lt;/button&gt;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">      &lt;button id=&quot;save&quot;&gt;保存&lt;/button&gt;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    &lt;/div&gt;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    &lt;script&gt;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">      let width = 800;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">      let height = 400;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">      let isDownin = false;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">      let lastX = 0;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">      let lastY = 0;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">      let cacheData = [];</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #BABED8\">      const cvs = document.getElementById(&quot;cvs&quot;);</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">      const ctx = cvs.getContext(&quot;2d&quot;);</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">      cvs.width = width;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">      cvs.height = height;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #BABED8\">      cvs.addEventListener(&quot;mousedown&quot;, (e) =&gt; &#123;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">        isDownin = true;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">        lastX = e.pageX;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">        lastY = e.pageY;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">        let cacheItem = ctx.getImageData(0, 0, width, height);</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">        cacheData.push(cacheItem);</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">        ctx.moveTo(lastX, lastY);</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">      &#125;);</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">      cvs.addEventListener(&quot;mousemove&quot;, (e) =&gt; &#123;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">        if (!isDownin) return;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">        drawLine(e.pageX, e.pageY);</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">        ctx.stroke();</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">      &#125;);</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">      cvs.addEventListener(&quot;mouseup&quot;, (e) =&gt; &#123;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">        isDownin = false;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">      &#125;);</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #BABED8\">      function drawLine(x, y) &#123;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">        ctx.beginPath();</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">        ctx.lineWidth = 8;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">        ctx.strokeStyle = &quot;#fff&quot;;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">        ctx.lineCap = &quot;round&quot;;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">        ctx.lineJoin = &quot;round&quot;;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">        ctx.moveTo(lastX, lastY);</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">        ctx.lineTo(x, y);</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">        ctx.stroke();</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">        lastX = x;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">        lastY = y;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">      &#125;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #BABED8\">      /* 清空 */</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">      const clear = document.getElementById(&quot;clear&quot;);</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">      clear.onclick = () =&gt; &#123;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">        ctx.clearRect(0, 0, width, height);</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">      &#125;;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #BABED8\">      /* 回退 */</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">      const back = document.getElementById(&quot;back&quot;);</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">      back.onclick = () =&gt; &#123;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">        if (cacheData.length === 0) return;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">        ctx.putImageData(cacheData.pop(), 0, 0);</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">      &#125;;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #BABED8\">      const save = document.getElementById(&quot;save&quot;);</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">      save.onclick = () =&gt; &#123;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">        cvs.toBlob((blob) =&gt; &#123;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">          const a = document.createElement(&quot;a&quot;);</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">          document.body.append(a);</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">          a.download = `签名.png`;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">          a.href = URL.createObjectURL(blob);</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">          a.click();</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">          a.remove();</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">        &#125;);</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">      &#125;;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    &lt;/script&gt;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">  &lt;/body&gt;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">&lt;/html&gt;</span></span></code></pre></div>","text":"canvas电子签名 html&lt;!DOCTYPE html&gt; &lt;html lang=&quot;en&quot;&gt; &lt;head&g...","permalink":"/post/86.signature","photos":[],"count_time":{"symbolsCount":"3k","symbolsTime":"3 mins."},"categories":[],"tags":[{"name":"js","slug":"js","count":11,"path":"api/tags/js.json"}],"toc":"","author":{"name":"Jude","slug":"blog-author","avatar":"","link":"/","description":"","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"hidden":false,"prev_post":{"title":"87、element的表单校验自动定位到未校验成功位置","uid":"4d836d52e736c79a6a6c9f9b03098430","slug":"87.element-validator","date":"2022-08-09T12:00:00.000Z","updated":"2022-10-14T01:36:02.000Z","comments":true,"path":"api/articles/87.element-validator.json","keywords":null,"cover":null,"text":"遇到的项目问题是在每个折叠面板里边都有不同的表单，用 element 上的校验时，若有没填写的表单或不符合表单格式的要求，则自动展开该折叠面板，且页面定位到没校...","permalink":"/post/87.element-validator","photos":[],"count_time":{"symbolsCount":"1.5k","symbolsTime":"1 mins."},"categories":[],"tags":[{"name":"vue","slug":"vue","count":17,"path":"api/tags/vue.json"}],"author":{"name":"Jude","slug":"blog-author","avatar":"","link":"/","description":"","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}},"next_post":{"title":"85、常用代码片段","uid":"6f52d7fc55673b773fa0af36dfe006d6","slug":"85.js-function","date":"2022-08-06T15:00:00.000Z","updated":"2022-10-13T07:30:43.000Z","comments":true,"path":"api/articles/85.js-function.json","keywords":null,"cover":null,"text":"整理一些常用的代码片段 一、数组重排序jsconst shuffle = (arr) =&gt; arr.sort(() =&gt; Math.random()...","permalink":"/post/85.js-function","photos":[],"count_time":{"symbolsCount":"8.3k","symbolsTime":"8 mins."},"categories":[],"tags":[{"name":"js","slug":"js","count":11,"path":"api/tags/js.json"}],"author":{"name":"Jude","slug":"blog-author","avatar":"","link":"/","description":"","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}}}