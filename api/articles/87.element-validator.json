{"title":"87、element的表单校验自动定位到未校验成功位置","uid":"4d836d52e736c79a6a6c9f9b03098430","slug":"87.element-validator","date":"2022-08-09T12:00:00.000Z","updated":"2022-10-14T01:36:02.000Z","comments":true,"path":"api/articles/87.element-validator.json","keywords":null,"cover":null,"content":"<p>遇到的项目问题是在每个折叠面板里边都有不同的表单，用 element 上的校验时，若有没填写的表单或不符合表单格式的要求，则自动展开该折叠面板，且页面定位到没校验成功的表单。</p>\n<span id=\"more\"></span>\n\n<h2 id=\"方法一\"><a href=\"#方法一\" class=\"headerlink\" title=\"方法一\"></a>方法一</h2><div class=\"language-js\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">js</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #BABED8\">this.$refs.form.validate((valid, object) =&gt; &#123;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">  if (valid) &#123;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    alert(&quot;submit!&quot;);</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">  &#125; else &#123;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    let split = &quot;&quot;;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    for (let i in object) &#123;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">      let dom = this.$refs[i];</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">      if (Object.prototype.toString.call(dom) !== &quot;[object Object]&quot;) &#123;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">        //这里是针对遍历的情况（多个输入框），取值为数组</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">        dom = dom[0];</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">        // 第一个未填写必填项的表单被记录，这个是为了处理如何把校验未成功的第一个面板展开</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">        split = dom.prop;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">        let index = split.indexOf(&quot;.&quot;);</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">        let last = split.lastIndexOf(&quot;.&quot;);</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">        // 通过未填写的表单索引展开折叠面板</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">        this.activeName = Number(split.slice(index + 1, last));</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">        break;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">      &#125;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">      dom.$el.scrollIntoView(&#123;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">        //滚动到指定节点</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">        block: &quot;center&quot;, //值有start,center,end，nearest，当前显示在视图区域中间</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">        behavior: &quot;smooth&quot;, //值有auto、instant,smooth，缓动动画（当前是慢速的）</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">      &#125;);</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    &#125;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    console.log(&quot;error submit!!&quot;);</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    return false;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">  &#125;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">&#125;);</span></span></code></pre></div><h2 id=\"方法二\"><a href=\"#方法二\" class=\"headerlink\" title=\"方法二\"></a>方法二</h2><div class=\"language-js\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">js</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #BABED8\"> submit(formName) &#123;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    this.$refs[formName][&quot;validate&quot;]((valid) =&gt; &#123;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">      if (valid) &#123;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #BABED8\">      &#125; else &#123;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">        setTimeout(()=&gt;&#123;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">            var isError= document.getElementsByClassName(&quot;is-error&quot;);</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">            isError[0].querySelector(&#39;input&#39;).focus();</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">          &#125;,100);</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">          return false;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">      &#125;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    &#125;);</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">  &#125;</span></span></code></pre></div>","text":"遇到的项目问题是在每个折叠面板里边都有不同的表单，用 element 上的校验时，若有没填写的表单或不符合表单格式的要求，则自动展开该折叠面板，且页面定位到没校...","permalink":"/post/87.element-validator","photos":[],"count_time":{"symbolsCount":"1.5k","symbolsTime":"1 mins."},"categories":[],"tags":[{"name":"vue","slug":"vue","count":17,"path":"api/tags/vue.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E6%96%B9%E6%B3%95%E4%B8%80\"><span class=\"toc-text\">方法一</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E6%96%B9%E6%B3%95%E4%BA%8C\"><span class=\"toc-text\">方法二</span></a></li></ol>","author":{"name":"Jude","slug":"blog-author","avatar":"","link":"/","description":"","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"hidden":false,"prev_post":{"title":"88、Vue3和Vue2","uid":"65bd3f1319c5268988323a5b73a44cf4","slug":"88、vue3-vue2","date":"2022-08-11T12:00:00.000Z","updated":"2022-11-01T01:17:11.000Z","comments":true,"path":"api/articles/88、vue3-vue2.json","keywords":null,"cover":null,"text":"vue3 的 2 种响应式实现、Vue2 项目如何升级到 Vue3 等等。。。 一、options api 选项式 API Options Api 可以理解为就...","permalink":"/post/88、vue3-vue2","photos":[],"count_time":{"symbolsCount":"13k","symbolsTime":"12 mins."},"categories":[],"tags":[{"name":"vue3","slug":"vue3","count":24,"path":"api/tags/vue3.json"}],"author":{"name":"Jude","slug":"blog-author","avatar":"","link":"/","description":"","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}},"next_post":{"title":"86、canvas电子签名","uid":"b9ee1ea0abd68e724076c2d54440fea9","slug":"86.signature","date":"2022-08-08T15:00:00.000Z","updated":"2022-10-13T03:04:35.000Z","comments":true,"path":"api/articles/86.signature.json","keywords":null,"cover":null,"text":"canvas电子签名 html&lt;!DOCTYPE html&gt; &lt;html lang=&quot;en&quot;&gt; &lt;head&g...","permalink":"/post/86.signature","photos":[],"count_time":{"symbolsCount":"3k","symbolsTime":"3 mins."},"categories":[],"tags":[{"name":"js","slug":"js","count":11,"path":"api/tags/js.json"}],"author":{"name":"Jude","slug":"blog-author","avatar":"","link":"/","description":"","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}}}