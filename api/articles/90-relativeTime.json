{"title":"90、相对时间及时间国际化的处理","uid":"43c695a4c770e67321863ebb0ea62b5e","slug":"90-relativeTime","date":"2022-08-15T12:00:00.000Z","updated":"2022-11-16T01:17:58.000Z","comments":true,"path":"api/articles/90-relativeTime.json","keywords":null,"cover":null,"content":"<p>相对时间可以理解为最后一次“打招呼”的时间和当前时间的差值。例如：2 小时前，1 天前，1 年前等</p>\n<span id=\"more\"></span>\n\n<h2 id=\"一、relativeTime-函数\"><a href=\"#一、relativeTime-函数\" class=\"headerlink\" title=\"一、relativeTime 函数\"></a>一、relativeTime 函数</h2><p>使用 day.js 将后端返回的时间戳处理为相对时间（1 小时前，1 天前等格式）</p>\n<div class=\"language-js\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">js</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #BABED8\">import dayjs from &quot;dayjs&quot;;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">import rTime from &quot;dayjs/plugin/relativeTime&quot;;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">// 处理语言</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">import &quot;dayjs/locale/zh-cn&quot;;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">import store from &quot;@/store&quot;;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #BABED8\">// 时间格式处理： 2022-08-15</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">const dateFilter = (val, format = &quot;YYYY-MM-DD&quot;) =&gt; &#123;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">  if (!isNaN(val)) &#123;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    val = parseInt(val);</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">  &#125;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">  return dayjs(val).format(format);</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">&#125;;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #BABED8\">// 加载相对时间插件</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">dayjs.extend(rTime);</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">// 相对时间处理</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">function relativeTime(val) &#123;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">  if (!isNaN(val)) &#123;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    val = parseInt(val);</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">  &#125;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">  return dayjs()</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    .locale(store.getters.langeage === &quot;zh&quot; ? &quot;zh-cn&quot; : &quot;en&quot;)</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    .to(dayjs(val));</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">&#125;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #BABED8\">export default (app) =&gt; &#123;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">  app.config.globalProperties.$filters = &#123;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    dateFilter,</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    relativeTime,</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">  &#125;;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">&#125;;</span></span></code></pre></div><blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>app.config.globalProperties 是挂载在 vue 实例上面的，所以可以直接在 template 里面访问</p></blockquote>\n<h2 id=\"二、组件内处理为相对时间\"><a href=\"#二、组件内处理为相对时间\" class=\"headerlink\" title=\"二、组件内处理为相对时间\"></a>二、组件内处理为相对时间</h2><div class=\"language-html\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">html</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #BABED8\">&lt;el-table ref=&quot;tableRef&quot; :data=&quot;tableData&quot; border&gt;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">  &lt;el-table-column</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    v-for=&quot;(item, index) in tableColumns&quot;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    :key=&quot;index&quot;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    :prop=&quot;item.prop&quot;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    :label=&quot;item.label&quot;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">  &gt;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    // 相对时间的处理</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    &lt;template #default=&quot;&#123; row &#125;&quot; v-if=&quot;item.prop === &#39;publicDate&#39;&quot;&gt;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">      &#123;&#123; $filters.relativeTime(row.publicDate) &#125;&#125;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    &lt;/template&gt;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">  &lt;/el-table-column&gt;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">&lt;/el-table&gt;</span></span></code></pre></div>","text":"相对时间可以理解为最后一次“打招呼”的时间和当前时间的差值。例如：2 小时前，1 天前，1 年前等 一、relativeTime 函数使用 day.js 将后端...","permalink":"/post/90-relativeTime","photos":[],"count_time":{"symbolsCount":"1.5k","symbolsTime":"1 mins."},"categories":[],"tags":[{"name":"vue3","slug":"vue3","count":24,"path":"api/tags/vue3.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E4%B8%80%E3%80%81relativeTime-%E5%87%BD%E6%95%B0\"><span class=\"toc-text\">一、relativeTime 函数</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E4%BA%8C%E3%80%81%E7%BB%84%E4%BB%B6%E5%86%85%E5%A4%84%E7%90%86%E4%B8%BA%E7%9B%B8%E5%AF%B9%E6%97%B6%E9%97%B4\"><span class=\"toc-text\">二、组件内处理为相对时间</span></a></li></ol>","author":{"name":"Jude","slug":"blog-author","avatar":"","link":"/","description":"","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"hidden":false,"prev_post":{"title":"91、使用vue3+element-plus写后台管理系统：（一）","uid":"51217e730619a24081f2a57960d90416","slug":"91-vue3-ele-plus-admin","date":"2022-10-16T12:00:00.000Z","updated":"2022-11-24T06:22:31.000Z","comments":true,"path":"api/articles/91-vue3-ele-plus-admin.json","keywords":null,"cover":[],"text":"创建项目及代码格式提交规范（备注：遇见 2 个坑：yarn 问题、git cz 提交空格问题） 一、vue-cli 创建项目vue-cli 版本应当大于 4.5...","permalink":"/post/91-vue3-ele-plus-admin","photos":[],"count_time":{"symbolsCount":"6.6k","symbolsTime":"6 mins."},"categories":[],"tags":[{"name":"vue3","slug":"vue3","count":24,"path":"api/tags/vue3.json"}],"author":{"name":"Jude","slug":"blog-author","avatar":"","link":"/","description":"","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}},"next_post":{"title":"89、vue-loader 是什么？","uid":"0101df2ffc8279cbfc009c6ce954aa72","slug":"89、vue-loader","date":"2022-08-14T12:00:00.000Z","updated":"2022-11-10T00:41:53.000Z","comments":true,"path":"api/articles/89、vue-loader.json","keywords":null,"cover":null,"text":"vue-loader 是用于处理单文件的 webpack loader。在 Vue 组件中，分为 template\\script\\style,结合其他 load...","permalink":"/post/89、vue-loader","photos":[],"count_time":{"symbolsCount":696,"symbolsTime":"1 mins."},"categories":[],"tags":[{"name":"vue-loader","slug":"vue-loader","count":1,"path":"api/tags/vue-loader.json"}],"author":{"name":"Jude","slug":"blog-author","avatar":"","link":"/","description":"","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}}}