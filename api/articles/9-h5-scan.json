{"title":"9、h5扫码功能的实现","uid":"66b773f5ea2d0fd7877b90a347385c98","slug":"9-h5-scan","date":"2019-12-20T12:00:00.000Z","updated":"2022-09-05T07:32:57.000Z","comments":true,"path":"api/articles/9-h5-scan.json","keywords":null,"cover":null,"content":"<p>使用H5 API barcode实现扫码。</p>\n<span id=\"more\"></span>\n\n<div class=\"language-html\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">html</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #BABED8\">&lt;template&gt;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    &lt;div&gt;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">        &lt;div @click=&quot;handleCloseScan&quot;&gt;X&lt;/div&gt;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">        &lt;div class=&quot;scan&quot;&gt;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">            &lt;div id=&quot;bcid&quot;&gt;&lt;/div&gt;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">            &lt;div&gt;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">                &lt;button @click=&quot;handleStartScan&quot;&gt;扫 码&lt;/button&gt;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">            &lt;/div&gt;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">        &lt;/div&gt;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    &lt;/div&gt;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">&lt;/template&gt;</span></span></code></pre></div><details>\n<summary>点击展示js代码</summary>\n\n<div class=\"language-js\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">js</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #BABED8\">    &lt;script&gt;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">        // 扫描对象</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">        var scan = null;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">        methods:&#123;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">            // 开始扫描</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">            handleStartScan()&#123;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">                const that = this;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">                if(!window.plus) return;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">                scan = new plus.barcode.Barcode(&#39;bcid&#39;);</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">                // 开始扫描</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">                scan.start();</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">                // 扫码成功之后的回调函数 type是类型 result 结果</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">                scan.onmarked = function(type,result)&#123;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">                    const text = &#39;&#39;;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">                    switch(type)&#123;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">                        case plus.barcode.QR:</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">                            type = &#39;QR&#39;;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">                            break;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">                        case plus.barcode.EAN13:</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">                            type = &quot;EAN13&quot;;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">                            break;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">                        case plus.barcode.EAN8:</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">                            type = &quot;EAN8&quot;;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">                            break;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">                        default:</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">                            type = &quot;其它&quot; + type;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">                            break;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">                    &#125;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">                    result = result.replace(/\\n/g,&quot;&quot;);</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">                    const id = result.match(/\\d+/)[0];</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">                    that.$router.push(&#123;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">                        name:&#39;ComponentName&#39;,</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">                        params: &#123;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">                            id:id</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">                        &#125;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">                    &#125;);</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">                    scan.close();</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">                &#125;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">            &#125;,</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">            // 关闭扫描控件</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">            handleCloseScan()&#123;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">                 if(!window.plus) return;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">                 scan.close();</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">                 this.$router.push(&#39;/&#39;);</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">            &#125;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">        &#125;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">&#125;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    &lt;/script&gt;</span></span></code></pre></div></details>\n","text":"使用H5 API barcode实现扫码。 html&lt;template&gt; &lt;div&gt; &lt;div @click=&quot;hand...","permalink":"/post/9-h5-scan","photos":[],"count_time":{"symbolsCount":"2.2k","symbolsTime":"2 mins."},"categories":[],"tags":[{"name":"h5","slug":"h5","count":1,"path":"api/tags/h5.json"}],"toc":"","author":{"name":"Jude","slug":"blog-author","avatar":"","link":"/","description":"","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"hidden":false,"prev_post":{"title":"10、微信公众号网页使用popstate事件","uid":"a02ddc5c71902c14b366a37989f821e2","slug":"10-popstate","date":"2019-12-23T12:00:00.000Z","updated":"2022-09-05T07:33:29.000Z","comments":true,"path":"api/articles/10-popstate.json","keywords":null,"cover":null,"text":"如何在h5移动端禁止某一些页面使用虚拟返回键。 1、popstate事件MDN上是这样介绍popstate的： 当活动历史记录条目更改时，将触发popstate...","permalink":"/post/10-popstate","photos":[],"count_time":{"symbolsCount":938,"symbolsTime":"1 mins."},"categories":[],"tags":[{"name":"dev","slug":"dev","count":15,"path":"api/tags/dev.json"}],"author":{"name":"Jude","slug":"blog-author","avatar":"","link":"/","description":"","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}},"next_post":{"title":"8、解决Vue项目热更新打包时间过长","uid":"d744e261b67622d7a554778fbe8d666f","slug":"8-hot","date":"2019-12-11T12:00:00.000Z","updated":"2022-09-05T07:32:36.000Z","comments":true,"path":"api/articles/8-hot.json","keywords":null,"cover":null,"text":"维护公司一个项目的时候，发现在项目启动、热更新和打包项目的时候，时间长的“感人”。 当你改动项目的一些地方想要立即看到效果的时候，却发现热更新的编译过程却花了你...","permalink":"/post/8-hot","photos":[],"count_time":{"symbolsCount":"1.4k","symbolsTime":"1 mins."},"categories":[],"tags":[{"name":"dev","slug":"dev","count":15,"path":"api/tags/dev.json"}],"author":{"name":"Jude","slug":"blog-author","avatar":"","link":"/","description":"","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}}}